(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    249603,       5679]
NotebookOptionsPosition[    228746,       5256]
NotebookOutlinePosition[    229267,       5274]
CellTagsIndexPosition[    229224,       5271]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Notebook cell properties", "Chapter",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.891089572321388*^9, 
  3.891089575952317*^9}, {3.891089708086371*^9, 3.8910897115925274`*^9}, {
  3.891089745467927*^9, 
  3.8910897494889793`*^9}},ExpressionUUID->"dc0cb5e0-0561-47a1-a65e-\
0ec0dbe5438d"],

Cell[CellGroupData[{

Cell["Editing cell properties", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.772886678242123*^9, 3.772886691536046*^9}, {
  3.7728868395831523`*^9, 3.772886839692607*^9}, {3.892645740787765*^9, 
  3.892645741220209*^9}},ExpressionUUID->"979fe95e-392b-401a-ad63-\
6182fc073d55"],

Cell[TextData[{
 "Write \[OpenCurlyDoubleQuote]True\[CloseCurlyDoubleQuote] in ",
 StyleBox["editfe",
  IgnoreSpellCheck->True],
 " and evaluate the cells in this subsection to enable cell editing in this \
notebook otherwise write \
\[OpenCurlyDoubleQuote]False\[CloseCurlyDoubleQuote]. Write \
\[OpenCurlyDoubleQuote]True\[CloseCurlyDoubleQuote] in deletefe and evaluate \
the cells of this subsection to enable cell deleting in this notebook \
otherwise write \[OpenCurlyDoubleQuote]False\[CloseCurlyDoubleQuote]."
}], "CodeText",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.829136678792416*^9, 3.829136724345496*^9}, {
   3.891089625686507*^9, 3.8910896553727903`*^9}, {3.891091737168961*^9, 
   3.8910918918753457`*^9}, {3.891091984171587*^9, 3.891092013702079*^9}, {
   3.891092044462976*^9, 3.891092075086072*^9}, {3.891092214459401*^9, 
   3.891092240976271*^9}, 3.948372680786494*^9, {3.9646976711831493`*^9, 
   3.96469769030319*^9}},ExpressionUUID->"096a17d2-fc45-4c7a-a58e-\
143ced7dba57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"editfe", "=", "\"\<False\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deletefe", "=", "\"\<False\>\""}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->CompressedData["
1:eJwdzl9Ik2EUBvCRMdt0bTWoMKFSklEgo8K82GpvGm3MqNYQUouVmimUW41M
s/r4stKspGxJEpvCDN0GVpNaudqiLryNRf5hgRexDL+v0LW60K3e5704/Hjg
HJ6z5VSzpX6FRCLR0IFav+eELy2QBc+EDS4aD12Gk+1nmfFXsnEY3trAtHr/
ZPupRftuyWDmZo8CKruHmI1cYh3sKE8xN1RMl8DSYJqZZ8hffyQjkJe+N8zo
fMk0PL2QmIENKdNz7z+BVEekL6CbD6g+UxePhdZAeVLvaJWIZL/p+HmYidTX
HsgSSZ1ulhkofuevlYrk8KwYgF3xmOMMtWaP4gLkhvile1TLQVka6ke/f3hA
/WVu+gjzdKbeXmrsfbYLDvM8cVHnpEtMqdnXs2kt3U/uvQ+FVasfw6cneabU
bKtSqUXSr8upgX8LznXB8EiC2d1a6FFrRWKzHvVCQ3NQ2V4pEudEhFk3Y5Rd
oeaXXWSGHhV/SVXRbF+ehFH3VBwaf4x/hYJ8Z2GyUSTf5vqKoGHlp91Ck0h+
O2Ol8I7+56W3bfReXtAGH8YGgnC4zDIGNdsU6Wsc7R10M5ddLXaOGlJIHFBV
vjHDUwPbQ8xdz1w516ljGnUuDPd1TI1QbdoncTgQfe1U3qZ/ZClboLVz/irU
9e/gYO5d+w1YMbi5E/4H/gNJyg==
  "],
 CellLabel->"In[62]:=",ExpressionUUID->"1e07b56f-f136-47c4-9553-e87e17a30aad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"factnb", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.772538577538379*^9, 3.7725386199839873`*^9}, {
  3.772561259726162*^9, 3.772561268849103*^9}, {3.772561320736054*^9, 
  3.772561325953581*^9}, {3.830432408422649*^9, 3.830432416905243*^9}, {
  3.8910901180530777`*^9, 3.891090122529446*^9}, {3.9646975567432613`*^9, 
  3.964697557944315*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"a7d911b3-eee9-4b2a-b2b8-948bba775620"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"titlecells", "=", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "factnb", ",", "\"\<Title\>\"", ",", "All", ",", "CellStyle", ",", 
      RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SetOptions", "[", 
    RowBox[{"titlecells", ",", 
     RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
     RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
     RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8910902656293154`*^9, 3.891090266622034*^9}, {
   3.891090384094948*^9, 3.891090407429324*^9}, {3.891090914562275*^9, 
   3.891090936993514*^9}, {3.8910915436538734`*^9, 3.891091572055435*^9}, 
   3.891091924493365*^9, 3.917520179537324*^9, 3.964697572951662*^9, 
   3.9646977372082424`*^9, 3.9646977808572807`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"77355e1c-4177-4fb8-8edb-dbe45e11f706"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chaptercells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "factnb", ",", "\"\<Chapter\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"chaptercells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.89109042462824*^9, 3.8910904405047717`*^9}, {
   3.891090916757201*^9, 3.8910909396525908`*^9}, {3.891091547582393*^9, 
   3.891091577237577*^9}, 3.8910919293854947`*^9, 3.9646975746035385`*^9, 
   3.964697739093193*^9, 3.964697781486*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"d3bf5f95-66b2-4f95-906b-ce0e209a9d3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inputcells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{"factnb", ",", "\"\<Input\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"inputcells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "True"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.771338808327732*^9, 3.771338838774293*^9}, {
   3.771338872744232*^9, 3.771338901557121*^9}, {3.771339034391318*^9, 
   3.771339063783631*^9}, {3.771339096151359*^9, 3.77133911357322*^9}, {
   3.7713391442197604`*^9, 3.771339195676179*^9}, 3.771339390495008*^9, {
   3.771339575119819*^9, 3.77133960170828*^9}, {3.771339739830652*^9, 
   3.771339753379721*^9}, {3.771339783839568*^9, 3.771339793445896*^9}, {
   3.771339833663968*^9, 3.771339946755887*^9}, {3.771340040454396*^9, 
   3.7713400465261693`*^9}, {3.771340259874557*^9, 3.771340271029802*^9}, {
   3.7713410257249985`*^9, 3.771341027165447*^9}, {3.771606733315581*^9, 
   3.771606787720738*^9}, {3.771606856897359*^9, 3.771606858779351*^9}, {
   3.7716072150920186`*^9, 3.771607308401827*^9}, {3.771947641014653*^9, 
   3.771947658952503*^9}, {3.771947728649555*^9, 3.771947738700951*^9}, {
   3.771954299562523*^9, 3.77195430125387*^9}, {3.771954364975469*^9, 
   3.771954381379567*^9}, {3.771954527937702*^9, 3.771954530200677*^9}, {
   3.77195470540431*^9, 3.7719547066070895`*^9}, {3.77195489796051*^9, 
   3.771954915845731*^9}, {3.771955207646293*^9, 3.771955213175476*^9}, {
   3.7719553031320677`*^9, 3.77195541435301*^9}, {3.771955485493906*^9, 
   3.771955507270805*^9}, {3.771955615850394*^9, 3.771955652370714*^9}, {
   3.77195568965801*^9, 3.7719556917224617`*^9}, {3.772538628388029*^9, 
   3.77253862871608*^9}, {3.7725387108370686`*^9, 3.772538722818409*^9}, 
   3.772540335851931*^9, {3.891090205311295*^9, 3.8910902285047684`*^9}, 
   3.891091580478188*^9, 3.8910919327171707`*^9, {3.891091971058379*^9, 
   3.891091971577311*^9}, {3.8914316370784664`*^9, 3.891431656583597*^9}, 
   3.9646975768344955`*^9, 3.9646977407136326`*^9, 3.96469778192618*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"bbfa2081-a5a0-4abc-87e8-a9da942e85a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sectioncells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "factnb", ",", "\"\<Section\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"sectioncells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.77195551243602*^9, 3.771955518776033*^9}, 
   3.771955628221305*^9, 3.7719556973643703`*^9, {3.772538632356098*^9, 
   3.772538632684143*^9}, {3.772538725708537*^9, 3.772538731660059*^9}, {
   3.8910909216294627`*^9, 3.8910909427142878`*^9}, 3.891091551004353*^9, 
   3.8910915828025255`*^9, 3.891091937446484*^9, 3.964697577449171*^9, 
   3.9646977420191975`*^9, 3.9646977824303436`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"c4abfedf-58bb-4f4e-90fe-540e1c96c9c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subsectioncells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "factnb", ",", "\"\<Subsection\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"subsectioncells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.771955395965189*^9, 3.771955399206523*^9}, {
   3.771955522226803*^9, 3.771955528625688*^9}, 3.771955632052058*^9, 
   3.771955700198789*^9, {3.772538634372338*^9, 3.772538634641591*^9}, {
   3.7725387345536785`*^9, 3.77253873822447*^9}, {3.772538795105706*^9, 
   3.772538801026188*^9}, {3.891090925484731*^9, 3.891090944909641*^9}, 
   3.8910915549278483`*^9, 3.891091587373644*^9, 3.891091942197639*^9, 
   3.9646975778419228`*^9, 3.964697742507929*^9, 3.9646977840501614`*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"d7a60119-7683-4776-bfe0-95edf7cb4710"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subsubsectioncells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "factnb", ",", "\"\<Subsubsection\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"subsubsectioncells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.771955395965189*^9, 3.771955399206523*^9}, {
   3.771955522226803*^9, 3.771955528625688*^9}, 3.771955632052058*^9, 
   3.771955700198789*^9, {3.772538634372338*^9, 3.772538634641591*^9}, {
   3.7725387345536785`*^9, 3.77253873822447*^9}, {3.772538795105706*^9, 
   3.772538801026188*^9}, {3.891090925484731*^9, 3.891090944909641*^9}, 
   3.8910915549278483`*^9, 3.891091587373644*^9, 3.891091942197639*^9, {
   3.892127164483782*^9, 3.8921271757414236`*^9}, 3.964697578236637*^9, 
   3.964697743107565*^9, 3.9646977848673096`*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"00768015-e5be-4e18-b199-f43fb337c557"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"codetextcells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "factnb", ",", "\"\<CodeText\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"codetextcells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editfe"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletefe"}]}], "]"}], ";"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8910904962749925`*^9, 3.891090510417102*^9}, {
   3.891090928681288*^9, 3.891090947940693*^9}, 3.89109155744357*^9, 
   3.891091591002169*^9, 3.891091946048278*^9, 3.9646975789750214`*^9, {
   3.964697743907961*^9, 3.9646977719780483`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"10968b4b-72c4-45bb-a3b2-7b27f1200796"]
}, Closed]],

Cell[CellGroupData[{

Cell["History length", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.772886678242123*^9, 3.772886704067807*^9}, {
  3.892645745119619*^9, 
  3.892645745516116*^9}},ExpressionUUID->"2d366563-be9f-4a76-937b-\
02af69147d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Sets", " ", "the", " ", "history", " ", "length", " ", "of", " ", "In", 
    " ", "and", " ", "Out", " ", 
    RowBox[{"values", ".", " ", "Evaluate"}], " ", "this", " ", "line", " ", 
    "if", " ", "you", " ", "wish", " ", "to", " ", "save", " ", "computer", 
    " ", 
    RowBox[{"memory", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"$HistoryLength", "=", "0"}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.771339235100431*^9, 3.771339241380398*^9}, 
   3.77133960432326*^9, 3.771947740365743*^9, {3.83034862192086*^9, 
   3.830348622018442*^9}, {3.894021263686507*^9, 3.8940212945180197`*^9}, {
   3.894021347531183*^9, 3.89402140949129*^9}, 3.8940276463250155`*^9, 
   3.8940330266699514`*^9},ExpressionUUID->"099947f2-56a2-4b8f-a86c-\
70298459f5a3"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluation cells", "Chapter",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891089517932328*^9, 3.8910895187257533`*^9}, {
  3.892646733326543*^9, 
  3.892646735082882*^9}},ExpressionUUID->"349a0422-87d8-4669-af67-\
e3b5c113851c"],

Cell[CellGroupData[{

Cell["Importing and trimming original images", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 
  3.8910973817893853`*^9}},ExpressionUUID->"118a075b-95b5-4ff4-9f02-\
43831627d5fc"],

Cell[CellGroupData[{

Cell["Import", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 
  3.891097395877677*^9}},ExpressionUUID->"68a08422-1e9e-41a5-b721-\
64c36119badd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Prints", " ", "the", " ", "file", " ", "path", " ", "for", " ", "the", 
    " ", "corresponding", " ", "data", " ", "file", " ", 
    RowBox[{"folder", ".", " ", "If"}], " ", "this", " ", "line", " ", "does",
     " ", "not", " ", "return", " ", "a", " ", "file", " ", 
    RowBox[{"path", ".", " ", "The"}], " ", "file", " ", "name", " ", "in", 
    " ", "datafn", " ", "is", " ", "either", " ", "incorrect", " ", "or", " ",
     "the", " ", "file", " ", "is", " ", "not", " ", "in", " ", "the", " ", 
    "Data", " ", "files", " ", 
    RowBox[{"folder", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"datapath", "=", 
   RowBox[{"First", "@", 
    RowBox[{"FileNames", "[", 
     RowBox[{"datafn", ",", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<Data files\>\"", ",", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.92833238605638*^9, 3.928332425306793*^9}, {
   3.9283324933576393`*^9, 3.928332506710682*^9}, {3.9283325998255253`*^9, 
   3.928332601886633*^9}, 3.928332649559601*^9, {3.928333015403223*^9, 
   3.928333022948576*^9}, {3.92841585387689*^9, 3.928415873854645*^9}, {
   3.928415940775585*^9, 3.928416025807007*^9}, {3.947863197184742*^9, 
   3.947863199367481*^9}, 3.947863251671397*^9, {3.947863645056193*^9, 
   3.9478636893367424`*^9}, 3.948369672828434*^9, {3.948369772686886*^9, 
   3.948369815943056*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"a5217fc8-82b6-5d49-a6e3-3ec899188c26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Prints", " ", "a", " ", "table", " ", "with", " ", "the", " ", "image", 
    " ", "names", " ", "contained", " ", "in", " ", "the", " ", "Original", 
    " ", "images", " ", 
    RowBox[{"folder", ".", " ", "Also"}], " ", "prints", " ", "the", " ", 
    "total", " ", "number", " ", "of", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fnoriginal", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{"All", ",", 
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<Original images\>\"", ",", "datapath"}], "]"}]}], 
        "]"}], ",", "sortFunc2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tableDisplay1", "[", "fnoriginal", "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947863331822939*^9, 3.9478633363322506`*^9}, {
  3.947863439745123*^9, 3.947863441269457*^9}, {3.947863492122896*^9, 
  3.9478635048795643`*^9}, {3.947863540161583*^9, 3.947863635557915*^9}, {
  3.94786371233679*^9, 3.9478637159252033`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"aa100876-cc6c-9f46-a113-df5ac0915af7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "original", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"originalimgs", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Import", ",", "fnoriginal"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageDimensions", "/@", "originalimgs"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8910956904505177`*^9, 3.891095704415741*^9}, {
  3.891095757650249*^9, 3.891095779300108*^9}, {3.891095818808937*^9, 
  3.891095819698707*^9}, {3.891698561582723*^9, 3.891698582434489*^9}, {
  3.894713211967542*^9, 3.8947132146246386`*^9}, {3.947863730030365*^9, 
  3.947863730849394*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"17cb3541-091d-40f3-8c8f-233cbc26bf68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "of", " ", "the", " ", "imported", " ", "original", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"originalimgs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "size"}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "originalimgs", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8910974512457905`*^9, 3.891097456325987*^9}, {
  3.892898551731222*^9, 3.892898563288407*^9}, {3.919248854976106*^9, 
  3.919248876068861*^9}, {3.919248919823968*^9, 3.91924900279977*^9}, {
  3.920735325028683*^9, 3.920735327387508*^9}, {3.9376570264668427`*^9, 
  3.937657032641447*^9}, {3.940424434525053*^9, 3.940424441796973*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"1c77c5c6-3007-4c23-8e55-07aee67ae891"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image trim", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 3.891097395877677*^9}, {3.8910974850903473`*^9, 
  3.891097486253567*^9}},ExpressionUUID->"554d41db-d24a-4968-8010-\
6368a8616514"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Trims", " ", "input", " ", "images", " ", "to", " ", "specified", " ", 
    "dimensions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imgtrimres", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"usetrim", "===", "\"\<yes\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"trimmingFunc", "[", 
        RowBox[{"originalimgs", ",", "trimdims"}], "]"}], ",", 
       "\[IndentingNewLine]", "originalimgs"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageDimensions", "/@", "imgtrimres"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.863017428660854*^9, 3.863017524549455*^9}, {
   3.863017570232913*^9, 3.863017665386424*^9}, {3.8630188407732944`*^9, 
   3.863018842653201*^9}, {3.863021967365981*^9, 3.863021982161851*^9}, {
   3.863022051910017*^9, 3.863022052306374*^9}, {3.863178714294935*^9, 
   3.8631787171433196`*^9}, {3.863187802130162*^9, 3.863187802735758*^9}, 
   3.864994192922231*^9, {3.871122918248298*^9, 3.871122918416089*^9}, 
   3.8711351109914813`*^9, 3.8865232225311613`*^9, 3.88652460781071*^9, {
   3.889113374714956*^9, 3.889113457051243*^9}, {3.889113672942201*^9, 
   3.889113679059427*^9}, {3.889113735700554*^9, 3.889113739445809*^9}, {
   3.889114688620742*^9, 3.8891146966178055`*^9}, {3.889114816257015*^9, 
   3.889114865360516*^9}, {3.891097332795548*^9, 3.891097341453368*^9}, {
   3.8910974262766867`*^9, 3.891097429048387*^9}, {3.8913449708253803`*^9, 
   3.8913449912343326`*^9}, 3.891350032113908*^9, {3.8914267698900976`*^9, 
   3.891426782509559*^9}, {3.891698533925237*^9, 3.8916985515583925`*^9}, {
   3.895589927426583*^9, 3.895589932991272*^9}, 3.917441719606267*^9, 
   3.943359977507155*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"a387ef5a-0ecc-40a1-853a-f3abeb07c77e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Display", " ", "of", " ", "the", " ", "trimming", " ", "result"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"imgtrimres", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "size"}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "imgtrimres", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.869931994574445*^9, 3.869932035556778*^9}, {
  3.870174664972788*^9, 3.8701746700350866`*^9}, {3.871122925777913*^9, 
  3.8711229285512705`*^9}, {3.891097437780856*^9, 3.891097440842171*^9}, {
  3.891426932364215*^9, 3.891426936284279*^9}, {3.891426983208064*^9, 
  3.891427060432517*^9}, {3.891427142302941*^9, 3.8914271427887664`*^9}, {
  3.891429832264849*^9, 3.891429840763827*^9}, {3.892898534007646*^9, 
  3.892898544513264*^9}, {3.9207354543880677`*^9, 3.920735455559668*^9}, {
  3.946484273467338*^9, 3.9464843003995514`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"717e3397-69dc-41f5-abb9-c62a96b2c69f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export trimmed images", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 3.891097395877677*^9}, {3.8910974850903473`*^9, 
  3.891097486253567*^9}, {3.9479451018044147`*^9, 
  3.9479451068417244`*^9}},ExpressionUUID->"68758e8d-4aa2-f144-9dd1-\
6dd50bf3f890"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Exporting", " ", "trimmed", " ", "images"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"expMult", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Trimmed images\>\"", ",", "datapath", ",", "2"}], "]"}]}], 
    ",", "fnoriginal", ",", "\"\<.tiff\>\"", ",", "imgtrimres"}], 
   "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8913546672794857`*^9, 3.891354709529828*^9}, {
   3.891354814726363*^9, 3.8913548545430303`*^9}, {3.891355010325126*^9, 
   3.891355011568942*^9}, {3.891355142708428*^9, 3.891355144950619*^9}, 
   3.891355357940527*^9, {3.8913558518202744`*^9, 3.891355853819799*^9}, {
   3.891356682429831*^9, 3.891356683679535*^9}, 3.891619303695928*^9, 
   3.94786687815514*^9, {3.9481951096957417`*^9, 3.9481951099902*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"09baabc2-67d3-4942-8291-8e918260a647"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pixel size determination", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 
  3.891344524322372*^9}},ExpressionUUID->"4c86325e-eac6-4adb-a380-\
7d109927b96a"],

Cell[CellGroupData[{

Cell["Measuring pixel size", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.948290068211899*^9, 
  3.948290086591458*^9}},ExpressionUUID->"9957855b-ccb6-d642-b8df-\
8c287dbab9bf"],

Cell[CellGroupData[{

Cell["Scale bar", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 3.891097395877677*^9}, {3.8910974850903473`*^9, 
  3.891097486253567*^9}, {3.891342431468978*^9, 3.891342437115471*^9}, {
  3.892559438116263*^9, 3.892559439709887*^9}, {3.895762140995046*^9, 
  3.8957621435120907`*^9}},ExpressionUUID->"8ae4084f-5e0f-4284-a312-\
e7e025f2100a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Trim", " ", "images", " ", "to", " ", "only", " ", "include", " ", "the", 
    " ", "scale", " ", 
    RowBox[{"bar", ".", " ", "This"}], " ", "is", " ", "used", " ", "to", " ",
     "obtain", " ", "the", " ", "scale", " ", "bar", " ", "length", " ", "in",
     " ", "pixels"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"scalebarimg", "=", 
     RowBox[{"trimmingFunc", "[", 
      RowBox[{"originalimgs", ",", "scalebarroi"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"imgDisplay1", "[", 
    RowBox[{"scalebarimg", ",", "400", ",", "Automatic"}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.871125091889655*^9, 3.871125115603945*^9}, {
   3.871125159017439*^9, 3.8711251599495325`*^9}, {3.8711254505579824`*^9, 
   3.871125479930515*^9}, 3.871135135419979*^9, 3.871138105012437*^9, {
   3.889113752290184*^9, 3.889113756916098*^9}, {3.88911488196082*^9, 
   3.889114954461429*^9}, {3.891342389234097*^9, 3.891342393411298*^9}, 
   3.8913424671976748`*^9, {3.891342522745339*^9, 3.891342544638146*^9}, 
   3.891342689842103*^9, {3.891343519525964*^9, 3.891343525860042*^9}, {
   3.891429225148146*^9, 3.891429230062264*^9}, {3.891698647674848*^9, 
   3.891698685703654*^9}, 3.891698725208241*^9, {3.947864577591696*^9, 
   3.947864577831049*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"cb77a62b-281d-454a-a22d-cb71a91dc0e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Searches", " ", "for", " ", "the", " ", "scale", " ", "bar", " ", "in", 
    " ", "scalebarimg", " ", "and", " ", "calculates", " ", "its", " ", 
    "bounding", " ", 
    RowBox[{"box", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scalebarmeas", "=", 
    RowBox[{"Values", "@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"colnegate", "===", "\"\<yes\>\""}], ",", 
                RowBox[{"ColorNegate", "[", "#", "]"}], ",", "#"}], "]"}], 
              ",", "sbthreshold"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Count\>\"", ",", "\"\<Length\>\"", ",", "\"\<Centroid\>\"", 
              ",", "\"\<BoundingBox\>\"", ",", "\"\<Label\>\""}], "}"}], ",", 
            RowBox[{
             RowBox[{"#Length", ">", "minlength"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "&"}], ",", 
       "scalebarimg"}], "]"}]}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8913436433878*^9, 3.891343644138378*^9}, {
   3.892897957598061*^9, 3.8928979595026073`*^9}, {3.892898003942115*^9, 
   3.8928980264074264`*^9}, 3.8955721869224844`*^9, {3.895673949218272*^9, 
   3.895673951070023*^9}, {3.895742382716023*^9, 3.895742393431038*^9}, {
   3.895747208704493*^9, 3.895747219169466*^9}, {3.917442230953373*^9, 
   3.917442232052604*^9}, {3.917442278116393*^9, 3.917442294638304*^9}, {
   3.948369168475371*^9, 3.948369170972492*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"92f77707-bb1f-4716-91d6-8b1c574783f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "of", " ", "the", " ", "scale", " ", "bar", " ", 
    "bounding", " ", 
    RowBox[{"box", ".", " ", "For"}], " ", "images", " ", "that", " ", "have",
     " ", "a", " ", "continous", " ", "scale", " ", "bar", " ", "make", " ", 
    "sure", " ", "the", " ", "bounding", " ", "box", " ", "perfectly", " ", 
    "encapsulates", " ", "this", " ", "scale", " ", 
    RowBox[{"bar", ".", " ", "For"}], " ", "images", " ", "that", " ", "have",
     " ", "multiple", " ", "scale", " ", "bar", " ", "segments", " ", "make", 
    " ", "sure", " ", "that", " ", "at", " ", "least", " ", "the", " ", 
    "first", " ", "and", " ", "last", " ", "segment", " ", "is", " ", 
    "properly", " ", 
    RowBox[{"highlighted", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"scalebarhighlight", "=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HighlightImage", "[", 
      RowBox[{
       RowBox[{"scalebarimg", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rectangle", "@@@", 
          RowBox[{"scalebarmeas", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "All", ",", "4"}], "]"}], "]"}]}], ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#1", ",", "Green", ",", "12", ",", "Bold"}], "]"}], 
              ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"scalebarmeas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "All", ",", "5"}], "]"}], "]"}], ",", 
             RowBox[{"scalebarmeas", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "scalebarmeas", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.895742501990228*^9, 3.895742571242119*^9}, {
   3.8957455559969754`*^9, 3.895745557716821*^9}, {3.895747250816947*^9, 
   3.895747364497228*^9}, {3.895747868097518*^9, 3.8957479497595177`*^9}, 
   3.89574818557963*^9, {3.895748218410343*^9, 3.895748321738181*^9}, {
   3.895748691339155*^9, 3.895748705644765*^9}, {3.8957582306014743`*^9, 
   3.895758239051535*^9}, {3.895760816176944*^9, 3.895760816857694*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"b52d958a-1a69-4f8b-bef3-20db2d9767ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computes", " ", "the", " ", "number", " ", "of", " ", "pixels", " ", 
    "across", " ", "the", " ", "scale", " ", "bar", " ", "bounding", " ", 
    RowBox[{"box", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pixelcount", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pixCountFunc", "[", 
         RowBox[{"#", ",", "scalebarlabel"}], "]"}], "&"}], ",", 
       "scalebarmeas"}], "]"}]}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.892898083474766*^9, 3.892898105527194*^9}, {
   3.895752476647198*^9, 3.89575251189514*^9}, {3.895752594303652*^9, 
   3.895752601795782*^9}, 3.8957526385389767`*^9, {3.895757968337742*^9, 
   3.895757970946153*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"acf74bdf-4a0a-4ae0-a2b1-171b06633dd9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scale bar magnitude", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 3.891097395877677*^9}, {3.8910974850903473`*^9, 
  3.891097486253567*^9}, {3.891342431468978*^9, 3.891342437115471*^9}, {
  3.892559438116263*^9, 3.892559439709887*^9}, {3.895762140995046*^9, 
  3.8957621557650723`*^9}},ExpressionUUID->"0b504989-225c-4ac6-befa-\
e1bc49f8f573"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Trim", " ", "images", " ", "to", " ", "only", " ", "include", " ", "the", 
    " ", "scale", " ", "bar", " ", 
    RowBox[{"magnitude", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sbimg", "=", 
     RowBox[{"trimmingFunc", "[", 
      RowBox[{"originalimgs", ",", "sbmagroi"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"imgDisplay1", "[", 
    RowBox[{"sbimg", ",", "400", ",", "Automatic"}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{
  3.947865299308929*^9, {3.94786533499646*^9, 3.9478653608946037`*^9}, {
   3.9483692054412975`*^9, 3.9483692074050446`*^9}, {3.948369423581829*^9, 
   3.9483694361506157`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"99c7e7d0-0796-e44b-b33d-28c1b3324093"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Converts", " ", "the", " ", "user", " ", "input", " ", "values", " ", 
    "from", " ", "scalebarmag", " ", "and", " ", "converts", " ", "them", " ",
     "into", " ", 
    RowBox[{"quantities", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sbquantity", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Quantity", "[", 
       RowBox[{"#", ",", "scalebarunit"}], "]"}], "&"}], ",", "scalebarmag"}],
     "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.895764899959526*^9, 3.895764985182582*^9}, {
  3.89576507569493*^9, 3.8957650792344227`*^9}, {3.895765142854276*^9, 
  3.895765192883772*^9}, {3.8957653482103415`*^9, 3.895765349994894*^9}, {
  3.8957654423104115`*^9, 3.895765485780958*^9}, {3.947864916534183*^9, 
  3.947864956887203*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"89766158-a54c-4073-8a7f-ca59906382e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "comparing", " ", "the", " ", "magnitude", " ", "values", 
    " ", "input", " ", "in", " ", "scalebarmag", " ", "with", " ", "its", " ",
     "corresponding", " ", "scale", " ", "bar", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sbquantity", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "->", 
         RowBox[{"sbimg", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"RasterSize", "->", "500"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "500"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "sbimg", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891343757522135*^9, 3.8913437795647*^9}, {
   3.892898213051507*^9, 3.892898255762904*^9}, {3.892898326395458*^9, 
   3.892898350936886*^9}, {3.895745101569137*^9, 3.895745109218396*^9}, {
   3.895745426035781*^9, 3.895745500589029*^9}, {3.895755297597043*^9, 
   3.895755297800294*^9}, {3.8957652171303253`*^9, 3.8957652183326473`*^9}, 
   3.895765503237924*^9, {3.94786538418054*^9, 3.947865390766069*^9}, {
   3.948369278136721*^9, 3.9483692786234016`*^9}, {3.948369314253914*^9, 
   3.948369359882054*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"4e7973b6-5d88-4433-a639-2944cb9f51e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Pixel", " ", "size", " ", "in", " ", 
    RowBox[{"units", "/", "pixel"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pixelsize", "=", 
    RowBox[{"sbquantity", "/", "pixelcount"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891343844225094*^9, 3.8913438554890337`*^9}, {
  3.892898361361085*^9, 3.8928983723024426`*^9}, {3.892898452525059*^9, 
  3.892898455863892*^9}, {3.8957652389589243`*^9, 3.8957652416622353`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"08b54d73-968a-4379-bea2-8e8060ea7569"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "formated", " ", "as", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", " ", "name"}], ",", " ", "pixelsize"}], "}"}], "."}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"psmagnitude", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileBaseName", "[", "#1", "]"}], ",", "#2"}], "}"}], "&"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"fnoriginal", ",", 
         RowBox[{"QuantityMagnitude", "[", "pixelsize", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", "psmagnitude", "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8913438694524136`*^9, 3.891343872071589*^9}, {
  3.891352430347613*^9, 3.891352455256798*^9}, {3.892898462048815*^9, 
  3.892898512933408*^9}, {3.895654357656658*^9, 3.89565437703573*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"1b70b825-26b4-4462-a66c-7d483976ad87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Exporting", " ", "computed", " ", "pixel", " ", "size", " ", "data"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"exportFunc", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Pixel sizes\>\"", ",", "datapath", ",", "2"}], "]"}]}], 
    ",", "\"\<pixsize.mx\>\"", ",", "psmagnitude"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947865954916706*^9, 3.9478659661985703`*^9}, {
  3.947866014284717*^9, 3.9478660364810047`*^9}, {3.948195521326798*^9, 
  3.948195522501656*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"ab3fa514-95d1-f94f-85c4-5b689233a5e0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pixel size data select", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.891096538433184*^9, 3.89109654180459*^9}, {
  3.891097395305043*^9, 3.891097395877677*^9}, {3.8910974850903473`*^9, 
  3.891097486253567*^9}, {3.891342431468978*^9, 3.891342437115471*^9}, {
  3.8913446136373243`*^9, 3.891344620961215*^9}, {3.9478674770361366`*^9, 
  3.947867484243101*^9}},ExpressionUUID->"0059ea0b-b1d6-42a3-b0b8-\
9e366a14585b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Imports", " ", "and", " ", "prints", " ", "a", " ", "table", " ", "with", 
    " ", "the", " ", "image", " ", "names", " ", "and", " ", "corresponding", 
    " ", "pixel", " ", 
    RowBox[{"sizes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"psimport", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "#", "]"}], ",", "2"}], "]"}], "&"}], "@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"psImportFunc", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"All", ",", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<Pixel sizes\>\"", ",", "datapath", ",", "2"}], 
           "]"}]}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tableDisplay2", "[", "psimport", "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8913452520669155`*^9, 3.891345254420206*^9}, {
   3.891345870254497*^9, 3.891345912944919*^9}, {3.891345949759994*^9, 
   3.891345957691239*^9}, {3.891348546574409*^9, 3.891348550868831*^9}, {
   3.891348788741563*^9, 3.891348796900621*^9}, {3.891349240590469*^9, 
   3.891349244419242*^9}, {3.891349823426389*^9, 3.891349836745733*^9}, {
   3.891350552762295*^9, 3.891350553183511*^9}, {3.891350705703666*^9, 
   3.8913507198981924`*^9}, {3.891350871189601*^9, 3.891350920927162*^9}, {
   3.891350988319236*^9, 3.891350988458628*^9}, {3.891351019654488*^9, 
   3.891351069635619*^9}, {3.8913511528072615`*^9, 3.891351160816413*^9}, {
   3.891351259145673*^9, 3.89135126049697*^9}, {3.891351515410946*^9, 
   3.891351516986431*^9}, {3.89169832601504*^9, 3.891698353689118*^9}, {
   3.891698464875727*^9, 3.8916985035529466`*^9}, {3.9022249890821733`*^9, 
   3.90222506281818*^9}, 3.9478656898322983`*^9, {3.94819556546476*^9, 
   3.948195565729054*^9}, 3.948369109803032*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"04281dc9-8286-4a63-b432-9bfa4210b907"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Evaluate", " ", "this", " ", "line", " ", "to", " ", "select", " ", 
     "between", " ", "using", " ", "the", " ", "imported", " ", "pixel", " ", 
     "size", " ", "data"}], ",", " ", 
    RowBox[{
    "or", " ", "setting", " ", "the", " ", "pixel", " ", "size", " ", "to", 
     " ", "1", " ", "and", " ", "conducting", " ", "the", " ", "analysis", 
     " ", "in", " ", 
     RowBox[{"pixels", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ps", "=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"useautomaticps", "===", "\"\<no\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FileBaseName", "[", "#1", "]"}], ",", "#2"}], "}"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"fnoriginal", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1.0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "imgtrimres", "]"}], "}"}]}], "]"}]}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"useautomaticps", "===", "\"\<import\>\""}], "||", 
        RowBox[{"useautomaticps", "===", "\"\<yes\>\""}]}], ",", "psimport"}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tableDisplay2", "[", "ps", "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8913446605484467`*^9, 3.891344726598773*^9}, {
  3.891345055829439*^9, 3.891345188851963*^9}, {3.891345257791134*^9, 
  3.89134525886983*^9}, {3.891352860846005*^9, 3.891352888906562*^9}, {
  3.891447794280266*^9, 3.891447804578018*^9}, {3.891699470697764*^9, 
  3.891699471320265*^9}, {3.8925668478171635`*^9, 3.892566977795786*^9}, {
  3.947866142871901*^9, 3.947866161204359*^9}, {3.947866215755785*^9, 
  3.94786625299944*^9}, {3.9483691277561817`*^9, 3.948369128384411*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"33d2adf7-771d-4f38-b6e2-93ed445713fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segmenting images", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.891358748791428*^9, 
  3.891358751790722*^9}},ExpressionUUID->"7efe87df-513a-42df-9352-\
e32c8b79665c"],

Cell[CellGroupData[{

Cell["Thresholding segmentation", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 
  3.864382217837672*^9}},ExpressionUUID->"7e89aae6-78de-4e21-83e6-\
e5aadc4f654f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Normalizes", " ", "the", " ", "data", " ", "in", " ", "the", " ", 
    "original", " ", "images", " ", "to", " ", "be", " ", "between", " ", "0",
     " ", "and", " ", "1."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"normalizedimgs", "=", 
    RowBox[{"normalizingFunc", "[", "imgtrimres", "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891425963477401*^9, 3.891425973966926*^9}, {
  3.891426243955199*^9, 3.891426249102764*^9}, {3.892565543573586*^9, 
  3.892565575856569*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"0e6d3cde-8944-4646-bd23-bc766b64aac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Segments", " ", "the", " ", "images", " ", "by", " ", "applying", " ", 
    "a", " ", 
    RowBox[{"threshold", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"threshbinary", "=", 
    RowBox[{"thresholdFunc", "[", 
     RowBox[{"normalizedimgs", ",", "threshvals"}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.861800674367175*^9, 3.861800693542961*^9}, {
   3.861802764289271*^9, 3.86180279931948*^9}, {3.861803006932199*^9, 
   3.861803007104726*^9}, {3.8618032954012537`*^9, 3.861803341494529*^9}, {
   3.861803383706072*^9, 3.861803417121227*^9}, {3.861803772841733*^9, 
   3.8618037903341937`*^9}, {3.861803857111757*^9, 3.861803902022204*^9}, {
   3.861803996010107*^9, 3.861804007505827*^9}, {3.86180420053693*^9, 
   3.861804210932003*^9}, {3.8618046848154964`*^9, 3.86180468794044*^9}, {
   3.861804927073445*^9, 3.8618049286194944`*^9}, {3.861805486128638*^9, 
   3.861805494731183*^9}, 3.861805695991085*^9, 3.861805823523259*^9, {
   3.8618069403206344`*^9, 3.861806957751158*^9}, 3.861873851127963*^9, {
   3.861874117328577*^9, 3.861874117420416*^9}, 3.8618745686088*^9, {
   3.861889507425088*^9, 3.861889524234441*^9}, {3.861970409048357*^9, 
   3.86197044080923*^9}, {3.861977947803968*^9, 3.8619779562611885`*^9}, {
   3.86197800316368*^9, 3.8619780034134*^9}, {3.86205112602625*^9, 
   3.862051126572062*^9}, {3.862051162060619*^9, 3.862051269740823*^9}, {
   3.862051556948595*^9, 3.862051558672457*^9}, {3.862051614597978*^9, 
   3.862051681179126*^9}, 3.862578708350526*^9, {3.862660371249636*^9, 
   3.862660373687361*^9}, {3.863081917846792*^9, 3.863081918666075*^9}, {
   3.863092958914613*^9, 3.8630929717430534`*^9}, {3.863093285260983*^9, 
   3.863093294126014*^9}, {3.863093579397232*^9, 3.863093580122591*^9}, 
   3.864382737502695*^9, {3.864481420956477*^9, 3.864481440286583*^9}, 
   3.864481579638398*^9, 3.865431205313284*^9, {3.87045033676941*^9, 
   3.870450353214443*^9}, {3.870450412840009*^9, 3.870450450345771*^9}, {
   3.870528203683776*^9, 3.870528204323032*^9}, {3.870532212916817*^9, 
   3.87053221298367*^9}, {3.8705323450017004`*^9, 3.8705323584866495`*^9}, {
   3.870532475851899*^9, 3.870532479300662*^9}, {3.870532513103292*^9, 
   3.8705325250952363`*^9}, {3.871489489741064*^9, 3.871489489807298*^9}, {
   3.8714895304404774`*^9, 3.871489531058286*^9}, {3.8715759615489564`*^9, 
   3.8715760098966107`*^9}, {3.871645726631561*^9, 3.871645727004144*^9}, {
   3.87164591537769*^9, 3.871645915679316*^9}, {3.8721647129976892`*^9, 
   3.872164714490864*^9}, {3.87347136775871*^9, 3.8734713775076485`*^9}, {
   3.873899337564538*^9, 3.873899337822821*^9}, {3.8740695724464836`*^9, 
   3.874069573234245*^9}, {3.877513994312137*^9, 3.877514004895399*^9}, {
   3.891423506664728*^9, 3.8914235200521984`*^9}, {3.89142369058262*^9, 
   3.891423843920473*^9}, {3.8914239264973817`*^9, 3.89142393668146*^9}, {
   3.891425111879678*^9, 3.89142512455055*^9}, 3.8914253543691163`*^9, 
   3.891425421043352*^9, {3.8914310974580345`*^9, 3.891431099546894*^9}, {
   3.892565578847729*^9, 3.892565606218159*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"900318cf-4588-404e-a7d0-6496973e129b"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"threshbinary", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"ImageSize", "->", "size"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "threshbinary", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
     "100"}], "}"}], ",", 
   RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891425457506864*^9, 3.891425499147827*^9}, {
  3.891425654829234*^9, 3.89142566414466*^9}, {3.891431107831568*^9, 
  3.891431110964106*^9}, {3.947867330851321*^9, 3.947867338904877*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"7976bc06-c066-4aa5-8031-9c44b96e65cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing network probability maps or binary images", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189651589589*^9, 3.863189659437517*^9}, {
  3.864382685824139*^9, 3.864382691472054*^9}, {3.865002784926715*^9, 
  3.8650027957350583`*^9}, {3.865012428369185*^9, 3.865012459041228*^9}, {
  3.891430044796943*^9, 
  3.8914300512533493`*^9}},ExpressionUUID->"730c8676-b1a6-48ce-9259-\
bb7bed4d0a66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "names", " ", "of", " ", "the", " ", "file", 
    " ", "names", " ", "imported", " ", "binary", " ", "images"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fnimpbin", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{"All", ",", 
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<Segmented images\>\"", ",", "datapath"}], "]"}]}], 
        "]"}], ",", "sortFunc2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameTake", "[", "#", "]"}], "&"}], "/@", "fnimpbin"}], 
    "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8711223539993515`*^9, 3.87112236954141*^9}, {
   3.871122837384628*^9, 3.87112284036108*^9}, {3.8711378361047583`*^9, 
   3.87113784078288*^9}, {3.871138891142394*^9, 3.871138923371443*^9}, {
   3.871138973207327*^9, 3.8711390101111345`*^9}, {3.8720766810975*^9, 
   3.872076684931559*^9}, {3.8723444573761*^9, 3.872344460656614*^9}, {
   3.872595748698722*^9, 3.8725957518533716`*^9}, {3.889789960227605*^9, 
   3.8897899719019756`*^9}, {3.8897901288421702`*^9, 3.8897901305139084`*^9}, 
   3.890127508042076*^9, 3.891430068907419*^9, {3.891430106559445*^9, 
   3.891430112198184*^9}, {3.891430433155447*^9, 3.891430487674946*^9}, {
   3.892565612405729*^9, 3.892565639187097*^9}, {3.895576574249878*^9, 
   3.8955765743457327`*^9}, {3.947867274212567*^9, 3.9478672995009804`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"a2ae9755-0987-4b9d-92ed-f4eb2d974b68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Imports", " ", "the", " ", "binary", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"impbin", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"Import", ",", "fnimpbin"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"dimFunc", "[", "impbin", "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.86379616792714*^9, 3.863796206442045*^9}, {
   3.863886452701124*^9, 3.863886452747988*^9}, {3.864380082810336*^9, 
   3.864380083013268*^9}, {3.87112205633405*^9, 3.871122080013914*^9}, 
   3.8711223458620844`*^9, {3.8711223954114857`*^9, 3.8711223963003*^9}, {
   3.8711228449284534`*^9, 3.8711228449698663`*^9}, 3.8914305080023212`*^9, {
   3.891430872468259*^9, 3.891430873938505*^9}, {3.892565643807435*^9, 
   3.8925656562016473`*^9}, {3.895590841255062*^9, 3.895590846883092*^9}, {
   3.895655360385006*^9, 3.895655363492841*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"bd29f37f-9eec-4dfd-89a3-15570cd4129a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Selects", " ", "only", " ", "one", " ", "channel", " ", "if", " ", "a", 
     " ", "multi"}], "-", 
    RowBox[{"channeled", " ", "image", " ", "was", " ", 
     RowBox[{"imported", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"takeonechannel", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"ColorSeparate", "[", 
         RowBox[{"Image", "[", "#", "]"}], "]"}]}], "&"}], ",", "impbin"}], 
     "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.863796211572081*^9, 3.863796382974129*^9}, {
  3.891430911930067*^9, 3.891430922929474*^9}, {3.89256565903752*^9, 
  3.892565685994962*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"4ffd22e6-75e9-45da-912b-e8cad304a2db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Binarized", " ", "the", " ", "imported", " ", "images", " ", "at", " ", 
    "the", " ", "0.5", " ", "therholold", " ", 
    RowBox[{"level", ".", " ", "This"}], " ", "is", " ", "in", " ", "case", 
    " ", "a", " ", "probability", " ", "map", " ", "was", " ", 
    RowBox[{"imported", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"binsegres", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binarize", "[", 
        RowBox[{"#", ",", "0.5"}], "]"}], "&"}], ",", "takeonechannel"}], 
     "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.863797453405215*^9, 3.86379751063565*^9}, {
   3.863797550297708*^9, 3.863797573437374*^9}, {3.891430973807121*^9, 
   3.891430974170865*^9}, {3.892565689765013*^9, 3.8925657476622405`*^9}, 
   3.894033196028591*^9, {3.9399881610702343`*^9, 3.93998816122793*^9}, {
   3.93998832353224*^9, 3.939988323660364*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"1a334ecd-4754-4c2d-8112-0ad397d24ba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Display", " ", "of", " ", "imported", " ", "binary", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"binsegres", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "binsegres"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8637963995957313`*^9, 3.863796454936445*^9}, {
   3.8914309309503064`*^9, 3.891430938944249*^9}, {3.891431035330562*^9, 
   3.891431041501723*^9}, {3.892565752781418*^9, 3.892565764830796*^9}, {
   3.919249058411851*^9, 3.919249062301341*^9}, {3.920735531062919*^9, 
   3.920735532156415*^9}, {3.937656985780268*^9, 3.937656991268669*^9}, 
   3.940424520478105*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"c86ab03d-63f4-4c7d-b110-ebd50d9327c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Evaluate", " ", "this", " ", "line", " ", "to", " ", "select", " ", 
    "between", " ", "using", " ", "the", " ", "imported", " ", "binary", " ", 
    "images", " ", "or", " ", "the", " ", "computed", " ", "binary", " ", 
    "images", " ", "stored", " ", "in", " ", "the", " ", "variable", " ", 
    RowBox[{"threshbinary", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"binimgs", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"binselect", "===", "\"\<import\>\""}], ",", "binsegres", ",", 
       "threshbinary"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imgdims", "=", 
     RowBox[{"ImageDimensions", "/@", "binimgs"}]}], ";"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891433681037414*^9, 3.891433688699286*^9}, {
  3.8914338552876043`*^9, 3.891433883108518*^9}, {3.892566766138159*^9, 
  3.892566834278309*^9}, {3.948292497629831*^9, 3.94829251996372*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"48b76459-be0c-4bb2-8d38-012567371d9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image skeleton", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.891358748791428*^9, 
  3.891358751790722*^9}, {3.892033066890357*^9, 
  3.892033068736681*^9}},ExpressionUUID->"39a6f08f-b696-4801-9e78-\
5f806d82826c"],

Cell[CellGroupData[{

Cell["Skeleton of single image", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
  3.8914332273222404`*^9}, {3.8916989370113707`*^9, 3.891698949157485*^9}, {
  3.947932738303995*^9, 3.947932739003502*^9}, {3.947934947806826*^9, 
  3.947934948347166*^9}},ExpressionUUID->"4e293170-c74c-4437-b777-\
a969c3380949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Evaluate", " ", "this", " ", "to", " ", "extract", " ", "the", " ", 
     "active", " ", "image"}], ",", " ", 
    RowBox[{"active", " ", "binary", " ", "image"}], ",", " ", 
    RowBox[{
    "compute", " ", "the", " ", "moded", " ", "binary", " ", "image"}], ",", 
    " ", 
    RowBox[{
    "and", " ", "extract", " ", "the", " ", "pixel", " ", "size", " ", "of", 
     " ", "the", " ", "image", " ", "in", " ", "the", " ", "selected", " ", 
     "position", " ", 
     RowBox[{
      RowBox[{"(", "activeimgpos", ")"}], "."}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"activeimg", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"colneg", "===", "\"\<yes\>\""}], ",", 
       RowBox[{"ColorNegate", "[", 
        RowBox[{"imgtrimres", "[", 
         RowBox[{"[", "activeimgpos", "]"}], "]"}], "]"}], ",", 
       RowBox[{"imgtrimres", "[", 
        RowBox[{"[", "activeimgpos", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"activebinary", "=", 
     RowBox[{"binimgs", "[", 
      RowBox[{"[", "activeimgpos", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modedbinary", "=", 
     RowBox[{"SelectComponents", "[", 
      RowBox[{
       RowBox[{"Binarize", "[", 
        RowBox[{"GaussianFilter", "[", 
         RowBox[{"activebinary", ",", "kernsize"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#Count", ">=", "mincount"}], "&&", 
          RowBox[{"#Elongation", ">=", "minelongation"}]}], ")"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"scale", "=", 
     RowBox[{"ps", "[", 
      RowBox[{"[", 
       RowBox[{"activeimgpos", ",", "2"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891433435188153*^9, 3.8914335058456*^9}, {
   3.891433548965321*^9, 3.8914336074580975`*^9}, 3.891433895199682*^9, {
   3.891434549276347*^9, 3.8914345700490026`*^9}, {3.891435052320084*^9, 
   3.891435052802213*^9}, {3.891508106978658*^9, 3.891508111580451*^9}, {
   3.891508182064853*^9, 3.891508225251812*^9}, {3.89289991856295*^9, 
   3.892899990986184*^9}, {3.8929000599466887`*^9, 3.892900139380564*^9}, {
   3.892900179572231*^9, 3.892900180073422*^9}, {3.895677178463124*^9, 
   3.8956772005050545`*^9}, {3.895677413012131*^9, 3.895677413300853*^9}, {
   3.895677497316995*^9, 3.895677497729412*^9}, 3.89567761780147*^9, {
   3.895677680203705*^9, 3.895677680873988*^9}, {3.903705413762906*^9, 
   3.903705417469528*^9}, {3.93764798258918*^9, 3.937648033884227*^9}, {
   3.937648095916124*^9, 3.937648098013733*^9}, {3.9404257890480137`*^9, 
   3.940425805037627*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"b44fcdae-3148-4e2a-bf64-1ffaee3913e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computes", " ", "and", " ", "displays", " ", "the", " ", "distance", " ", 
    "tranform", " ", "of", " ", "the", " ", "active", " ", "moded", " ", 
    "binary", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dt", "=", 
     RowBox[{"DistanceTransform", "[", "activebinary", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicImage", "[", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", "dt"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "imgsize1"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8630823430220203`*^9, 3.863082390656685*^9}, {
   3.863086996720807*^9, 3.863087056965742*^9}, {3.863192942146709*^9, 
   3.863192944378557*^9}, {3.8632622772007627`*^9, 3.863262280824911*^9}, {
   3.863531894839526*^9, 3.863531899510047*^9}, {3.8635362830647554`*^9, 
   3.863536285503699*^9}, {3.863886857993637*^9, 3.863886860383692*^9}, {
   3.864135581636893*^9, 3.8641355852252398`*^9}, {3.8642283343037367`*^9, 
   3.864228341221144*^9}, {3.8643806350629897`*^9, 3.86438068180727*^9}, {
   3.86543371305424*^9, 3.865433716552561*^9}, 3.877514087317187*^9, {
   3.8865984062760534`*^9, 3.88659841411425*^9}, {3.891434752360317*^9, 
   3.89143477038242*^9}, {3.8929001446460447`*^9, 3.892900172593857*^9}, {
   3.94819707715616*^9, 3.94819707798708*^9}, {3.9588222789582863`*^9, 
   3.958822287707678*^9}, 3.9596851262635326`*^9},
 CellLabel->
  "In[423]:=",ExpressionUUID->"6d566ee8-3a28-48c7-9ca8-1d46df93e1ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Evaluate", " ", "this", " ", "line", " ", "to", " ", "compute", " ", 
    "the", " ", "skeleton", " ", "of", " ", "a", " ", "single", " ", "image", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "the", " ", "image", " ", "in", " ", "the", " ", "selected", " ", 
       "position", " ", "activeimgpos"}], ")"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"skeleton", "=", 
     RowBox[{"ImageMultiply", "[", 
      RowBox[{"dt", ",", 
       RowBox[{"Thinning", "[", 
        RowBox[{"modedbinary", ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Morphological\>\""}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pixpos", "=", 
     RowBox[{"PixelValuePositions", "[", 
      RowBox[{
       RowBox[{"Binarize", "[", 
        RowBox[{"skeleton", ",", "0.00001"}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pixpos1", "=", 
     RowBox[{"ImageValuePositions", "[", 
      RowBox[{
       RowBox[{"Binarize", "[", 
        RowBox[{"skeleton", ",", "0.00001"}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vals", "=", 
     RowBox[{"PixelValue", "[", 
      RowBox[{"skeleton", ",", "pixpos"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"valsscaled", "=", 
     RowBox[{"scaleFunc", "[", 
      RowBox[{"vals", ",", "scale", ",", "multby2"}], "]"}]}], 
    ";"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891435144413906*^9, 3.891435144744421*^9}, {
   3.89143740739882*^9, 3.891437410021852*^9}, {3.891437516926209*^9, 
   3.891437527827605*^9}, {3.891437579843827*^9, 3.8914375873652425`*^9}, {
   3.891437858649251*^9, 3.8914378608338194`*^9}, {3.891437978272311*^9, 
   3.891437984889294*^9}, {3.891438017045588*^9, 3.891438023427288*^9}, {
   3.891508119472985*^9, 3.891508127856281*^9}, {3.891508173904605*^9, 
   3.891508179492329*^9}, 3.89151236471186*^9, {3.891700040397269*^9, 
   3.89170005380425*^9}, {3.892900029608083*^9, 3.892900030510316*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"a4c968f3-ea03-438e-a04b-4cf567fa8af7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualizations 1", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189651589589*^9, 3.863189659437517*^9}, {
  3.864382685824139*^9, 3.864382691472054*^9}, {3.892645569438044*^9, 
  3.89264556957448*^9}},ExpressionUUID->"ce1f6c96-680e-433b-8ef7-\
880ee1c3d06e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Overlaying", " ", "the", " ", "resulting", " ", "skeleton", " ", "on", 
    " ", "top", " ", "of", " ", "the", " ", "active", " ", 
    RowBox[{"image", ".", " ", "Use"}], " ", "the", " ", "tools", " ", "in", 
    " ", "the", " ", "bottom", " ", "right", " ", "of", " ", "the", " ", 
    "image", " ", "to", " ", "zoom", " ", 
    RowBox[{"in", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"overlay1", "=", 
     RowBox[{"HighlightImage", "[", 
      RowBox[{"activeimg", ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"PointSize", "[", "0.001", "]"}], ",", 
         RowBox[{"Point", "[", "pixpos1", "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", 
        RowBox[{"First", "[", 
         RowBox[{"ImageDimensions", "[", "activeimg", "]"}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"DynamicImage", "[", 
    RowBox[{"overlay1", ",", 
     RowBox[{"ImageSize", "\[Rule]", "imgsize1"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.864921689913709*^9, 3.864921716023503*^9}, {
   3.865004411679334*^9, 3.865004429640044*^9}, {3.865004468867059*^9, 
   3.865004499441896*^9}, 3.865433320005748*^9, 3.8654334301861134`*^9, 
   3.865433953677338*^9, {3.870261891268679*^9, 3.870261910987794*^9}, {
   3.870529454218964*^9, 3.8705294544144735`*^9}, {3.8709698126366396`*^9, 
   3.8709698360718737`*^9}, {3.871123166271216*^9, 3.871123166997876*^9}, {
   3.871485286659229*^9, 3.871485286747024*^9}, {3.8715763765340824`*^9, 
   3.871576378926646*^9}, {3.871576475771633*^9, 3.871576479260301*^9}, {
   3.872154332318918*^9, 3.8721543323967867`*^9}, {3.8721647495080404`*^9, 
   3.872164749741063*^9}, {3.872264654710404*^9, 3.872264674882889*^9}, {
   3.872341212896478*^9, 3.8723412200593705`*^9}, {3.874069654740511*^9, 
   3.874069720476041*^9}, {3.877103255788118*^9, 3.877103258771799*^9}, {
   3.877447711584092*^9, 3.877447741203388*^9}, {3.87744793178089*^9, 
   3.8774479519168134`*^9}, {3.877448129913707*^9, 3.877448134611123*^9}, {
   3.8775142044402895`*^9, 3.8775142052706146`*^9}, {3.877524901179072*^9, 
   3.87752490596129*^9}, {3.883498831459161*^9, 3.883498832819072*^9}, {
   3.885637649517432*^9, 3.885637655472021*^9}, {3.886260894812394*^9, 
   3.886260897983521*^9}, 3.886598460813547*^9, {3.889794588414481*^9, 
   3.889794591841167*^9}, {3.889794702995486*^9, 3.889794712316751*^9}, {
   3.8897951938501377`*^9, 3.889795197363541*^9}, {3.8897953097473855`*^9, 
   3.889795349322193*^9}, {3.889795622571545*^9, 3.889795626027349*^9}, {
   3.889796225482793*^9, 3.889796247173726*^9}, {3.889796885295561*^9, 
   3.889796890763023*^9}, {3.889797523260481*^9, 3.889797641510889*^9}, {
   3.889797792071435*^9, 3.8897978134490595`*^9}, {3.8897989779287763`*^9, 
   3.88979898124053*^9}, {3.889800297032299*^9, 3.889800340402487*^9}, {
   3.8898004016436524`*^9, 3.889800429092003*^9}, {3.889800476780915*^9, 
   3.889800480243719*^9}, {3.889800590211468*^9, 3.8898005907819824`*^9}, {
   3.8898023682459726`*^9, 3.889802549620389*^9}, {3.8898029705233107`*^9, 
   3.8898030002779474`*^9}, {3.8898040356560783`*^9, 3.889804064238185*^9}, {
   3.889804106071164*^9, 3.889804129849054*^9}, {3.889804242074968*^9, 
   3.88980442149163*^9}, {3.889804451985213*^9, 3.8898045151296177`*^9}, {
   3.889804591168761*^9, 3.889804616442631*^9}, {3.889804741598781*^9, 
   3.889804785155908*^9}, {3.8898048500998373`*^9, 3.889804872623368*^9}, {
   3.8898049307419043`*^9, 3.889804960695367*^9}, {3.889805032946951*^9, 
   3.889805035507511*^9}, {3.889805104973168*^9, 3.889805108211799*^9}, {
   3.889806018630282*^9, 3.8898060214365444`*^9}, {3.8898060589311447`*^9, 
   3.8898061070628157`*^9}, {3.889806164239794*^9, 3.889806167464475*^9}, {
   3.889806265501841*^9, 3.889806342062522*^9}, {3.889868540849649*^9, 
   3.8898685442156777`*^9}, {3.889868617219542*^9, 3.8898686627915077`*^9}, {
   3.8898687957506137`*^9, 3.8898688535226526`*^9}, {3.889868916628753*^9, 
   3.8898689267504*^9}, {3.889869073830451*^9, 3.889869074144597*^9}, {
   3.8898698664505033`*^9, 3.8898698669145007`*^9}, {3.889876482616769*^9, 
   3.889876490951745*^9}, 3.8903851401403284`*^9, {3.891439985112154*^9, 
   3.891439996263238*^9}, {3.891440039581444*^9, 3.891440039881772*^9}, {
   3.891440784964587*^9, 3.8914408085125675`*^9}, {3.8914408615570135`*^9, 
   3.891440897733907*^9}, {3.9428376947853985`*^9, 3.942837713248884*^9}, {
   3.942838673686565*^9, 3.9428387281952114`*^9}, 3.947945726976578*^9},
 CellLabel->
  "In[333]:=",ExpressionUUID->"26ad9a66-e328-4a44-8136-526e8b9d6c86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Overlaying", " ", "both", " ", "the", " ", "resulting", " ", "skeleton", 
    " ", "points", " ", "and", " ", "the", " ", "segmentation", " ", "on", 
    " ", "top", " ", "of", " ", "the", " ", "active", " ", 
    RowBox[{"image", ".", " ", "Drag"}], " ", "the", " ", "mouse", " ", 
    "across", " ", "regions", " ", "of", " ", "interest", " ", "to", " ", 
    "zoom", " ", 
    RowBox[{"in", ".", " ", "Double"}], " ", "click", " ", "to", " ", 
    "return", " ", "to", " ", "original", " ", "plot", " ", 
    RowBox[{"range", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"dragZoomShow", "[", 
   RowBox[{
    RowBox[{"HighlightImage", "[", 
     RowBox[{"activeimg", ",", 
      RowBox[{"{", 
       RowBox[{"Green", ",", 
        RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
        RowBox[{"EdgeForm", "[", "]"}], ",", "modedbinary", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", "Red", ",", 
        RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
        RowBox[{"Point", "[", "pixpos1", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"ImageSize", "->", "imgsize1"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.890133866739435*^9, 3.890133902225854*^9}, {
   3.8904002046559677`*^9, 3.890400211657682*^9}, {3.891440049845948*^9, 
   3.891440058040725*^9}, {3.891440741901511*^9, 3.891440769173238*^9}, {
   3.8914408221399364`*^9, 3.891440854102412*^9}, 3.947945735701174*^9, {
   3.9479458311753445`*^9, 3.9479458512568436`*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"e005b87d-e5a4-4eef-adb9-a423a68d6afd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Hover", " ", "the", " ", "mouse", " ", "cursor", " ", "on", " ", "top", 
    " ", "of", " ", "a", " ", "skeleton", " ", "point", " ", "to", " ", 
    "show", " ", "the", " ", "width", " ", 
    RowBox[{"values", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"HighlightImage", "[", 
   RowBox[{"activeimg", ",", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"PointSize", "[", "0.001", "]"}], ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Tooltip", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Point", "/@", "pixpos1"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "&"}], ",", 
            "valsscaled"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ImageSize", "->", "imgsize1"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.863523165421307*^9, 3.863523256498958*^9}, {
   3.863523308163068*^9, 3.863523329329524*^9}, {3.863523536207735*^9, 
   3.863523550272539*^9}, {3.8635321980581326`*^9, 3.863532201818178*^9}, {
   3.863886952791596*^9, 3.863886971109845*^9}, {3.864135692468137*^9, 
   3.864135695982942*^9}, {3.8642285110916505`*^9, 3.8642285161700945`*^9}, 
   3.864380849686868*^9, {3.864380901481247*^9, 3.864380906728305*^9}, {
   3.864921773015136*^9, 3.864921791010479*^9}, 3.865433338310727*^9, 
   3.865433433513676*^9, 3.865433965064561*^9, {3.8708713649399185`*^9, 
   3.870871368501579*^9}, {3.889802608159625*^9, 3.889802646293162*^9}, {
   3.889869318272741*^9, 3.88986931926852*^9}, {3.8914400709916725`*^9, 
   3.891440083865904*^9}, {3.891440271518706*^9, 3.891440293608976*^9}, {
   3.891440927948502*^9, 3.891440977783132*^9}, 3.947945739579401*^9},
 CellLabel->
  "In[522]:=",ExpressionUUID->"80294806-d443-47d6-8e89-649902ca67a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Overlay", " ", "of", " ", "a", " ", "color", " ", "map", " ", "to", " ", 
    "represent", " ", "width", " ", 
    RowBox[{"values", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"colormapskl", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"range", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], "@@", 
          RowBox[{"MinMax", "[", "valsscaled", "]"}]}]}], ",", 
        RowBox[{"colscheme", "=", "\"\<Rainbow\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Legended", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HighlightImage", "[", 
         RowBox[{"activeimg", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorData", "[", 
                  RowBox[{"{", 
                   RowBox[{"colscheme", ",", "range"}], "}"}], "]"}], "/@", 
                 "valsscaled"}], ",", 
                RowBox[{"Point", "/@", "pixpos1"}]}], "}"}]}], "]"}]}], "}"}],
           ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"First", "[", 
            RowBox[{"ImageDimensions", "[", "activeimg", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BarLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"colscheme", ",", "range"}], "}"}], ",", 
          RowBox[{"LegendLabel", "\[Rule]", 
           RowBox[{
           "\"\<Width(\>\"", "<>", "scalebarunit", "<>", "\"\<)\>\""}]}], ",", 
          RowBox[{"LegendMarkerSize", "->", 
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"ImageDimensions", "[", "activeimg", "]"}], "]"}], "/", 
            "1.5"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"White", ",", 
             RowBox[{"FontSize", "\[Rule]", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"First", "[", 
                 RowBox[{"ImageDimensions", "[", "activeimg", "]"}], "]"}], 
                "/", "50"}], "]"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8644721070604515`*^9, 3.864472166177317*^9}, {
   3.864472230576812*^9, 3.864472286570963*^9}, {3.8644724137479553`*^9, 
   3.864472430229173*^9}, {3.864472493622863*^9, 3.8644725978809795`*^9}, {
   3.864472883334479*^9, 3.8644728967011337`*^9}, {3.864472954929948*^9, 
   3.86447296379018*^9}, {3.864473055307512*^9, 3.864473099538805*^9}, {
   3.8644732004850254`*^9, 3.8644732170377154`*^9}, {3.864473318805588*^9, 
   3.864473384647108*^9}, {3.864480615974665*^9, 3.864480749270249*^9}, {
   3.86448180040912*^9, 3.864481803021022*^9}, {3.864482728310509*^9, 
   3.864482737759948*^9}, 3.86492032448053*^9, {3.8649203632357*^9, 
   3.864920364017943*^9}, {3.864920494652325*^9, 3.8649205025332603`*^9}, {
   3.865004845124525*^9, 3.8650048551492834`*^9}, 3.8650048892747326`*^9, {
   3.865004923860015*^9, 3.865004926890993*^9}, 3.86500495968029*^9, {
   3.86500508432093*^9, 3.8650050989390507`*^9}, {3.8650077603836145`*^9, 
   3.865007767627382*^9}, {3.865008029321353*^9, 3.865008037282141*^9}, {
   3.865008859609524*^9, 3.865008870367968*^9}, 3.865008990341366*^9, {
   3.865009132014759*^9, 3.865009132992666*^9}, {3.8650094604739103`*^9, 
   3.8650094902049537`*^9}, {3.865009534928153*^9, 3.865009544492873*^9}, {
   3.865009808301919*^9, 3.865009834133415*^9}, {3.865010160060606*^9, 
   3.8650101835943565`*^9}, {3.865430931512309*^9, 3.865430946848825*^9}, 
   3.865433975824787*^9, {3.8699137695992117`*^9, 3.869913780927817*^9}, {
   3.889803373798139*^9, 3.889803410998295*^9}, {3.8898035795243435`*^9, 
   3.889803603864184*^9}, {3.8898037339278107`*^9, 3.889803741445932*^9}, 
   3.889803809759313*^9, 3.8898694592156763`*^9, {3.889869496218427*^9, 
   3.889869498370098*^9}, {3.889869694033837*^9, 3.889869695355363*^9}, {
   3.889869802647463*^9, 3.88986980274475*^9}, {3.889870800425789*^9, 
   3.889870800876184*^9}, {3.889871166924841*^9, 3.889871167023494*^9}, {
   3.889882843110092*^9, 3.889882843189775*^9}, {3.890383561409381*^9, 
   3.89038357245664*^9}, {3.890384230480592*^9, 3.890384247824778*^9}, {
   3.890384397000027*^9, 3.8903845053700895`*^9}, {3.890384565498575*^9, 
   3.890384565848835*^9}, {3.890384646046247*^9, 3.8903846461341496`*^9}, {
   3.890384694661668*^9, 3.890384730296142*^9}, {3.890399943220147*^9, 
   3.8903999433806725`*^9}, {3.8904002383238*^9, 3.890400238458532*^9}, {
   3.890400977899947*^9, 3.890400997532708*^9}, {3.890401041711395*^9, 
   3.890401047897302*^9}, {3.890401131785776*^9, 3.8904011657901983`*^9}, {
   3.890401219383628*^9, 3.890401281979971*^9}, {3.890401479701792*^9, 
   3.8904014798400507`*^9}, {3.890401559036057*^9, 3.890401564862098*^9}, {
   3.891441732732791*^9, 3.891441781875124*^9}, {3.891442255149227*^9, 
   3.891442277546896*^9}, {3.925902981418565*^9, 3.925903008981609*^9}, {
   3.925903962807312*^9, 3.9259039894644184`*^9}, {3.9259041602861443`*^9, 
   3.9259041618507986`*^9}, {3.925905559001136*^9, 3.9259055699298167`*^9}, 
   3.947947754583788*^9, {3.947948105209739*^9, 3.947948111258177*^9}, {
   3.947948155180509*^9, 3.9479481618401203`*^9}, 3.947948206285418*^9, {
   3.948368912778618*^9, 3.948368949284193*^9}, 3.952514668478058*^9, {
   3.9525147154849834`*^9, 3.952514716367108*^9}, {3.952514748223254*^9, 
   3.952514748679043*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"c6002521-9c09-4ecc-b151-25eabb3fa472"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Outputs", " ", "a", " ", "raster", " ", "version", " ", "of", " ", "the", 
    " ", "previous", " ", "color", " ", "scheme", " ", 
    RowBox[{"overlay", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"colmapraster", "=", 
     RowBox[{"ImagePad", "[", 
      RowBox[{
       RowBox[{"Rasterize", "[", 
        RowBox[{"colormapskl", ",", 
         RowBox[{"RasterSize", "\[Rule]", "1000"}], ",", 
         RowBox[{"Background", "\[Rule]", "Black"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"colmapraster", ",", 
     RowBox[{"ImageSize", "->", "imgsize1"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{
  3.865008138440116*^9, 3.865009035374301*^9, 3.865010186632166*^9, 
   3.865430901918212*^9, {3.8898710417933016`*^9, 3.889871042645283*^9}, 
   3.889882839871682*^9, {3.890141843092624*^9, 3.890141843696378*^9}, {
   3.890141971031627*^9, 3.890141984922789*^9}, {3.890145281988598*^9, 
   3.890145283934026*^9}, 3.8903836052693043`*^9, {3.89038407842832*^9, 
   3.89038408075082*^9}, {3.890384182211479*^9, 3.8903841856502514`*^9}, {
   3.890400268537345*^9, 3.89040028006885*^9}, {3.890401438588471*^9, 
   3.890401460934436*^9}, {3.8925634629118924`*^9, 3.892563498219554*^9}, {
   3.895827868338065*^9, 3.895827881286515*^9}, 3.947945749378111*^9, 
   3.947946220353073*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"9c998887-2c9e-4ad6-a9b9-e0376a5b3994"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Shows", " ", "the", " ", "effect", " ", "of", " ", "successive", " ", 
    "iterations", " ", "of", " ", "the", " ", "thinning", " ", "operator", 
    " ", "on", " ", "the", " ", "distance", " ", "transform", " ", "image", 
    " ", "and", " ", "resulting", " ", "width", " ", 
    RowBox[{"histogram", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"thinTdtV1", "[", 
   RowBox[{"activebinary", ",", 
    RowBox[{"(*", "modedbinary", "*)"}], "activebinary", ",", "binsize", ",", 
    "scale", ",", "maxiter", ",", "stepiter", ",", "imgsize1"}], 
   "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.861891858309567*^9, 3.861891865033393*^9}, {
   3.8618919977719755`*^9, 3.861892003159733*^9}, {3.861892250388708*^9, 
   3.8618922525724406`*^9}, {3.861893120775237*^9, 3.861893122969564*^9}, {
   3.86197054971519*^9, 3.861970552492944*^9}, {3.8619706730356975`*^9, 
   3.861970673830569*^9}, {3.8619708115030036`*^9, 3.861970828875159*^9}, {
   3.861971886100985*^9, 3.861971948502856*^9}, {3.861972044306697*^9, 
   3.8619720914391637`*^9}, {3.8619721430819964`*^9, 3.861972143131504*^9}, {
   3.861972318723064*^9, 3.8619723188244944`*^9}, 3.8619724511649995`*^9, {
   3.861972487824913*^9, 3.861972531628857*^9}, {3.8619726378113003`*^9, 
   3.861972697900739*^9}, {3.861977967555383*^9, 3.861977967664728*^9}, {
   3.862051353558344*^9, 3.862051353613198*^9}, {3.862051433803088*^9, 
   3.862051454989139*^9}, {3.862051759602018*^9, 3.862051775396159*^9}, {
   3.862051809648294*^9, 3.862051830578316*^9}, {3.862051869352619*^9, 
   3.862051869459446*^9}, {3.8620519119222918`*^9, 3.862051957705518*^9}, 
   3.862308614330682*^9, {3.862308760470726*^9, 3.8623087754513235`*^9}, {
   3.86230882321259*^9, 3.862308824899843*^9}, {3.862309696378178*^9, 
   3.8623096969717665`*^9}, {3.862309897563786*^9, 3.8623098976416717`*^9}, {
   3.8625800352430973`*^9, 3.8625800380842443`*^9}, {3.8625802030657883`*^9, 
   3.86258021496632*^9}, {3.862582168978338*^9, 3.86258217294302*^9}, {
   3.862584787967256*^9, 3.862584859906493*^9}, {3.862584898928919*^9, 
   3.862584920499803*^9}, {3.862660386827869*^9, 3.862660386957662*^9}, {
   3.862660926349359*^9, 3.862660938825109*^9}, {3.8626610577886753`*^9, 
   3.8626610649566965`*^9}, {3.862664151417509*^9, 3.8626641896713667`*^9}, {
   3.862664302084384*^9, 3.862664310913027*^9}, {3.862668874204275*^9, 
   3.862668883073987*^9}, {3.863020061262864*^9, 3.863020086430207*^9}, {
   3.8630206640122766`*^9, 3.8630206664968653`*^9}, {3.863081955719954*^9, 
   3.863081997952241*^9}, {3.863086554898122*^9, 3.8630865702977095`*^9}, {
   3.8630872833918676`*^9, 3.8630872845890293`*^9}, {3.863087393680876*^9, 
   3.863087395295387*^9}, {3.863089494003716*^9, 3.863089494142146*^9}, {
   3.863093725595837*^9, 3.863093756251861*^9}, {3.86309379058644*^9, 
   3.8630938353509884`*^9}, {3.863093946747376*^9, 3.863093947291741*^9}, {
   3.863100214811622*^9, 3.863100219694251*^9}, {3.863100254313293*^9, 
   3.86310033157706*^9}, {3.8631004242068925`*^9, 3.863100428911535*^9}, {
   3.8631004906500545`*^9, 3.863100490771718*^9}, {3.863102386056794*^9, 
   3.863102387056332*^9}, {3.863102558692984*^9, 3.8631025634731083`*^9}, {
   3.863102854676356*^9, 3.86310285533246*^9}, {3.863102898141727*^9, 
   3.863102906281441*^9}, {3.863103129295626*^9, 3.863103136934696*^9}, {
   3.863103190622359*^9, 3.863103191559614*^9}, {3.863164469680938*^9, 
   3.863164469790035*^9}, {3.86316463751771*^9, 3.863164637626877*^9}, {
   3.863190180525811*^9, 3.863190180642962*^9}, {3.8636255855385838`*^9, 
   3.863625586713832*^9}, {3.863887212692873*^9, 3.863887237843077*^9}, {
   3.8638873686148176`*^9, 3.863887368786654*^9}, {3.864381575222559*^9, 
   3.864381576503003*^9}, {3.86438163597745*^9, 3.864381640003908*^9}, {
   3.864381682317261*^9, 3.8643816997537003`*^9}, {3.8643845492342296`*^9, 
   3.864384554017148*^9}, {3.864384618272834*^9, 3.864384622502561*^9}, 
   3.864384657287061*^9, 3.864466719312499*^9, 3.8644672031539106`*^9, 
   3.8644673200978003`*^9, 3.864481820523889*^9, {3.8644829082586565`*^9, 
   3.864482910699815*^9}, 3.8654309971269035`*^9, {3.865431702652643*^9, 
   3.865431702973617*^9}, 3.870528768165106*^9, {3.870531323382913*^9, 
   3.870531324504913*^9}, {3.870969768322719*^9, 3.870969769108288*^9}, 
   3.8709704870085373`*^9, {3.8734715937595873`*^9, 3.8734715945305576`*^9}, {
   3.877514558145526*^9, 3.877514577551298*^9}, 3.877515601730138*^9, {
   3.877525119545586*^9, 3.87752512410802*^9}, {3.879604285686414*^9, 
   3.879604314323445*^9}, 3.886261026715688*^9, {3.886261449656224*^9, 
   3.886261451015274*^9}, {3.8897966243268385`*^9, 3.8897966250769196`*^9}, {
   3.891442847852703*^9, 3.891442848284647*^9}, {3.891443023008599*^9, 
   3.891443023690017*^9}, {3.892562852467177*^9, 3.892562854414309*^9}, {
   3.89256289901985*^9, 3.892562964508076*^9}, {3.8925630524222283`*^9, 
   3.8925630578605623`*^9}, {3.958822430504907*^9, 3.95882243215451*^9}, {
   3.958826427559042*^9, 3.9588264335343323`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"b8cae8ed-6a49-4387-964b-dcb1e43dc0a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Shows", " ", "an", " ", "overlay", " ", "of", " ", "the", " ", "effect", 
    " ", "of", " ", "successive", " ", "iterations", " ", "of", " ", "the", 
    " ", "thinning", " ", "operator", " ", "on", " ", "top", " ", "of", " ", 
    "the", " ", "original", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"thinTdtV2", "[", 
   RowBox[{
   "activeimg", ",", "activebinary", ",", "modedbinary", ",", "maxiter", ",", 
    "stepiter"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8625791123009853`*^9, 3.862579152480032*^9}, {
   3.86258495255592*^9, 3.862584955532004*^9}, {3.8625888542625003`*^9, 
   3.862588870302074*^9}, {3.862660790407736*^9, 3.862660792387769*^9}, {
   3.862668907004624*^9, 3.862668947915218*^9}, 3.862668986060943*^9, {
   3.8626690552060633`*^9, 3.862669065398824*^9}, {3.863020171122783*^9, 
   3.863020205958959*^9}, {3.863020326496692*^9, 3.863020329419276*^9}, {
   3.8630203993184633`*^9, 3.863020402568527*^9}, {3.86302223973234*^9, 
   3.863022244757928*^9}, {3.863082958182462*^9, 3.863082994954327*^9}, {
   3.863086227365054*^9, 3.863086272165866*^9}, 3.863086382743685*^9, {
   3.8631027026481476`*^9, 3.86310271580744*^9}, 3.863103260558916*^9, {
   3.863103311078888*^9, 3.863103311188238*^9}, {3.863262213452814*^9, 
   3.863262231851863*^9}, {3.863264757102721*^9, 3.863264757920399*^9}, {
   3.863625653109894*^9, 3.8636257007282186`*^9}, {3.863887253927108*^9, 
   3.863887274876252*^9}, {3.863887342901615*^9, 3.863887344198157*^9}, {
   3.8643822493315916`*^9, 3.864382265251721*^9}, {3.864384735680723*^9, 
   3.864384739183846*^9}, 3.86446720823102*^9, 3.870529387402594*^9, {
   3.877515327694084*^9, 3.877515328467494*^9}, {3.8775252388988*^9, 
   3.877525239524743*^9}, {3.891442536982215*^9, 3.891442537247778*^9}, 
   3.891442614470359*^9, {3.892562983419678*^9, 3.892563041914681*^9}, {
   3.958826726794769*^9, 3.958826737786663*^9}, {3.9588268689341145`*^9, 
   3.958826869389581*^9}, 3.95882710238612*^9},
 CellLabel->
  "In[244]:=",ExpressionUUID->"418642e8-5f91-42aa-aa42-094d69a5981f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Use", " ", "this", " ", "to", " ", "view", " ", "the", " ", "effect", " ",
     "of", " ", "the", " ", "thinning", " ", "operator", " ", "and", " ", 
    "pruning", " ", "on", " ", "the", " ", "partition", " ", 
    RowBox[{"images", ".", " ", "This"}], " ", "will", " ", "result", " ", 
    "in", " ", "a", " ", "different", " ", "outcome", " ", "compared", " ", 
    "to", " ", "the", " ", "original", " ", "image", " ", "because", " ", 
    "of", " ", "edge", " ", 
    RowBox[{"effects", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"thinTdtV3", "[", 
   RowBox[{
   "activeimg", ",", "activebinary", ",", "modedbinary", ",", "maxiter", ",", 
    "stepiter", ",", "partnum"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8632633254998627`*^9, 3.863263357800717*^9}, {
   3.863263424197651*^9, 3.863263426228653*^9}, {3.8632635922207546`*^9, 
   3.8632635972811894`*^9}, {3.8632646592816625`*^9, 3.863264690021511*^9}, {
   3.863264791013597*^9, 3.863264791770635*^9}, {3.863887441031035*^9, 
   3.8638874536885233`*^9}, {3.864230797432229*^9, 3.864230801288437*^9}, {
   3.8643823274582567`*^9, 3.864382338065045*^9}, {3.864384843056214*^9, 
   3.864384844768138*^9}, 3.864467213202804*^9, {3.864468900083411*^9, 
   3.864468977082438*^9}, {3.8644823679452047`*^9, 3.864482369759069*^9}, {
   3.8654312500331306`*^9, 3.86543125021436*^9}, {3.8700129454226017`*^9, 
   3.870012945531952*^9}, {3.870015671202183*^9, 3.870015671311521*^9}, 
   3.8705296111205025`*^9, {3.8705319421387215`*^9, 3.870531942259399*^9}, {
   3.877515331148043*^9, 3.877515331425836*^9}, 3.8775280508133802`*^9, {
   3.879603144981234*^9, 3.879603148367503*^9}, 3.891442612025617*^9, {
   3.891447243281161*^9, 3.8914472445456734`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"9aba0a13-ae74-418e-8d53-d569a6236937"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Uses", " ", "tooltips", " ", "to", " ", "show", " ", "width", " ", 
    "information", " ", "in", " ", "partition", " ", 
    RowBox[{"images", ".", " ", "The"}], " ", "overlay", " ", "skeleton", " ",
     "is", " ", "based", " ", "on", " ", "the", " ", "original", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"thinTdtV4", "[", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{"activeimg", ",", "imgadj"}], "]"}], ",", "activebinary", ",", 
    "modedbinary", ",", "maxiter", ",", "partnum", ",", "scale"}], 
   "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8643859361762934`*^9, 3.864385936229758*^9}, {
   3.864386131468286*^9, 3.8643861316916876`*^9}, {3.864386401044602*^9, 
   3.8643864037550135`*^9}, {3.864387008475436*^9, 3.864387009012117*^9}, {
   3.86438737653419*^9, 3.864387377224563*^9}, 3.8644667278508224`*^9, {
   3.864467219498473*^9, 3.86446722068476*^9}, {3.864480949264097*^9, 
   3.864480975787845*^9}, 3.864481184578914*^9, 3.864482033213222*^9, {
   3.864922239759312*^9, 3.864922314771521*^9}, 3.864922357309682*^9, {
   3.865072128964205*^9, 3.865072137571519*^9}, {3.8650722238105326`*^9, 
   3.865072224263542*^9}, {3.8650729563912864`*^9, 3.8650729566568227`*^9}, {
   3.865080020842511*^9, 3.865080023701245*^9}, {3.865091402268905*^9, 
   3.865091402331034*^9}, {3.869914288124293*^9, 3.8699142882122016`*^9}, {
   3.869928866520894*^9, 3.869928876340432*^9}, {3.870012917651955*^9, 
   3.87001292744629*^9}, {3.870970897963191*^9, 3.870970898046509*^9}, {
   3.87104644335853*^9, 3.871046443692423*^9}, {3.871049678147361*^9, 
   3.87104967851917*^9}, {3.871049809700104*^9, 3.871049810041581*^9}, {
   3.87320558661543*^9, 3.873205587271304*^9}, {3.8741603726943803`*^9, 
   3.874160372752383*^9}, {3.877103458714465*^9, 3.877103459151865*^9}, {
   3.877103558813865*^9, 3.877103558907525*^9}, {3.877512962593416*^9, 
   3.8775129803228703`*^9}, {3.877513286939458*^9, 3.8775132870488396`*^9}, {
   3.877513427505782*^9, 3.877513431126746*^9}, {3.8775153345589*^9, 
   3.877515334809031*^9}, {3.8775279324043846`*^9, 3.877527932766974*^9}, 
   3.877534666195221*^9, {3.878225911294668*^9, 3.8782259113219457`*^9}, {
   3.878226024798806*^9, 3.878226025300579*^9}, 3.885642047456605*^9, 
   3.889794907594004*^9, 3.889870132745844*^9, 3.889872751029343*^9, {
   3.8903008203027678`*^9, 3.890300829846826*^9}, {3.890302876961918*^9, 
   3.890302929007682*^9}, {3.8914425588585863`*^9, 3.891442563014464*^9}, {
   3.8914426041496*^9, 3.891442605723777*^9}, {3.891447086617545*^9, 
   3.891447089632476*^9}, 3.895586299485617*^9, {3.89558635853212*^9, 
   3.895586359832458*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"75e7fbdf-ef73-4b73-864c-a6091a638ec8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Skeleton of all images", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
  3.891433251907959*^9}},ExpressionUUID->"55ea0c78-5dcb-4250-a2f2-\
2677b8a2de94"],

Cell[CellGroupData[{

Cell["Binary modification", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892033152133747*^9, 
  3.892033155912717*^9}, {3.940003541702501*^9, 
  3.94000354500749*^9}},ExpressionUUID->"9bc21eef-1481-c84b-9291-\
15a8247b8b94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Modifies", " ", "and", " ", "filters", " ", "the", " ", "binary", " ", 
    "components", " ", "based", " ", "on", " ", "size", " ", "and", " ", 
    RowBox[{"shape", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"modbin", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SelectComponents", "[", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"GaussianFilter", "[", 
           RowBox[{"#", ",", "kernsize1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#Count", ">=", "mincount1"}], "&&", 
            RowBox[{"#Elongation", ">=", "minelongation1"}]}], ")"}], "&"}]}],
         "]"}], "&"}], ",", "binimgs"}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.937649253048687*^9, 3.937649332120296*^9}, {
  3.937652115412214*^9, 3.9376521763070564`*^9}, {3.940425840871601*^9, 
  3.940425847495034*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"2322925a-862f-3749-a26e-a1f35a4c0bd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Display", " ", "of", " ", "imported", " ", "binary", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"modbin", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "modbin"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8637963995957313`*^9, 3.863796454936445*^9}, {
   3.8914309309503064`*^9, 3.891430938944249*^9}, {3.891431035330562*^9, 
   3.891431041501723*^9}, {3.892565752781418*^9, 3.892565764830796*^9}, {
   3.919249058411851*^9, 3.919249062301341*^9}, {3.920735531062919*^9, 
   3.920735532156415*^9}, {3.937656985780268*^9, 3.937656991268669*^9}, 
   3.940424520478105*^9, {3.941104759378364*^9, 3.941104764492621*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"fe029d51-e683-1e40-af27-961e355a68da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thinning operation", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892033152133747*^9, 
  3.892033155912717*^9}},ExpressionUUID->"1601adcf-6825-4289-b902-\
fdf7bd164aeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computes", " ", "the", " ", "morphological", " ", "skeleton", " ", "for", 
    " ", "all", " ", "imported", " ", 
    RowBox[{"images", ".", " ", "Evaluate"}], " ", "this", " ", "line", " ", 
    "only", " ", "if", " ", "you", " ", "are", " ", "not", " ", "planing", 
    " ", "to", " ", "import", " ", "previously", " ", "exported", " ", 
    "skeleton", " ", 
    RowBox[{"data", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"skeletonlist", "=", 
     RowBox[{"mapMonitorV1", "[", 
      RowBox[{"skeletonFuncV2", ",", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"binimgs", ",", "modbin"}], "}"}], "]"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891510564248298*^9, 3.8915106320725985`*^9}, {
   3.8925630697936373`*^9, 3.892563105855803*^9}, {3.896280326829851*^9, 
   3.896280361513183*^9}, 3.9158956868158927`*^9, 3.937649344250183*^9, 
   3.9424966285330353`*^9, 3.948369526651488*^9, {3.948370984138193*^9, 
   3.9483709890085125`*^9}, {3.9588285149789925`*^9, 3.958828525753218*^9}, {
   3.95882868383626*^9, 3.958828684354419*^9}, 3.958828756822499*^9, {
   3.9588288188077717`*^9, 3.958828885663614*^9}, 3.9588299681811314`*^9, 
   3.958842071147644*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"0b59c569-8bb9-4e4f-a95d-1afa308a81d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "of", " ", "the", " ", "resulting", " ", "skeleton", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"skeletonlist", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "size"}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "skeletonlist"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891511404278018*^9, 3.891511408539191*^9}, {
   3.892900259889412*^9, 3.8929002729712667`*^9}, {3.91924912979073*^9, 
   3.919249133680422*^9}, {3.93332317997278*^9, 3.9333231873261395`*^9}, {
   3.9374907270707417`*^9, 3.937490744257883*^9}, 3.940424588915024*^9, {
   3.948369578964908*^9, 3.9483695801686115`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"cd682787-b1cd-4f59-a46d-c1a172cb30de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Exporting", " ", "skeleton", " ", "result", " ", "images", " ", "as", " ",
     "raw", " ", "mx", " ", 
    RowBox[{"data", ".", " ", "Exporting"}], " ", "as", " ", "tiff", " ", 
    "changes", " ", "the", " ", "pixel", " ", 
    RowBox[{"values", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"exportFunc", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Skeleton results\>\"", ",", "datapath", ",", "2"}], 
      "]"}]}], ",", "\"\<skl.mx\>\"", ",", "skeletonlist"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891619138339893*^9, 3.891619144228653*^9}, 
   3.891619325133745*^9, {3.8916975351931767`*^9, 3.891697554498254*^9}, {
   3.891697849274344*^9, 3.891697867930872*^9}, {3.891698045779202*^9, 
   3.891698051311472*^9}, {3.892225369760112*^9, 3.892225400734967*^9}, {
   3.947867844384691*^9, 3.9478678716298447`*^9}, {3.947867918696114*^9, 
   3.947867944462065*^9}, {3.948201566175444*^9, 3.948201566483942*^9}, {
   3.948369603834116*^9, 3.948369627554268*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"8e4d4b53-5e9f-4f57-9a7d-ce1127bf11ab"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Skeleton segment refining", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.891358748791428*^9, 
  3.891358751790722*^9}, {3.8914331838075223`*^9, 3.891433186330666*^9}, {
  3.891512678971051*^9, 3.891512689881564*^9}, {3.94793144524699*^9, 
  3.947931446040522*^9}, {3.9479315491109405`*^9, 3.947931550751286*^9}, {
  3.947931631064991*^9, 3.94793163286324*^9}, {3.947945043770031*^9, 
  3.947945064873735*^9}},ExpressionUUID->"bbc88bf2-074c-428b-b140-\
427493c1b0e7"],

Cell[CellGroupData[{

Cell["Skeleton partitioning and measurements", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
  3.8914332273222404`*^9}, {3.891618615561842*^9, 3.891618618752888*^9}, {
  3.891618655464831*^9, 3.891618658776661*^9}, {3.891618854561648*^9, 
  3.891618858982194*^9}, {3.891699008942189*^9, 3.89169901501821*^9}, {
  3.94828995876784*^9, 
  3.948289980997257*^9}},ExpressionUUID->"380987d7-4d32-4412-8c76-\
314e5b4731ab"],

Cell[CellGroupData[{

Cell["Importing skeleton data", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.895657915564437*^9, 3.895657921079284*^9}, {3.948371566222456*^9, 
  3.948371571516548*^9}},ExpressionUUID->"c168dc35-4eae-4d54-9003-\
9429dcd6e640"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Imports", " ", "skeleton", " ", "data", " ", "saved", " ", "in", " ", 
    "the", " ", "Skeleton", " ", "results", " ", 
    RowBox[{"folder", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"skeletonfnsort", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"All", ",", 
       RowBox[{"First", "@", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<Skeleton results\>\"", ",", "datapath", ",", "2"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"skldata", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"First", "@", "skeletonfnsort"}], "]"}]}], ";"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8922096673627963`*^9, 3.892209680291034*^9}, {
   3.892209744134028*^9, 3.892209765133379*^9}, 3.89222219717215*^9, {
   3.8922232587855883`*^9, 3.892223261190403*^9}, {3.892223312588542*^9, 
   3.892223325666993*^9}, {3.892304654086162*^9, 3.892304656616976*^9}, {
   3.892563115078358*^9, 3.8925631170853825`*^9}, {3.892563154151272*^9, 
   3.892563185910202*^9}, {3.947868067536579*^9, 3.9478680692606983`*^9}, {
   3.947868211924017*^9, 3.947868233426748*^9}, {3.948201587910656*^9, 
   3.948201588613983*^9}, {3.948371238368807*^9, 3.94837123882622*^9}, {
   3.948371276042532*^9, 3.948371327712645*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"f9bf53a6-adb3-461f-9dfc-d3ddce267cdd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partitioning skeleton into segments", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.895657915564437*^9, 3.895657921079284*^9}, {3.895657991674228*^9, 
  3.895657996876133*^9}, {3.947868324332546*^9, 
  3.947868330582163*^9}},ExpressionUUID->"a07ff4c9-6918-4242-845a-\
773d4d195f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Searches", " ", "for", " ", "the", " ", "skeleton", " ", "junction", " ", 
    "points", " ", "of", " ", "the", " ", "skeleton", " ", 
    RowBox[{"images", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"junctptsimgs", ",", "endptsimg", ",", "numofjunctpts"}], "}"}],
      "=", 
     RowBox[{"sklBranchPts", "[", "skldata", "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8915946959709044`*^9, 3.891594758458761*^9}, {
   3.8915949779433556`*^9, 3.89159499058806*^9}, {3.891595141533723*^9, 
   3.89159514426188*^9}, {3.891596691903448*^9, 3.891596708839403*^9}, {
   3.8915968621166916`*^9, 3.8915968630656233`*^9}, 3.892209629247111*^9, {
   3.892563346817021*^9, 3.892563348838196*^9}, {3.89256337966109*^9, 
   3.892563396100717*^9}, {3.915895905373463*^9, 3.915895906158199*^9}, {
   3.952184331669462*^9, 3.952184360158867*^9}, {3.957876053759468*^9, 
   3.957876055709869*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"913bda63-b7f9-45e4-81c7-98fac0fa7748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Display", " ", "table", " ", "with", " ", "the", " ", "number", " ", "of",
     " ", "junction", " ", "points", " ", "for", " ", "each", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"jptabl", "=", 
   RowBox[{"tableDisplay3", "[", 
    RowBox[{"fnoriginal", ",", "numofjunctpts"}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8915981711315064`*^9, 3.891598189057506*^9}, {
   3.892563408783574*^9, 3.892563433285668*^9}, {3.915895889384261*^9, 
   3.915895890256155*^9}, {3.9400696165409336`*^9, 3.940069623219801*^9}, {
   3.9483715291041965`*^9, 3.948371536972988*^9}, 3.9521843745179596`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"a563eb09-2074-452b-afdd-7c4f0e4f03fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Check", " ", "if", " ", "changing", " ", "the", " ", "kernel", " ", "size",
    " ", "in", " ", "grayJunctPts", " ", "to", " ", "0", " ", "changes", " ", 
   "the", " ", 
   RowBox[{"result", ".", " ", "It"}], " ", "apears", " ", "that", " ", "the",
    " ", "junction", " ", "points", " ", "does", " ", "indeed", " ", "need", 
   " ", "to", " ", "be", " ", "dilated", " ", "to", " ", "guarante", " ", 
   "that", " ", "the", " ", "skeleton", " ", "segments", " ", "do", " ", 
   "not", " ", "touch", " ", "at", " ", "the", " ", 
   RowBox[{"corners", "."}]}], "*)"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.952185172085066*^9, 3.95218519252276*^9}, {
  3.952513263218008*^9, 3.952513312247658*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"f21d1510-a026-0f48-8c82-3d2b030043b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Extracts", " ", "the", " ", "corresponding", " ", "width", " ", "values", 
    " ", "at", " ", "the", " ", "junction", " ", 
    RowBox[{"points", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"grayjunctpts", "=", 
     RowBox[{"grayJunctPts", "[", 
      RowBox[{"skldata", ",", "junctptsimgs", ",", "1"}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{
  3.89159490790284*^9, {3.891594998658471*^9, 3.8915950212268147`*^9}, {
   3.891595051580329*^9, 3.891595058412984*^9}, {3.891595411946723*^9, 
   3.891595412563631*^9}, {3.891595914234829*^9, 3.891595925428367*^9}, 
   3.891596424090387*^9, {3.891598346582094*^9, 3.891598348322757*^9}, {
   3.892223397312713*^9, 3.8922233976665993`*^9}, {3.892223434361263*^9, 
   3.892223435597794*^9}, {3.892563438588983*^9, 3.892563440319717*^9}, {
   3.8925635181527557`*^9, 3.8925635450354376`*^9}, {3.8925635752754936`*^9, 
   3.892563630050168*^9}, {3.947933050158573*^9, 3.947933060421818*^9}, {
   3.952179305083421*^9, 3.952179307160036*^9}, {3.952184021640091*^9, 
   3.9521840287321796`*^9}, {3.952184156179144*^9, 3.952184161180453*^9}, {
   3.952184199282543*^9, 3.952184209611561*^9}, 3.952184384987715*^9, {
   3.952511857675495*^9, 3.952511859183187*^9}, {3.952512060319462*^9, 
   3.95251206567671*^9}, {3.952512897837829*^9, 3.952512903742796*^9}, {
   3.9525132114445667`*^9, 3.9525132144752827`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"ba8b33cd-c22a-4ae0-8804-466b341094d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Subtracts", " ", "the", " ", "junction", " ", "points", " ", "from", " ", 
    "the", " ", "skeleton", " ", "image", " ", "to", " ", "partition", " ", 
    "the", " ", "skeleton", " ", "into", " ", 
    RowBox[{"segments", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"separatebrnch", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageSubtract", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"skldata", ",", "grayjunctpts"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8915984581265993`*^9, 3.891598491486548*^9}, {
   3.892223458705099*^9, 3.892223459581523*^9}, {3.892563635658753*^9, 
   3.892563681769084*^9}, 3.937649422232429*^9, {3.94793307229146*^9, 
   3.947933103891012*^9}, {3.952184223802719*^9, 3.952184227073021*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"2c69bbff-106e-4f9a-8b5d-cf33898a6f7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Skeleton segment measurements", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.895657915564437*^9, 3.895657921079284*^9}, {3.895657991674228*^9, 
  3.895658065862191*^9}, {3.94793156403948*^9, 3.947931577353081*^9}, {
  3.948292559450428*^9, 3.948292561036663*^9}, {3.948298046883377*^9, 
  3.9482980475115232`*^9}},ExpressionUUID->"7eda79ae-b59d-5346-901d-\
a36559608c70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Skeleton", " ", "segment", " ", "index", " ", "number", " ", "and", " ", 
    "length"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"indxandlen", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Values", "@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Label\>\"", ",", "\"\<Count\>\""}], "}"}], ",", 
            RowBox[{"CornerNeighbors", "->", "True"}]}], "]"}]}], "&"}], ",", 
        "separatebrnch"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Index", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexlist", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ">=", "1"}], "&"}]}], "]"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], ",", "indxandlen"}],
       "]"}]}], ";"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.948292570712358*^9, 3.948292666722718*^9}, {
  3.948292946645569*^9, 3.9482929694677677`*^9}, {3.948298056573328*^9, 
  3.948298059101359*^9}, {3.948298105496151*^9, 3.948298140551432*^9}, {
  3.948298174586981*^9, 3.948298175985267*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"1d814d86-49ed-4548-a631-911b9cba141d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Lables", " ", "connected", " ", "components", " ", "with", " ", "unique", 
    " ", "index", " ", 
    RowBox[{"number", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sscomp", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MorphologicalComponents", "[", 
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "0.0001"}], "]"}], "]"}], "&"}], ",", 
       "separatebrnch"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.948292693259678*^9, 3.948292726744593*^9}, {
  3.948298180335655*^9, 3.948298203642065*^9}},
 CellLabel->
  "In[454]:=",ExpressionUUID->"8dd6a3f5-0184-5c49-8620-01c2bcc15216"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Finds", " ", "all", " ", "skeleton", " ", "segment", " ", 
    RowBox[{"coorinates", ".", " ", "Operates"}], " ", "on", " ", "data", " ",
     "as", " ", "an", " ", "array", " ", "then", " ", "converts", " ", "the", 
    " ", "resulting", " ", "index", " ", "coordinates", " ", "into", " ", 
    "image", " ", 
    RowBox[{"coordinates", ".", " ", "This"}], " ", "function", " ", "works", 
    " ", "faster", " ", "if", " ", "there", " ", "is", " ", "a", " ", "C", 
    " ", "compiler", " ", "installed", " ", "in", " ", "your", " ", 
    RowBox[{"machine", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sscoords", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#2", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"imgdims", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", "#1", "+", "1"}]}], "}"}],
            "&"}], ",", 
          RowBox[{"posCompile2D", "[", 
           RowBox[{
            RowBox[{"sscomp", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"indexlist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "-", "0.5"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sscomp", "]"}]}], "}"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.9482928070777874`*^9, 3.948292919485134*^9}, {
  3.9482982220481644`*^9, 3.9482982390517063`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"8eb6b5bc-8aaa-4242-a4b8-2195d4bf4707"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Obtaining", " ", "skeleton", " ", "segment", " ", "measurements", " ", 
    "and", " ", "formatting", " ", "the", " ", 
    RowBox[{"results", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sscompdata", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"brnchMeasureFunc", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"sscoords", ",", "indexlist"}], "}"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.948293032060272*^9, 3.948293121301752*^9}, {
  3.948298260587015*^9, 3.948298267687014*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"7d65dd1a-9453-d54a-8735-7afbe14d60fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Exporting", " ", "skeleton", " ", "segment", " ", "component", " ", 
    "measurements", " ", "as", " ", "an", " ", "mx", " ", 
    RowBox[{"file", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"exportFunc", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{
      "\"\<Skeleton segment components\>\"", ",", "datapath", ",", "2"}], 
      "]"}]}], ",", "\"\<ssc.mx\>\"", ",", "sscompdata"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891619138339893*^9, 3.891619144228653*^9}, 
   3.891619325133745*^9, {3.8916975351931767`*^9, 3.891697554498254*^9}, {
   3.891697849274344*^9, 3.891697867930872*^9}, {3.891698045779202*^9, 
   3.891698051311472*^9}, {3.8920395464539375`*^9, 3.892039549229201*^9}, {
   3.892039734547909*^9, 3.892039745580479*^9}, {3.892040102648226*^9, 
   3.892040152863647*^9}, {3.947868379408832*^9, 3.947868415092388*^9}, {
   3.947933018308855*^9, 3.947933019875504*^9}, {3.947933137212401*^9, 
   3.947933144749056*^9}, {3.948201607414736*^9, 3.948201607940489*^9}, 
   3.948293224980585*^9},
 CellLabel->
  "In[457]:=",ExpressionUUID->"398141b9-aec7-4247-80c6-66bcd6af0811"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Skeleton segment trimming and filtering", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
  3.8914332273222404`*^9}, {3.891618615561842*^9, 3.891618618752888*^9}, {
  3.891618655464831*^9, 3.891618688676756*^9}, {3.947931611936636*^9, 
  3.947931617311224*^9}},ExpressionUUID->"a2dd3c62-c5cc-42cc-a891-\
f04e783c80cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Importing", " ", "previously", " ", "saved", " ", "skeleton", " ", 
    "segment", " ", "components", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sscdata", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"First", "@", 
      RowBox[{"FileNames", "[", 
       RowBox[{"All", ",", 
        RowBox[{"First", "@", 
         RowBox[{"FileNames", "[", 
          RowBox[{
          "\"\<Skeleton segment components\>\"", ",", "datapath", ",", "2"}], 
          "]"}]}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947868570004637*^9, 3.9478686124550953`*^9}, {
  3.947876180404161*^9, 3.947876183721288*^9}, {3.947932945559408*^9, 
  3.94793296138164*^9}, {3.9479332300948358`*^9, 3.947933230643235*^9}, {
  3.948201613150202*^9, 3.948201614330164*^9}, {3.9483716916836376`*^9, 
  3.94837172453464*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"94ded1e6-93fb-6d46-9b54-fd18a349ffbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Extracts", " ", "the", " ", "distance", " ", "transform", " ", "values", 
    " ", "from", " ", "the", " ", "unfiltered", " ", "binary", " ", 
    RowBox[{"images", ".", " ", "Here"}], " ", "we", " ", "use", " ", "the", 
    " ", "skeleton", " ", "segment", " ", "coordinates", " ", "from", " ", 
    "the", " ", "filtered", " ", 
    RowBox[{"binary", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"skeletondata", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"imgDataV2", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"sscdata", ",", "binimgs"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.959422714995744*^9, 3.959422753754625*^9}, {
  3.95968157165098*^9, 3.959681636984121*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"b6d2c2f8-55de-3644-bd64-5eea6d3864dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Organizes", " ", "the", " ", "skeleton", " ", "segment", " ", "data", " ",
     "in", " ", "sequential", " ", "order", " ", "and", " ", "trims", " ", 
    "the", " ", "ends", " ", "of", " ", "the", " ", "segments", " ", "based", 
    " ", "on", " ", "the", " ", "drop", " ", "fraction", " ", 
    RowBox[{"parameter", ".", " ", "This"}], " ", "computation", " ", "can", 
    " ", "take", " ", "a", " ", "couple", " ", "of", " ", "minutes", " ", 
    "depending", " ", "on", " ", "the", " ", "total", " ", "number", " ", 
    "of", " ", "skeleton", " ", 
    RowBox[{"segments", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ssctrimmed", "=", 
     RowBox[{"mapMonitorV2", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mapModFunc", "[", 
         RowBox[{"#", ",", "dropfrac"}], "]"}], "&"}], ",", 
       RowBox[{"Map", "[", 
        RowBox[{"DistanceTransform", ",", "binimgs"}], "]"}], ",", "sscdata", 
       ",", "dropfrac"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891599501238033*^9, 3.8915995716052265`*^9}, {
   3.89159960454816*^9, 3.891599606721962*^9}, 3.891602685803642*^9, 
   3.892041021282149*^9, {3.892563899427629*^9, 3.892563902740923*^9}, {
   3.8925651074613733`*^9, 3.89256515978349*^9}, {3.947932978521336*^9, 
   3.947932988912672*^9}, 3.947933239104719*^9, {3.947950850858979*^9, 
   3.947950851251744*^9}, {3.947951690005575*^9, 3.947951693336294*^9}, {
   3.948371745757269*^9, 3.948371831204447*^9}, {3.958843280783205*^9, 
   3.958843303810554*^9}, {3.958843692931158*^9, 3.95884370054237*^9}, 
   3.959422953656265*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"88cebe56-8dae-419d-b4cb-969edc3fd2f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computes", " ", "the", " ", "best", " ", "fit", " ", "line", " ", "to", 
    " ", "the", " ", "distrance", " ", "transfrom", " ", "value", " ", "vs", 
    " ", "skeleton", " ", "segment", " ", "position", " ", "index", " ", 
    RowBox[{"data", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"linefits", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"lineFit2D", ",", "ssctrimmed", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.890841855655877*^9, 3.890841876184474*^9}, {
   3.891602812306604*^9, 3.891602830452756*^9}, {3.892042950169601*^9, 
   3.89204295138015*^9}, {3.892565178735882*^9, 3.892565202685235*^9}, {
   3.947933330247267*^9, 3.947933356856222*^9}, {3.9479490032303658`*^9, 
   3.947949004031629*^9}, 3.947950858979708*^9, 3.947951703341107*^9, {
   3.948201654031407*^9, 3.948201654607163*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"fd457f27-ec31-4a43-9792-be7e9ce76475"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "resulting", " ", "histogram", " ", "of", " ",
     "the", " ", "angle", " ", 
    RowBox[{"parameter", ".", " ", "This"}], " ", "angle", " ", "represents", 
    " ", "the", " ", "average", " ", "rate", " ", "of", " ", "change", " ", 
    "of", " ", "the", " ", "distrance", " ", "transform", " ", "values", " ", 
    "along", " ", "each", " ", "skeleton", " ", 
    RowBox[{"segment", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"histoDisplay", "[", 
     RowBox[{
      RowBox[{"linefits", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"fnoriginal", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "imgsize2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "linefits", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891614909399304*^9, 3.891614990619812*^9}, {
   3.89256521644072*^9, 3.8925652514113455`*^9}, {3.892565349493788*^9, 
   3.892565416967674*^9}, {3.89513507010976*^9, 3.895135073476423*^9}, {
   3.947933370315331*^9, 3.947933374217448*^9}, {3.948201662097616*^9, 
   3.948201665154814*^9}, 3.9482038250689507`*^9, {3.9525123567472878`*^9, 
   3.95251236117518*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"e78803fc-f5ce-4b75-9acd-240d8108c870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "best", " ", "fit", " ", "line", " ", "to", 
    " ", "the", " ", "branch", " ", "distance", " ", "transform", " ", 
    RowBox[{"data", ".", " ", "Data"}], " ", "shown", " ", "is", " ", 
    RowBox[{"standardized", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"branch", "<=", 
       RowBox[{"Length", "[", 
        RowBox[{"linefits", "[", 
         RowBox[{"[", "img", "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lineFitGraphic", "[", 
       RowBox[{
        RowBox[{"linefits", "[", 
         RowBox[{"[", 
          RowBox[{"img", ",", "branch"}], "]"}], "]"}], ",", "0.4", ",", 
        "imgsize2"}], "]"}], ",", "\"\<No data points\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"img", ",", "1", ",", 
      RowBox[{"Length", "[", "linefits", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"branch", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"linefits", "[", 
        RowBox[{"[", "img", "]"}], "]"}], "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947949555245734*^9, 3.947949563257492*^9}, {
   3.947949668200478*^9, 3.947949694840074*^9}, {3.9479500098485584`*^9, 
   3.947950012376402*^9}, 3.94795006263142*^9, {3.948201669462483*^9, 
   3.948201678422529*^9}, {3.9525123852226143`*^9, 3.952512390046337*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"1934b44c-954e-6d47-82e5-804a7f697b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Selects", " ", "the", " ", "skeleton", " ", "segments", " ", "that", " ", 
    "have", " ", "an", " ", "angle", " ", "larger", " ", "than", " ", "the", 
    " ", "one", " ", "input", " ", "in", " ", 
    RowBox[{"anglethreshold", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sstoremove1", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"linefits", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ">", "anglethreshold"}], "&"}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "linefits", "]"}]}], "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "4"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", "sstoremove1"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891616825574197*^9, 3.891616838802503*^9}, {
   3.891616957143787*^9, 3.891616971911726*^9}, 3.8916172076225586`*^9, {
   3.892565515142308*^9, 3.892565516861541*^9}, {3.892565791154812*^9, 
   3.892565825930456*^9}, {3.9479334897691116`*^9, 3.94793349150759*^9}, {
   3.947955243606119*^9, 3.947955245994068*^9}, {3.9482016827505436`*^9, 
   3.948201685627051*^9}, 3.948203876158417*^9, 3.949488876735796*^9, 
   3.949488916729544*^9, {3.94948919069903*^9, 3.949489200453066*^9}, 
   3.949495255448391*^9},
 CellLabel->
  "In[100]:=",ExpressionUUID->"59aff3e9-ff3d-4b6e-8e8d-90a04f9747ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Selects", " ", "the", " ", "skeleton", " ", "segments", " ", "that", " ", 
    "have", " ", "a", " ", "count", " ", "smaller", " ", "than", " ", 
    RowBox[{"ssmincount", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sstoremove2", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ssctrimmed", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", "ssmincount"}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "linefits", "]"}]}], "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "6"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", "sstoremove2"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.949489124193201*^9, 3.949489166112129*^9}, {
   3.949489239970081*^9, 3.949489257030928*^9}, {3.949489308421488*^9, 
   3.9494893107460594`*^9}, 3.9494895749781513`*^9, {3.949495029575735*^9, 
   3.949495030785393*^9}, 3.949495251094036*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"74c9906d-995a-5548-acd1-cc81a2cdc9e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Removes", " ", "the", " ", "skeleton", " ", "segments", " ", "from", " ", 
    "ssctrimmed", " ", "that", " ", "have", " ", "a", " ", "angle", " ", 
    "larger", " ", "and", " ", "a", " ", "skeleton", " ", "count", " ", 
    "smaller", " ", "than", " ", "the", " ", "user", " ", "selected", " ", 
    "thresholds", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"anglethreshold", " ", "and", " ", "ssmincount"}], ")"}], 
     "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sscfilt", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"ssctrimmed", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{
            RowBox[{"Union", "@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"sstoremove1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"sstoremove2", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "ssctrimmed", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", "sscfilt"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891617005522771*^9, 3.8916170472743406`*^9}, {
   3.8916170801774817`*^9, 3.8916171089924345`*^9}, {3.89256551993564*^9, 
   3.892565521978138*^9}, {3.892565833360947*^9, 3.8925658657306943`*^9}, 
   3.892633454819171*^9, {3.947933497140234*^9, 3.947933499329634*^9}, {
   3.947950881286248*^9, 3.947950899348295*^9}, {3.947951719787274*^9, 
   3.947951731539244*^9}, 3.9479517665091896`*^9, 3.947954977497092*^9, 
   3.94795525526244*^9, {3.949489397267905*^9, 3.949489420793693*^9}, {
   3.9494915230055943`*^9, 3.9494915756268272`*^9}, {3.949495162212561*^9, 
   3.949495213055517*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"46026dd1-8032-40f4-ac6d-4b64d3836220"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "orientcorr"}], "=", 
    RowBox[{
    "\"\<yes\>\"", " ", "this", " ", "function", " ", "returns", " ", "a", 
     " ", "resampled", " ", "version", " ", "of", " ", "the", " ", "skeleton",
      " ", "width", " ", "data", " ", "that", " ", "accounts", " ", "for", 
     " ", "the", " ", "skeleton", " ", "segment", " ", "spacial", " ", 
     "oreintation", " ", 
     RowBox[{"effect", ".", " ", "This"}], " ", "is", " ", "only", " ", 
     "applied", " ", "to", " ", "the", " ", "distance", " ", "transform", " ",
      "values", " ", 
     RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sscref", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"applyOrientCorr", "[", 
          RowBox[{"#", ",", "orientcorr"}], "]"}], "&"}], ",", "sscfilt"}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", "sscref"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947952159939277*^9, 3.947952160425907*^9}, {
  3.947952205995547*^9, 3.947952228847048*^9}, {3.947953154170475*^9, 
  3.9479532033185825`*^9}, {3.9479532340149384`*^9, 3.947953337874403*^9}, {
  3.9479536853792534`*^9, 3.947953721499466*^9}, {3.9494871106333065`*^9, 
  3.949487113354647*^9}, {3.949487250198433*^9, 3.949487277817768*^9}, {
  3.949488797418878*^9, 3.94948882087544*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"6ac8cd99-ff7b-4646-b509-72aebbdec136"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualizations 2", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189651589589*^9, 3.863189659437517*^9}, {
  3.864382685824139*^9, 3.864382691472054*^9}, {3.892645569438044*^9, 
  3.892645585282528*^9}},ExpressionUUID->"c820d95f-23d3-4783-b193-\
3f7109cd6c8c"],

Cell[CellGroupData[{

Cell["Filtered skeleton overlay", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.947931865258858*^9, 3.94793186803487*^9}, {3.947932026866705*^9, 
  3.947932029417475*^9}},ExpressionUUID->"98dc5a80-ca25-5249-9361-\
de0af84d70b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Creates", " ", "an", " ", "overlay", " ", "composed", " ", "of", " ", 
     "the", " ", "original", " ", "image"}], ",", " ", 
    RowBox[{"the", " ", "binary", " ", "image", " ", 
     RowBox[{"(", "red", ")"}]}], ",", " ", 
    RowBox[{"and", " ", "filtered", " ", "skeleton", " ", "result", " ", 
     RowBox[{"(", "green", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"filtbranchdispl", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageResize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HighlightImage", "[", 
          RowBox[{
           RowBox[{"imgtrimres", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"(*", "Red", "*)"}], 
            RowBox[{"White", 
             RowBox[{"(*", 
              RowBox[{"RGBColor", "[", 
               RowBox[{
                RowBox[{"75", "/", "255"}], ",", 
                RowBox[{"0", "/", "255"}], ",", 
                RowBox[{"146", "/", "255"}]}], "]"}], "*)"}], ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
             RowBox[{"EdgeForm", "[", "]"}], ",", 
             RowBox[{"modbin", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"(*", "Green", "*)"}], 
             RowBox[{"RGBColor", "[", 
              RowBox[{
               RowBox[{"26", "/", "255"}], ",", 
               RowBox[{"255", "/", "255"}], ",", 
               RowBox[{"26", "/", "255"}]}], "]"}], ",", 
             RowBox[{"PointSize", "[", "ptsize", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"sscfilt", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"ImageDimensions", "[", 
          RowBox[{"imgtrimres", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sscfilt", "]"}]}], "}"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891617911823991*^9, 3.891617954911978*^9}, {
   3.8916179914679766`*^9, 3.891618013829612*^9}, 3.892041095309657*^9, {
   3.89220166001977*^9, 3.8922016699035177`*^9}, {3.8925655247523775`*^9, 
   3.892565526531034*^9}, {3.892565930002659*^9, 3.8925659647810364`*^9}, {
   3.892645827967377*^9, 3.892645829537868*^9}, {3.917543405636835*^9, 
   3.917543435185259*^9}, 3.933164222171213*^9, 3.937651225119726*^9, {
   3.940003416296825*^9, 3.94000341754138*^9}, 3.940526242474806*^9, {
   3.941019973559679*^9, 3.94101998240472*^9}, 3.941130606276711*^9, {
   3.941130680976105*^9, 3.9411307177263*^9}, {3.941130758583967*^9, 
   3.941130813771096*^9}, {3.941131539552824*^9, 3.94113156080195*^9}, {
   3.942165660933092*^9, 3.942165664178966*^9}, 3.9428388897276707`*^9, 
   3.943024483074356*^9, 3.943026754951576*^9, {3.943027302096646*^9, 
   3.943027302988914*^9}, 3.9473443665648556`*^9, {3.947931389145399*^9, 
   3.947931397102812*^9}, {3.947955009479244*^9, 3.9479550145690517`*^9}, {
   3.9482982955346947`*^9, 3.948298296448906*^9}, {3.948299320464735*^9, 
   3.9482993213444233`*^9}, {3.95252410574197*^9, 3.9525241327720356`*^9}, {
   3.952524254822758*^9, 3.952524312133243*^9}, {3.9525244210287533`*^9, 
   3.952524423149837*^9}, {3.952524545954954*^9, 3.95252455159313*^9}, {
   3.9525246537253075`*^9, 3.952524657291073*^9}, {3.958222840876751*^9, 
   3.9582228431490707`*^9}, 3.959424422664469*^9, {3.95976862128577*^9, 
   3.959768634673465*^9}, {3.9597687218325157`*^9, 3.95976872985646*^9}, {
   3.95976915999592*^9, 3.959769160167568*^9}, {3.959769217130895*^9, 
   3.95976921725585*^9}, {3.959783975078562*^9, 3.9597839839720135`*^9}, 
   3.9597894754825497`*^9, 3.959789895393722*^9, {3.959851768031113*^9, 
   3.959851781477465*^9}, {3.959944383674734*^9, 3.9599443907275257`*^9}, {
   3.959945928056305*^9, 3.959945935358474*^9}, {3.96177481629348*^9, 
   3.961774838764179*^9}, 3.961775084269043*^9, 3.9617751444678154`*^9, {
   3.961775455131441*^9, 3.9617755143824043`*^9}, {3.961775607581211*^9, 
   3.961775622979496*^9}, {3.961860330551809*^9, 3.961860333694588*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"6819d197-4e36-4982-bd04-41a7afc5253a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "previous", " ", "overlay", " ", "as", " ", 
    "a", " ", "dynamic", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dynimgs", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DynamicImage", "[", 
         RowBox[{
          RowBox[{"Rasterize", "[", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"AspectRatio", "->", "Automatic"}]}], "]"}], ",", 
            RowBox[{"RasterSize", "->", 
             RowBox[{"ImageDimensions", "[", "#2", "]"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "imgsize2"}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"filtbranchdispl", ",", "imgtrimres"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"dynimgs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "dynimgs", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"ControlPlacement", "->", "Top"}], ",", 
     RowBox[{"TrackedSymbols", ":>", 
      RowBox[{"{", "i", "}"}]}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8925655289067507`*^9, 3.892565530558048*^9}, {
   3.892565969686726*^9, 3.892565983232371*^9}, {3.8958293786129255`*^9, 
   3.895829392772168*^9}, {3.895829595093689*^9, 3.895829630974199*^9}, {
   3.896280935465916*^9, 3.896280943042255*^9}, {3.896281132331888*^9, 
   3.896281157044599*^9}, {3.8962811919535947`*^9, 3.896281225703329*^9}, 
   3.896282139120845*^9, {3.919249596252805*^9, 3.919249628367224*^9}, {
   3.919249694616577*^9, 3.919249696741076*^9}, {3.919249735200676*^9, 
   3.919249750192545*^9}, {3.919249785041753*^9, 3.919249828250905*^9}, {
   3.9197682593425064`*^9, 3.9197682654550962`*^9}, {3.937657065781353*^9, 
   3.937657084175026*^9}, {3.937657131516414*^9, 3.937657138415451*^9}, 
   3.937657230305332*^9, {3.939996328503937*^9, 3.939996371650707*^9}, 
   3.9479454588708744`*^9},
 CellLabel->
  "In[473]:=",ExpressionUUID->"0bee3e48-7de6-48cb-9d1a-31eb7c7aafb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Overlays", " ", "a", " ", "scale", " ", "bar", " ", "on", " ", "top", " ",
     "of", " ", "the", " ", "result", " ", "saved", " ", "in", " ", 
    RowBox[{"filtbranchdispl", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fbdscalebar", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"scaleBarV3", "[", 
       RowBox[{
        RowBox[{"filtbranchdispl", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"ImageDimensions", "[", 
         RowBox[{"imgtrimres", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"ps", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", "0.01", ",", 
        RowBox[{"scalebarparams", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "filtbranchdispl", "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.895672361538423*^9, 3.895672431896833*^9}, {
  3.895673100091408*^9, 3.895673124223425*^9}, {3.895673181934972*^9, 
  3.895673205545017*^9}, {3.895673603355674*^9, 3.895673641294608*^9}, {
  3.896538853957197*^9, 3.896538868995548*^9}, {3.903710116206067*^9, 
  3.903710138702927*^9}, {3.904995900345375*^9, 3.904995900433601*^9}, {
  3.920739337616462*^9, 3.920739337732239*^9}, {3.932209794505174*^9, 
  3.9322097946054974`*^9}, {3.948556665291895*^9, 3.948556674061081*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"42029cc9-e7bd-4fa7-ae49-4e6d010759fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "previous", " ", "overlay", " ", "as", " ", 
    "a", " ", "dynamic", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{"fbdscalebar", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"RasterSize", "->", 
         RowBox[{"ImageDimensions", "[", 
          RowBox[{"imgtrimres", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"ImageSize", "->", "size"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "fbdscalebar", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "500"}], "}"}], ",", "100", ",", "1000", ",", 
      "100"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "->", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.895759567037155*^9, 3.8957595973345103`*^9}, {
   3.895759638052497*^9, 3.8957596720043383`*^9}, {3.895759831135095*^9, 
   3.895759841388248*^9}, {3.895829936937315*^9, 3.895829937769952*^9}, {
   3.919768639012891*^9, 3.919768654896147*^9}, 3.920739321535398*^9, {
   3.932210169886236*^9, 3.932210186276254*^9}, {3.932219461624924*^9, 
   3.932219515327177*^9}, 3.933165229286201*^9, 3.937657299488451*^9, {
   3.9399963995114994`*^9, 3.939996403588558*^9}, 3.9404281005205326`*^9},
 CellLabel->
  "In[476]:=",ExpressionUUID->"16826b98-1ddd-4440-9b1e-fe7450ee171c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Exporting", " ", "filtered", " ", "skeleton", " ", "result", " ", "image",
     " ", "overlay", " ", "without", " ", "scale", " ", "bar"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"expMult", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{
      "\"\<Filtered skeleton overlay\>\"", ",", "datapath", ",", "2"}], 
      "]"}]}], ",", "fnoriginal", ",", "\"\<.tiff\>\"", ",", 
    "filtbranchdispl"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891619138339893*^9, 3.891619144228653*^9}, 
   3.891619325133745*^9, {3.8916975351931767`*^9, 3.891697554498254*^9}, 
   3.891698027296107*^9, {3.895672772140355*^9, 3.895672775747338*^9}, 
   3.947932264827593*^9, {3.947932299177819*^9, 3.9479323263598576`*^9}, {
   3.9482047256585255`*^9, 3.9482047258941593`*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"f803a1cb-42e7-4fab-ba81-52a278de5d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Exporting", " ", "filtered", " ", "skeleton", " ", "result", " ", "image",
     " ", "overlay", " ", "with", " ", "scale", " ", "bar"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"expMult", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{
      "\"\<Filtered skeleton overlay (scale bar)\>\"", ",", "datapath", ",", 
       "2"}], "]"}]}], ",", "fnoriginal", ",", "\"\<.tiff\>\"", ",", 
    "fbdscalebar"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891619138339893*^9, 3.891619144228653*^9}, 
   3.891619325133745*^9, {3.8916975351931767`*^9, 3.891697554498254*^9}, 
   3.891698027296107*^9, {3.8956727167130747`*^9, 3.89567278448719*^9}, 
   3.947932273607027*^9, 3.9479323092217865`*^9, {3.948204729100847*^9, 
   3.948204732236868*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"ee1d4192-17f9-4d13-9807-4cc05fe4c06f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Skeleton index label overlay", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.947931865258858*^9, 3.94793186803487*^9}, {3.94793197009202*^9, 
  3.9479320148807926`*^9}},ExpressionUUID->"e06c0289-2fd8-f645-a95a-\
4c6520470662"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Creates", " ", "an", " ", "overlay", " ", "composed", " ", "of", " ", 
     "the", " ", "original", " ", "image"}], ",", " ", 
    RowBox[{"the", " ", "skeleton", " ", "segment", " ", "lable", " ", 
     RowBox[{"(", "red", ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "filtered", " ", "skeleton", " ", "result", " ", 
     RowBox[{"(", "green", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"labeledss", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HighlightImage", "[", 
       RowBox[{
        RowBox[{"imgtrimres", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Green", ",", 
          RowBox[{"PointSize", "[", "ptsize", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"sscfilt", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}], ",", "1"}], 
            "]"}], "]"}], ",", "Red", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#1", ",", "sslabelsize", ",", "Bold"}], "]"}], ",", 
               "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"sscfilt", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All", ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"sscfilt", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All", ",", "5"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"ImageSize", "->", 
         RowBox[{"ImageDimensions", "[", 
          RowBox[{"imgtrimres", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "sscfilt", "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.89559099355318*^9, 3.895591173860765*^9}, {
   3.8955912339128284`*^9, 3.895591303152689*^9}, 3.895591335225363*^9, {
   3.895591492528795*^9, 3.8955915270287275`*^9}, {3.895658439055863*^9, 
   3.895658441570864*^9}, 3.942834203256708*^9, {3.947931890074564*^9, 
   3.947931893901762*^9}, {3.9479550697517624`*^9, 3.947955082721794*^9}, {
   3.947955662939215*^9, 3.947955663096388*^9}, 3.947955749133454*^9, {
   3.948299342093451*^9, 3.948299343067524*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"e65ab87a-840e-48eb-8525-0984d956ee53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "previous", " ", "overlay", " ", "as", " ", 
    "a", " ", "dynamic", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dynimgs1", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DynamicImage", "[", 
         RowBox[{
          RowBox[{"Rasterize", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"RasterSize", "->", 
             RowBox[{"ImageDimensions", "[", "#2", "]"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "imgsize2"}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"labeledss", ",", "imgtrimres"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"dynimgs1", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "dynimgs1", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"ControlPlacement", "->", "Top"}], ",", 
     RowBox[{"TrackedSymbols", ":>", 
      RowBox[{"{", "i", "}"}]}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.8925655289067507`*^9, 3.892565530558048*^9}, {
   3.892565969686726*^9, 3.892565983232371*^9}, {3.895591409947672*^9, 
   3.8955914318121862`*^9}, 3.895829718990694*^9, {3.89653819816378*^9, 
   3.8965382074415045`*^9}, {3.919165560986303*^9, 3.919165601753292*^9}, {
   3.919165647733798*^9, 3.919165674053157*^9}, {3.919165719438185*^9, 
   3.919165796798131*^9}, {3.919768381636716*^9, 3.919768383048475*^9}, 
   3.9376572360255184`*^9, {3.9424972995392447`*^9, 3.942497313145635*^9}, {
   3.942769913067732*^9, 3.942769918039888*^9}, 3.947945480007641*^9, 
   3.947955673806965*^9},
 CellLabel->
  "In[480]:=",ExpressionUUID->"369010e1-534e-4224-ad79-f41857fa032d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Distance transform line overlay", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.947931865258858*^9, 3.94793186803487*^9}, {3.94793197009202*^9, 
  3.9479320148807926`*^9}, {3.947932157494774*^9, 
  3.9479321706325855`*^9}},ExpressionUUID->"91c5f731-18da-804d-9ae8-\
2bb0c34f9743"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Creates", " ", "an", " ", "overlay", " ", "composed", " ", "of", " ", 
     "the", " ", "original", " ", "image"}], ",", " ", 
    RowBox[{"filtered", " ", "skeleton", " ", "result", " ", 
     RowBox[{"(", "green", ")"}]}], ",", " ", 
    RowBox[{
    "location", " ", "of", " ", "point", " ", "of", " ", "interets", " ", 
     "in", " ", "branch", " ", 
     RowBox[{"(", "blue", ")"}]}], ",", " ", 
    RowBox[{"and", " ", "a", " ", "line", " ", 
     RowBox[{"(", "red", ")"}], " ", "between", " ", "the", " ", "location", 
     " ", "of", " ", "the", " ", "point", " ", "of", " ", "interest", " ", 
     "and", " ", "its", " ", "neareast", " ", "background", " ", 
     RowBox[{"pixel", ".", " ", "In"}], " ", "addition", " ", "if", " ", 
     "add", " ", "circle", " ", "is", " ", "\"\<yes\>\"", " ", "it", " ", 
     "overlays", " ", "an", " ", "enclosing", " ", 
     RowBox[{"circle", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"locdiplay", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"highlightLocationsV2", "[", 
        RowBox[{
         RowBox[{"sscfilt", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"separatebrnch", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"imgtrimres", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"modbin", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "pointofinterest", ",", 
         "ptsize", ",", "0.001", ",", "\"\<yes\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sscfilt", "]"}]}], "}"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.892645110961689*^9, 3.892645149022705*^9}, {
   3.892645193555282*^9, 3.892645203487634*^9}, {3.892645541426499*^9, 
   3.892645543442744*^9}, {3.892645806658426*^9, 3.892645835039706*^9}, {
   3.892645885345329*^9, 3.892645947705347*^9}, {3.892904308131192*^9, 
   3.892904319210234*^9}, {3.8929049403174086`*^9, 3.892904940402284*^9}, {
   3.892906617328509*^9, 3.89290661968609*^9}, {3.896956971644775*^9, 
   3.896956979210458*^9}, {3.896957009681539*^9, 3.8969570499807477`*^9}, 
   3.9376516816863008`*^9, {3.947955123097826*^9, 3.947955126048593*^9}, {
   3.948299452058977*^9, 3.948299452795889*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"c6704fc9-a50c-44dd-bc43-cabaea87b90f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "the", " ", "previous", " ", "overlay", " ", "as", " ", 
    "a", " ", "dynamic", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lochighlight", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DynamicImage", "[", 
         RowBox[{
          RowBox[{"Rasterize", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"RasterSize", "->", 
             RowBox[{"ImageDimensions", "[", "#2", "]"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "imgsize2"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"locdiplay", ",", "imgtrimres"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"lochighlight", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "lochighlight", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"ControlPlacement", "->", "Top"}], ",", 
     RowBox[{"TrackedSymbols", ":>", 
      RowBox[{"{", "i", "}"}]}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.892645049209532*^9, 3.89264507400331*^9}, {
   3.892645158533883*^9, 3.892645173173087*^9}, 3.892645212085719*^9, 
   3.892645249186286*^9, {3.892645545646285*^9, 3.892645547477735*^9}, 
   3.8926457961113977`*^9, 3.8958298488393846`*^9, {3.8965383089539585`*^9, 
   3.896538320022699*^9}, 3.937657247971628*^9, 3.947945489650778*^9},
 CellLabel->
  "In[483]:=",ExpressionUUID->"98513967-e61f-413f-8af2-d0bd9533bddf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Junction point graphic", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.947931865258858*^9, 3.94793186803487*^9}, {3.94793197009202*^9, 
  3.9479320148807926`*^9}, {3.947932070624655*^9, 
  3.947932074153979*^9}},ExpressionUUID->"8540be5a-bc87-0e45-92cf-\
993644db6ee9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Displays", " ", "a", " ", "graphic", " ", "highlighting", " ", "the", " ",
     "skeleton", " ", "segments", " ", "and", " ", "junction", " ", 
    RowBox[{"points", ".", " ", "You"}], " ", "can", " ", "use", " ", "max", 
    " ", "rad", " ", 
    RowBox[{"(", 
     RowBox[{"4", "th", " ", "slot"}], ")"}], " ", "to", " ", "average", " ", 
    "the", " ", "junction", " ", "points", " ", "\n", "within", " ", "that", 
    " ", "radius", " ", "and", " ", "show", " ", "a", " ", "mean", " ", 
    RowBox[{"coordinate", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"jpgrph", "=", 
     RowBox[{"juncPtGraphic", "[", 
      RowBox[{
       RowBox[{"imgtrimres", "[", 
        RowBox[{"[", "activeimgpos", "]"}], "]"}], ",", 
       RowBox[{"junctptsimgs", "[", 
        RowBox[{"[", "activeimgpos", "]"}], "]"}], ",", 
       RowBox[{"sscfilt", "[", 
        RowBox[{"[", "activeimgpos", "]"}], "]"}], ",", "0", ",", "ptsize", 
       ",", "0.005", ",", "imgsize2", ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"26", "/", "255"}], ",", 
         RowBox[{"255", "/", "255"}], ",", 
         RowBox[{"26", "/", "255"}]}], "]"}], ",", 
       RowBox[{"RGBColor", "[", 
        RowBox[{
         RowBox[{"75", "/", "255"}], ",", 
         RowBox[{"0", "/", "255"}], ",", 
         RowBox[{"146", "/", "255"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{"jpgrph", ",", 
     RowBox[{"ImageSize", "->", "imgsize2"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.93730924402606*^9, 3.937309250765961*^9}, 
   3.9373092819717045`*^9, {3.9373093207189903`*^9, 3.937309389837054*^9}, {
   3.937314171764393*^9, 3.9373141975345592`*^9}, 3.937314689721934*^9, 
   3.937657285862261*^9, {3.938512841649523*^9, 3.938512841727619*^9}, {
   3.938512919969408*^9, 3.938512924468111*^9}, {3.947931775492157*^9, 
   3.947931776431669*^9}, {3.947932665840294*^9, 3.947932667826034*^9}, 
   3.9479454967803593`*^9, 3.9479551337893143`*^9, {3.948208819046883*^9, 
   3.9482088353584347`*^9}, {3.94829955222074*^9, 3.9482995530058765`*^9}, {
   3.948538745984669*^9, 3.948538756310645*^9}, 3.957520969715788*^9, {
   3.957521017661396*^9, 3.957521041964002*^9}, {3.957521082040823*^9, 
   3.957521082158978*^9}, {3.957868499084381*^9, 3.957868514445915*^9}, {
   3.9578791645225964`*^9, 3.9578791646163254`*^9}, {3.958125882576025*^9, 
   3.9581259070657234`*^9}, {3.959090095105585*^9, 3.959090125213527*^9}, 
   3.959787235027928*^9, {3.959787269652838*^9, 3.959787272164814*^9}, 
   3.959787337953829*^9, 3.9597876351117487`*^9, {3.963393375940571*^9, 
   3.963393382143345*^9}, {3.963393422837591*^9, 3.963393423087355*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"2584a57f-f3b6-f842-8b19-c14c4bb79962"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Export", " ", "the", " ", "junction", " ", "point", " ", "highlight", " ", 
    RowBox[{"graphic", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"exportFunc", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Exported graphics\>\"", ",", "datapath", ",", "2"}], 
      "]"}]}], ",", 
    RowBox[{"\"\<juncPt_\>\"", "<>", 
     RowBox[{"FileBaseName", "@", 
      RowBox[{"fnoriginal", "[", 
       RowBox[{"[", "activeimgpos", "]"}], "]"}]}], "<>", "\"\<.tiff\>\""}], 
    ",", "jpgrph"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947932606178931*^9, 3.9479326267756004`*^9}, 
   3.947932682207161*^9, {3.948207484793997*^9, 3.948207485301314*^9}, {
   3.948209441859825*^9, 3.94820944381304*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"5356e8a8-9823-9c4c-a81e-20512a6ee00f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filtered color map", "Subsubsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.89109689644892*^9, 
  3.891096901570122*^9}, {3.891097379801637*^9, 3.8910973817893853`*^9}, {
  3.8913445203894544`*^9, 3.891344524322372*^9}, {3.8913569550473666`*^9, 
  3.891356957593641*^9}, {3.891358102514762*^9, 3.891358102655387*^9}, {
  3.891697647188661*^9, 3.891697647306574*^9}, {3.892039529190706*^9, 
  3.892039529320796*^9}, {3.892048897901917*^9, 3.892048899010022*^9}, {
  3.947931865258858*^9, 3.94793186803487*^9}, {3.94793197009202*^9, 
  3.9479320148807926`*^9}, {3.947932070624655*^9, 
  3.947932087661456*^9}},ExpressionUUID->"ba2027d8-858b-6545-8417-\
8520ddf9acb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Evaluate", " ", "to", " ", "obtain", " ", "a", " ", "width", " ", "color",
     " ", "map", " ", "of", " ", "the", " ", "active", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"activeimg1", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"colneg", "===", "\"\<yes\>\""}], ",", 
       RowBox[{"ColorNegate", "[", 
        RowBox[{"imgtrimres", "[", 
         RowBox[{"[", "activeimgpos", "]"}], "]"}], "]"}], ",", 
       RowBox[{"imgtrimres", "[", 
        RowBox[{"[", "activeimgpos", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"colormap", "=", 
      RowBox[{"widthColorMap", "[", 
       RowBox[{"activeimg1", ",", 
        RowBox[{"sscfilt", "[", 
         RowBox[{"[", "activeimgpos", "]"}], "]"}], ",", 
        RowBox[{"ps", "[", 
         RowBox[{"[", 
          RowBox[{"activeimgpos", ",", "2"}], "]"}], "]"}], ",", "multby2", 
        ",", "\"\<Rainbow\>\"", ",", "3", ",", "scalebarunit", ",", "1", ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"ptsize", "*", "2"}], ",", "3", ",", "70"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"dragZoomShow", "@", 
    RowBox[{"Show", "[", 
     RowBox[{"colormap", ",", 
      RowBox[{"ImageSize", "->", "imgsize2"}]}], "]"}]}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.933240492958235*^9, 3.933240554670397*^9}, {
   3.933242659871996*^9, 3.93324269902343*^9}, 3.933242966740866*^9, 
   3.933257072120878*^9, {3.933259423480896*^9, 3.933259434754221*^9}, {
   3.933259995263475*^9, 3.9332600453061657`*^9}, {3.933264198701004*^9, 
   3.933264208969601*^9}, {3.9333308127937756`*^9, 3.93333083389229*^9}, {
   3.933330908821039*^9, 3.933330912896347*^9}, {3.933430212300865*^9, 
   3.933430236060154*^9}, {3.9334336046857376`*^9, 3.933433605009081*^9}, {
   3.933436840392746*^9, 3.933436850058375*^9}, {3.933437211609066*^9, 
   3.9334372146396008`*^9}, {3.934625262776516*^9, 3.934625263432619*^9}, {
   3.934625424819481*^9, 3.934625426194157*^9}, {3.934625467003023*^9, 
   3.934625467112374*^9}, {3.934625638493412*^9, 3.934625639196375*^9}, {
   3.93462571273468*^9, 3.934625767116743*^9}, {3.934625799139044*^9, 
   3.934625838389393*^9}, {3.937495469897249*^9, 3.937495495950481*^9}, 
   3.937495533258239*^9, {3.937495566466837*^9, 3.937495566539465*^9}, {
   3.9374957071154156`*^9, 3.937495795409824*^9}, {3.937495968753139*^9, 
   3.937495969772564*^9}, 3.9374960807566643`*^9, {3.937496190900488*^9, 
   3.9374961921805305`*^9}, {3.943027265547346*^9, 3.94302727286215*^9}, 
   3.9479551397079277`*^9, {3.948299520256409*^9, 3.948299532606938*^9}, {
   3.9483683959555225`*^9, 3.9483684006175175`*^9}, {3.948368701442843*^9, 
   3.948368701866886*^9}, {3.948538280392079*^9, 3.948538280470215*^9}, {
   3.9485384245214405`*^9, 3.948538424599531*^9}, {3.948538717120098*^9, 
   3.948538717370041*^9}, {3.956663973626077*^9, 3.956663984373226*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"80740dab-1a64-cb41-b2d3-0cf97ef1a046"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Export", " ", "the", " ", "filtered", " ", "color", " ", "map", " ", 
    "for", " ", "the", " ", "active", " ", 
    RowBox[{"image", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"exportFunc", "[", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Exported graphics\>\"", ",", "datapath", ",", "2"}], 
      "]"}]}], ",", 
    RowBox[{"\"\<colorMap_\>\"", "<>", 
     RowBox[{"FileBaseName", "@", 
      RowBox[{"fnoriginal", "[", 
       RowBox[{"[", "activeimgpos", "]"}], "]"}]}], "<>", "\"\<.tiff\>\""}], 
    ",", "colormap"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.947932509657168*^9, 3.9479325816528*^9}, {
  3.948209754305565*^9, 3.94820975505459*^9}, {3.9482101416930485`*^9, 
  3.948210156091028*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"74b6794d-763a-644b-9835-74aef9212be1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Statistical analysis", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}, {3.891088988234212*^9, 3.891088991323437*^9}, {
  3.8910892733371367`*^9, 3.891089279769807*^9}, {3.891358748791428*^9, 
  3.891358751790722*^9}, {3.8914331838075223`*^9, 3.891433186330666*^9}, {
  3.891512678971051*^9, 3.891512689881564*^9}, {3.891618431642831*^9, 
  3.891618448424678*^9}, {3.891699087333363*^9, 
  3.891699090400836*^9}},ExpressionUUID->"b5d98911-e68c-48d4-9af5-\
9638d53a9315"],

Cell[CellGroupData[{

Cell["Scaling skeleton width data", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
  3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
  3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
  3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
  3.8914332273222404`*^9}, {3.891618615561842*^9, 3.891618618752888*^9}, {
  3.891618655464831*^9, 3.891618658776661*^9}, {3.891618707035776*^9, 
  3.891618708067644*^9}, {3.8916187465688367`*^9, 3.8916187485220995`*^9}, {
  3.8916976515011797`*^9, 3.891697651691318*^9}, {3.892033460938282*^9, 
  3.89203350168859*^9}, {3.8956578151879573`*^9, 
  3.8956578456963806`*^9}},ExpressionUUID->"e0546cdd-577e-48f8-9a42-\
27c1755e588a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Unrefined", " ", "skeleton", " ", "width", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"widthdata", "=", 
    RowBox[{"Flatten", "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"scaleFunc", "[", 
        RowBox[{
         RowBox[{"skeletondata", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"ps", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "multbytwo"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "skeletondata", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"skeletondata", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891700187791106*^9, 3.891700220376973*^9}, {
   3.891700330040154*^9, 3.891700345013352*^9}, {3.891703868084943*^9, 
   3.891703985709959*^9}, {3.8917043017466035`*^9, 3.891704353819725*^9}, 
   3.901813035075726*^9, {3.94821029779961*^9, 3.9482102983597603`*^9}, {
   3.959683296196607*^9, 3.959683354902061*^9}, {3.959683586880062*^9, 
   3.9596835890514317`*^9}, 3.959684367643465*^9},
 CellLabel->
  "In[542]:=",ExpressionUUID->"b922374a-f1b3-40d7-a277-bf4ebbdc5c74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Unrefined", " ", "skeleton", " ", "width", " ", 
    RowBox[{"data", ".", " ", "Mean"}], " ", "of", " ", "each", " ", 
    "skeleton", " ", "segment"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"widthmeandat", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Mean", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"scaleFunc", "[", 
         RowBox[{
          RowBox[{"skeletondata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"ps", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "multbytwo"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "skeletondata", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"skeletondata", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.959683143546232*^9, 3.95968314629826*^9}, {
  3.959683433278517*^9, 3.959683448530655*^9}, {3.959683540182749*^9, 
  3.959683621789577*^9}, {3.959684386464697*^9, 3.959684404319521*^9}},
 CellLabel->
  "In[543]:=",ExpressionUUID->"c9ece1f2-178e-de40-8d41-fb2954b766f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Refined", " ", "skeleton", " ", "width", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"refwidthdata", "=", 
    RowBox[{"Flatten", "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"scaleFunc", "[", 
        RowBox[{
         RowBox[{"sscref", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"ps", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "multbytwo"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sscref", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"sscref", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891699324806714*^9, 3.891699370430303*^9}, {
   3.891699490755913*^9, 3.891699493664198*^9}, {3.8916997080582333`*^9, 
   3.891699724533923*^9}, {3.891699775891553*^9, 3.8916998322659273`*^9}, {
   3.8916998676146994`*^9, 3.8916998941863136`*^9}, {3.891700183086151*^9, 
   3.891700183546418*^9}, {3.891704348971966*^9, 3.891704365348742*^9}, {
   3.892044684426979*^9, 3.892044687657141*^9}, {3.9018090786293745`*^9, 
   3.901809120290686*^9}, 3.9018130387767315`*^9, {3.94795375006266*^9, 
   3.94795375895163*^9}, {3.948210288257679*^9, 3.948210314423973*^9}, {
   3.948211793133066*^9, 3.948211793399958*^9}},
 CellLabel->
  "In[544]:=",ExpressionUUID->"07af755a-2fd1-4b14-8524-f1570b9dda48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Refined", " ", "skeleton", " ", "width", " ", 
    RowBox[{"data", ".", " ", "Mean"}], " ", "of", " ", "each", " ", 
    "skeleton", " ", "segment"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"refwidthmeandat", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Mean", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"scaleFunc", "[", 
         RowBox[{
          RowBox[{"sscref", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"ps", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "multbytwo"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "sscref", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"sscref", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.891699324806714*^9, 3.891699370430303*^9}, {
   3.891699490755913*^9, 3.891699493664198*^9}, {3.8916997080582333`*^9, 
   3.891699724533923*^9}, {3.891699775891553*^9, 3.8916998322659273`*^9}, {
   3.8916998676146994`*^9, 3.8916998941863136`*^9}, {3.891700183086151*^9, 
   3.891700183546418*^9}, {3.891704348971966*^9, 3.891704365348742*^9}, {
   3.892044684426979*^9, 3.892044687657141*^9}, {3.9018091262060947`*^9, 
   3.9018092281827354`*^9}, 3.901813087681079*^9, {3.947953766740742*^9, 
   3.9479537728651752`*^9}, {3.9482103197428093`*^9, 3.948210343874735*^9}, {
   3.948211796806946*^9, 3.948211797696974*^9}, {3.959683644516348*^9, 
   3.959683661113735*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"5ac906fe-c6fa-4217-a15d-90dda18d43e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Statistical metrics table", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
   3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
   3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
   3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
   3.8914332273222404`*^9}, {3.891618615561842*^9, 3.891618618752888*^9}, {
   3.891618655464831*^9, 3.891618658776661*^9}, {3.891618707035776*^9, 
   3.891618708067644*^9}, {3.8916187465688367`*^9, 3.8916187485220995`*^9}, {
   3.8916976515011797`*^9, 3.891697651691318*^9}, {3.892033460938282*^9, 
   3.892033524963312*^9}, {3.892034446982015*^9, 3.892034455470518*^9}, {
   3.892303442488843*^9, 3.892303448719514*^9}, 3.948211378796028*^9, {
   3.959691266643154*^9, 
   3.959691271446644*^9}},ExpressionUUID->"8236c1eb-4cb2-5c44-8c0f-\
7e5a96d7152e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Formats", " ", "the", " ", "data", " ", "into", " ", 
    RowBox[{"groups", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"formatddata", "=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"activedata", "===", "\"\<refined\>\""}], "&&", 
       RowBox[{"meansklwidth", "===", "\"\<no\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"formatDat1", "[", 
       RowBox[{"refwidthdata", ",", "groupnames", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"FileBaseName", ",", "fnoriginal"}], "]"}], ",", 
        "grouplengths"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"activedata", "===", "\"\<refined\>\""}], "&&", 
       RowBox[{"meansklwidth", "===", "\"\<yes\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"formatDat1", "[", 
       RowBox[{"refwidthmeandat", ",", "groupnames", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"FileBaseName", ",", "fnoriginal"}], "]"}], ",", 
        "grouplengths"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"activedata", "===", "\"\<all\>\""}], "&&", 
       RowBox[{"meansklwidth", "===", "\"\<no\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"formatDat1", "[", 
       RowBox[{"widthdata", ",", "groupnames", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"FileBaseName", ",", "fnoriginal"}], "]"}], ",", 
        "grouplengths"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"activedata", "===", "\"\<all\>\""}], "&&", 
       RowBox[{"meansklwidth", "===", "\"\<yes\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"formatDat1", "[", 
       RowBox[{"widthmeandat", ",", "groupnames", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"FileBaseName", ",", "fnoriginal"}], "]"}], ",", 
        "grouplengths"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.959683992452005*^9, 3.959684137638616*^9}, 
   3.959684222612038*^9, {3.959685043209156*^9, 3.959685044068323*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"1514a7c9-9f23-8944-8356-375beb0fb60e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Combines", " ", "the", " ", "data", " ", "within", " ", "the", " ", 
     "groups", " ", "if", " ", "user", " ", "selects", " ", "joingroups"}], 
    " ", "=", " ", "\"\<yes\>\""}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fdmod", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"joingroups", "===", "\"\<no\>\""}], ",", "formatddata", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Values", "[", "#", "]"}], ",", "1"}], "]"}], "&"}], ",", 
        "formatddata"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.9482113924289246`*^9, 3.948211434335155*^9}, 
   3.9482119835802937`*^9, {3.9482830098506603`*^9, 3.9482830255206985`*^9}, {
   3.9482830601545086`*^9, 3.948283120636503*^9}},
 CellLabel->
  "In[547]:=",ExpressionUUID->"3cffc58a-a72c-d444-90ca-2056ee6a9e9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Computes", " ", "statistical", " ", 
    RowBox[{"metrics", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"statmetrics", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"joingroups", "===", "\"\<no\>\""}], ",", 
      RowBox[{"statsTableV2", "[", 
       RowBox[{"fdmod", ",", "grouplengths"}], "]"}], ",", 
      RowBox[{"statsTablesJoined", "[", "fdmod", "]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{
  3.892034472359977*^9, {3.892036160024623*^9, 3.892036169064252*^9}, 
   3.892043294956787*^9, 3.892043659456855*^9, {3.892566527987075*^9, 
   3.89256655960077*^9}, {3.8958303338529997`*^9, 3.895830335103224*^9}, 
   3.901809580697852*^9, {3.933427978916369*^9, 3.933427979418129*^9}, {
   3.9334287904656143`*^9, 3.933428835382261*^9}, 3.9435498830974483`*^9, {
   3.948212409478359*^9, 3.948212435088808*^9}, {3.948212489458893*^9, 
   3.948212492982752*^9}, {3.948283143311096*^9, 3.948283144283924*^9}, {
   3.9483723364955006`*^9, 3.9483723366360817`*^9}, 3.959442150634342*^9},
 CellLabel->
  "In[548]:=",ExpressionUUID->"c889680c-178d-044c-ac9a-cfdab5a492ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Prints", " ", "a", " ", "statistical", " ", "metrics", " ", "table"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"statstable", "=", 
   RowBox[{"printStats", "[", 
    RowBox[{"statmetrics", ",", "joingroups", ",", "groupnames", ",", "3"}], 
    "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.89203628277878*^9, 3.8920363108522873`*^9}, {
   3.933167751760184*^9, 3.933167758972078*^9}, 3.9334279999809475`*^9, {
   3.933428376358084*^9, 3.933428399104034*^9}, {3.93342872886257*^9, 
   3.9334287315412407`*^9}, {3.933428773100803*^9, 3.933428777777472*^9}, {
   3.937494061611517*^9, 3.937494103024135*^9}, 3.937494595647339*^9, {
   3.947934267710718*^9, 3.947934281182764*^9}, {3.948212573478882*^9, 
   3.948212604814457*^9}, 3.9482772610096817`*^9, {3.948283246256966*^9, 
   3.948283251216265*^9}, {3.948283789882387*^9, 3.948283791783158*^9}, {
   3.948289470200415*^9, 3.94828947582403*^9}, {3.9483723491559486`*^9, 
   3.948372354497435*^9}, {3.948975755240404*^9, 3.948975765167637*^9}, 
   3.959092407691328*^9, 3.959859428085522*^9},
 CellLabel->
  "In[549]:=",ExpressionUUID->"a6e4d162-7c04-8f42-912e-8506a6c726d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of junction points and skeleton segments", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.940693767445145*^9, 3.940693792326351*^9}, {
  3.947934184447043*^9, 3.947934184998556*^9}, {3.947935238982332*^9, 
  3.947935241618422*^9}, {3.956665449597788*^9, 3.956665450430904*^9}, {
  3.957952621061947*^9, 
  3.957952660841994*^9}},ExpressionUUID->"818beb9f-16ef-474f-8d44-\
7b1bb6975638"],

Cell[BoxData[
 RowBox[{"tableDisplay4", "[", 
  RowBox[{"fnoriginal", ",", "numofjunctpts", ",", "sscref"}], "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{3.9579523965734463`*^9},
 CellLabel->
  "In[550]:=",ExpressionUUID->"862f9379-496d-7143-9ac2-104148467da7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Statistical graphics", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.863178402470948*^9, 3.863178403385509*^9}, {
   3.863189374873237*^9, 3.863189381321326*^9}, {3.863189415661889*^9, 
   3.863189418187738*^9}, {3.863189623484187*^9, 3.8631896257642274`*^9}, {
   3.864382213152033*^9, 3.864382217837672*^9}, {3.891433223056691*^9, 
   3.8914332273222404`*^9}, {3.891618615561842*^9, 3.891618618752888*^9}, {
   3.891618655464831*^9, 3.891618658776661*^9}, {3.891618707035776*^9, 
   3.891618708067644*^9}, {3.8916187465688367`*^9, 3.8916187485220995`*^9}, {
   3.8916976515011797`*^9, 3.891697651691318*^9}, {3.892033460938282*^9, 
   3.892033524963312*^9}, {3.892034446982015*^9, 3.892034455470518*^9}, {
   3.892303442488843*^9, 3.892303448719514*^9}, 3.948211378796028*^9, {
   3.959691266643154*^9, 
   3.959691285099882*^9}},ExpressionUUID->"d339936c-f613-464e-8f5c-\
b2892f938410"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Stacked", " ", "histogram", " ", "plots", " ", "of", " ", "the", " ", 
    "skeleton", " ", 
    RowBox[{"width", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Histogram", "[", 
     RowBox[{
      RowBox[{"fdmod", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", "binsize1", "}"}], ",", "\"\<Probability\>\"", ",", 
      RowBox[{"ImageSize", "\[Rule]", "imgsize3"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "histpltrange"}], ",", 
      RowBox[{"ChartLegends", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Width\>\"", "<>", "\"\< (\>\"", "<>", 
          RowBox[{"ToString", "[", "scalebarunit", "]"}], "<>", "\"\<)\>\""}],
          ",", "\"\<Probability\>\""}], "}"}]}], ",", 
      RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "fdmod", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.892045056101489*^9, 3.89204505908305*^9}, {
   3.892045141806034*^9, 3.892045146607541*^9}, {3.892203000058562*^9, 
   3.892203019121856*^9}, {3.89228599383958*^9, 3.892285994856683*^9}, {
   3.892286105904278*^9, 3.892286168249427*^9}, {3.8922862202824926`*^9, 
   3.8922862326472025`*^9}, {3.9018096160443287`*^9, 3.901809619176162*^9}, {
   3.901811740518127*^9, 3.901811752454515*^9}, {3.901812279745228*^9, 
   3.901812291559194*^9}, {3.9189208752345257`*^9, 3.9189209014390345`*^9}, 
   3.942770223090711*^9, {3.942840475141081*^9, 3.942840478126098*^9}, {
   3.946634425132307*^9, 3.946634432669031*^9}, {3.9479455881696854`*^9, 
   3.947945590145735*^9}, {3.948212625642063*^9, 3.94821263347958*^9}, {
   3.952426242560715*^9, 3.9524262435761185`*^9}, {3.9524262755359783`*^9, 
   3.952426301085735*^9}, {3.9524263467232533`*^9, 3.95242635048776*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"e3846004-aef9-1d49-b46c-56b0d0445e19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Skeleton", " ", "width", " ", "Box"}], "-", 
    RowBox[{"whisker", " ", "chart"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"bwc", "=", 
   RowBox[{"BoxWhiskerChart", "[", 
    RowBox[{"fdmod", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Diamond\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<MeanDiamond\>\"", ",", "1", ",", "Black"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"BarOrigin", "->", "Bottom"}], ",", 
     RowBox[{"ChartLabels", "->", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "imgsize3"}], ",", 
     RowBox[{"ChartLegends", "->", "None"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"\"\<Width\>\"", "<>", "\"\< (\>\"", "<>", 
       RowBox[{"ToString", "[", "scalebarunit", "]"}], "<>", "\"\<)\>\""}]}], 
     ",", 
     RowBox[{"BarSpacing", "->", "Automatic"}], ",", 
     RowBox[{"ScalingFunctions", "->", "scaling"}], ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.892045799333915*^9, 3.892045813589009*^9}, {
   3.89204587638437*^9, 3.8920458781843777`*^9}, {3.892286545235838*^9, 
   3.892286603127408*^9}, {3.8922866663198133`*^9, 3.892286692285225*^9}, {
   3.8923040219396424`*^9, 3.892304053696846*^9}, {3.892566670619327*^9, 
   3.892566671518608*^9}, {3.89264791198203*^9, 3.892647975274153*^9}, 
   3.8955790386307936`*^9, {3.8955790705342703`*^9, 3.8955790726011868`*^9}, 
   3.901809646241879*^9, {3.902307376557839*^9, 3.9023073858218393`*^9}, 
   3.9037828177251406`*^9, {3.937494692221178*^9, 3.937494769430996*^9}, {
   3.9374988929747677`*^9, 3.937498904636078*^9}, {3.947934305176943*^9, 
   3.947934307397702*^9}, 3.947945604757261*^9, {3.94821265679126*^9, 
   3.948212657356718*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"69071d2a-aaae-494b-952d-8720820b13dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting width data", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.940693767445145*^9, 3.940693792326351*^9}, {
  3.947934184447043*^9, 3.947934184998556*^9}, {3.947935238982332*^9, 
  3.947935241618422*^9}, {3.956665449597788*^9, 
  3.956665450430904*^9}},ExpressionUUID->"884c686c-6f58-3740-b5c1-\
e66e3d983763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Evaluate", " ", "to", " ", "export", " ", "width", " ", "data", " ", 
    "using", " ", "selected", " ", "file", " ", "format", " ", 
    RowBox[{"expformat", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ReinstallJava", "[", 
     RowBox[{"JVMArguments", " ", "->", " ", "\"\<-Xmx32768m\>\""}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"exportAll", "[", 
    RowBox[{
    "datapath", ",", "fnoriginal", ",", "datafn", ",", "kernsize1", ",", 
     "mincount1", ",", "minelongation1", ",", "dropfrac", ",", 
     "anglethreshold", ",", "ssmincount", ",", "widthdata", ",", 
     "widthmeandat", ",", "refwidthdata", ",", "refwidthmeandat", ",", 
     "expformat"}], "]"}]}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.956665460763696*^9, 3.956665493496156*^9}, {
  3.959685408207706*^9, 3.95968540900464*^9}, {3.959853998562669*^9, 
  3.9598539989392767`*^9}, {3.959854094617377*^9, 3.959854099690975*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"d96e3b86-ba95-0247-9828-de20dff3ead1"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temporary section", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.940693767445145*^9, 3.940693792326351*^9}, {
  3.947934184447043*^9, 3.947934184998556*^9}, {3.947935238982332*^9, 
  3.947935241618422*^9}, {3.948558579192854*^9, 
  3.948558581984705*^9}},ExpressionUUID->"4a024a96-ce67-c94e-a7e9-\
6d432a15219d"],

Cell[CellGroupData[{

Cell["Histograms", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.940693767445145*^9, 3.940693792326351*^9}, {
  3.947934184447043*^9, 3.947934184998556*^9}, {3.947935238982332*^9, 
  3.947935241618422*^9}, {3.956665449597788*^9, 3.956665450430904*^9}, {
  3.957952621061947*^9, 
  3.9579526230107784`*^9}},ExpressionUUID->"220e62f1-83d2-7344-a08a-\
17a9ca702152"],

Cell[BoxData[
 RowBox[{
  RowBox[{"groupAfterMax", "[", 
   RowBox[{"data_", ",", "max_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", ">", "max"}], ",", "max", ",", "#"}], "]"}], "&"}], ",", 
    "data"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.950619510414619*^9, 3.950619529063589*^9}, {
  3.950620145627926*^9, 3.950620175463375*^9}, {3.950620625598901*^9, 
  3.950620650266615*^9}, {3.950620682219784*^9, 3.95062070680176*^9}, {
  3.958654372355888*^9, 3.9586544084497337`*^9}, {3.958655077351557*^9, 
  3.9586550776814194`*^9}, {3.958655130804724*^9, 3.958655145148353*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"711484cb-6ccb-6e4a-a43d-f819d6e7f258"],

Cell[BoxData[
 RowBox[{
  RowBox[{"activepos", "=", "7"}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.9485596963752785`*^9, 3.9485596964812794`*^9}, 
   3.948883563624975*^9, 3.948883722720749*^9, 3.948883753223945*^9, {
   3.9488841012203693`*^9, 3.948884123979744*^9}, 3.948886836374861*^9, 
   3.948887149361595*^9, 3.948887622401844*^9, 3.948888140839884*^9, {
   3.948894555281719*^9, 3.948894555407284*^9}, 3.9488949904915695`*^9, 
   3.948973512294014*^9, {3.949495677320045*^9, 3.949495684318764*^9}, {
   3.9494972327287464`*^9, 3.94949725850753*^9}, 3.950621277664259*^9, 
   3.950621331834165*^9, {3.950621806590431*^9, 3.95062182723389*^9}, 
   3.9507006162376766`*^9, 3.950700798687245*^9, {3.95070106049346*^9, 
   3.950701067654757*^9}, 3.951821554379263*^9, 3.9518219479702015`*^9, {
   3.951822165136423*^9, 3.951822168513935*^9}, 3.9518222381944313`*^9, 
   3.951822504183924*^9, 3.9518227042679653`*^9, {3.9524271617571144`*^9, 
   3.952427162538183*^9}, {3.952427305174104*^9, 3.952427305877062*^9}, {
   3.952434983381201*^9, 3.952434983710975*^9}, {3.952435158376137*^9, 
   3.9524351584391384`*^9}, 3.9524421507925587`*^9, 3.95244237194173*^9, {
   3.95244245962846*^9, 3.952442460492643*^9}, {3.952442659512893*^9, 
   3.952442659669637*^9}, 3.952515384059774*^9, {3.952518217825329*^9, 
   3.952518218249359*^9}, 3.95322131295758*^9, 3.953222249882078*^9, {
   3.953653508913523*^9, 3.953653509054638*^9}, {3.957865223017688*^9, 
   3.957865230730093*^9}, 3.957879434823799*^9, 3.9581309911982784`*^9, {
   3.95813829624424*^9, 3.9581383124046535`*^9}, 3.958139028965433*^9, {
   3.958647496724718*^9, 3.958647506243667*^9}, {3.9586476403824635`*^9, 
   3.958647655642187*^9}, 3.958647955582373*^9, {3.958649560866604*^9, 
   3.958649568111421*^9}, 3.958653970145534*^9, {3.9586544222583027`*^9, 
   3.958654430598204*^9}, 3.958735948500204*^9, 3.958736537466416*^9, 
   3.958736567785012*^9, 3.9587366454492493`*^9, 3.958739657102545*^9, 
   3.958739771337801*^9, 3.958739977963915*^9, 3.959073816020525*^9, {
   3.9590746544501934`*^9, 3.9590746561150665`*^9}, 3.959090972011713*^9, 
   3.959438593472059*^9, 3.959438805165287*^9, {3.959439159671335*^9, 
   3.959439175912773*^9}, {3.959766911183103*^9, 3.959766920518694*^9}, {
   3.9597699774693947`*^9, 3.959769977578766*^9}, {3.959772143662767*^9, 
   3.959772153430025*^9}, {3.959772292391592*^9, 3.959772292563431*^9}, {
   3.959778963994385*^9, 3.959778964088098*^9}, {3.9597797490693283`*^9, 
   3.95977974922578*^9}, {3.959782807411774*^9, 3.959782822337366*^9}, 
   3.959858946859276*^9, {3.959859034046728*^9, 3.95985904565686*^9}, {
   3.9598595419313087`*^9, 3.9598595419943676`*^9}, 3.959859667613365*^9, 
   3.959860119124473*^9, 3.959860160062704*^9, 3.959860379073293*^9, 
   3.959860434344105*^9, {3.959864742393513*^9, 3.95986475316502*^9}, {
   3.9598648161125584`*^9, 3.959864826492777*^9}, 3.959874479574703*^9, 
   3.9598751906147757`*^9, 3.959944696202303*^9, 3.95994499736272*^9, 
   3.959945096296371*^9, 3.961859420581175*^9, {3.961859598104494*^9, 
   3.961859617880237*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a4d038fd-06d6-2349-8d68-8750581ca34d"],

Cell[BoxData[
 RowBox[{"2", "*", 
  RowBox[{
   RowBox[{"ps", "[", 
    RowBox[{"[", "activepos", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{3.9598744867961903`*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"1950fbdb-c797-594f-9d9e-20c20f29ba5b"],

Cell[BoxData[
 RowBox[{"binsize", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"ps", "[", 
       RowBox[{"[", "activepos", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", "1"}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.959790812830778*^9, 3.9597908275131226`*^9}, {
   3.9598585890148954`*^9, 3.9598586589739723`*^9}, {3.959858956881563*^9, 
   3.959858971021023*^9}, 3.9598602650763474`*^9, {3.959860296728548*^9, 
   3.9598602977907467`*^9}, {3.95987449893375*^9, 3.9598745008028774`*^9}, {
   3.959944833570097*^9, 3.959944834166929*^9}, {3.961859640921517*^9, 
   3.961859677082314*^9}},ExpressionUUID->"19255f0d-5e0b-aa42-b9b7-\
8c9bd5dba013"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newfiltwidthdata", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"scaleFunc", "[", 
       RowBox[{
        RowBox[{"sscref", "[", 
         RowBox[{"[", 
          RowBox[{"activepos", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"ps", "[", 
         RowBox[{"[", 
          RowBox[{"activepos", ",", "2"}], "]"}], "]"}], ",", "multbytwo"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"sscref", "[", 
          RowBox[{"[", "activepos", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "newfiltwidthdata", "]"}]}], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.9485586774802437`*^9, 3.948558679115135*^9}, {
   3.948558718019699*^9, 3.9485587190810566`*^9}, {3.9485588145318108`*^9, 
   3.9485588198825836`*^9}, {3.948559426513094*^9, 3.9485594441320305`*^9}, 
   3.948559703580714*^9, {3.958139631468052*^9, 3.958139646484545*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"821efc72-4618-0940-b1d7-f252532ef8e7"],

Cell[BoxData[
 RowBox[{"hist1", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{"(*", 
    RowBox[{"groupAfterMax", "[", 
     RowBox[{"newfiltwidthdata", ",", "3000"}], "]"}], "*)"}], 
   RowBox[{"(*", "img18", "*)"}], 
   RowBox[{"(*", "img10", "*)"}], 
   RowBox[{"(*", "img91013comb", "*)"}], 
   RowBox[{
    RowBox[{"groupAfterMax", "[", 
     RowBox[{
      RowBox[{"img1c2c3ccomb", "*", "1000"}], ",", "3000"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "3100", ",", 
      RowBox[{"(*", "binsize", "*)"}], "50"}], "}"}], ",", 
    "\"\<Probability\>\"", ",", 
    RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "3100"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Width (nm)\>\"", 
         RowBox[{"(*", "\"\<Width (\[Mu]m)\>\"", "*)"}], 
         RowBox[{"(*", "\"\<Width (pix)\>\"", "*)"}], ",", "24", ",", "Black",
          ",", "Bold"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Probability\>\"", ",", "24", ",", "Black", ",", "Bold"}],
         "]"}]}], "}"}]}], ",", 
    RowBox[{"ChartLayout", "\[Rule]", "\"\<Overlapped\>\""}], ",", 
    RowBox[{"ChartStyle", "->", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"12", "/", "255"}], ",", 
       RowBox[{"123", "/", "255"}], ",", 
       RowBox[{"220", "/", "255"}]}], "]"}]}], ",", 
    RowBox[{"LabelingFunction", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"22", ",", "Black"}], "]"}]}], ",", 
    RowBox[{"Background", "->", "White"}], ",", 
    RowBox[{"FrameTicks", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"GridLines", "->", 
     RowBox[{"(*", "Automatic", "*)"}], "None"}], 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"50", ",", "White"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"150", ",", "White"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".1", ",", "White"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Black", ",", "Thick"}], "]"}]}], "}"}]}], 
        "}"}]}], "}"}], "*)"}], ",", 
    RowBox[{"GridLinesStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.948558588664205*^9, 3.948558592167168*^9}, 
   3.9485586320854607`*^9, {3.9485587270060635`*^9, 3.948558779186985*^9}, {
   3.948559469213268*^9, 3.948559481554434*^9}, {3.9485597082483406`*^9, 
   3.9485597363218536`*^9}, {3.9485597708292694`*^9, 3.948559781661698*^9}, {
   3.948559825525017*^9, 3.948559831838337*^9}, {3.94888351547896*^9, 
   3.9488835336074657`*^9}, {3.948883586560354*^9, 3.948883588060173*^9}, {
   3.948883620949253*^9, 3.948883660133842*^9}, {3.9488839231968327`*^9, 
   3.948883928206488*^9}, {3.9488841435218925`*^9, 3.948884177080974*^9}, {
   3.948884222746555*^9, 3.948884259871306*^9}, 3.948884300522257*^9, 
   3.94888436513715*^9, 3.948884547785136*^9, {3.948884640326792*^9, 
   3.948884644629404*^9}, {3.9488848209847775`*^9, 3.948884851187441*^9}, {
   3.9488868658591785`*^9, 3.948886877439398*^9}, {3.948886974276901*^9, 
   3.948887004935948*^9}, {3.948887075359972*^9, 3.9488871021268425`*^9}, {
   3.948887134533575*^9, 3.948887138606617*^9}, {3.948888100995189*^9, 
   3.9488881059726467`*^9}, {3.948888145612475*^9, 3.948888157677857*^9}, {
   3.948888295038164*^9, 3.948888324438747*^9}, {3.948889121614549*^9, 
   3.948889129501369*^9}, {3.948891838005213*^9, 3.948891842152876*^9}, {
   3.9488949995229683`*^9, 3.948895004346363*^9}, {3.948973527371058*^9, 
   3.948973536374399*^9}, {3.9494954029140244`*^9, 3.949495461030863*^9}, {
   3.949495621038588*^9, 3.949495626772852*^9}, {3.94949569066414*^9, 
   3.9494957270180664`*^9}, {3.949495798480839*^9, 3.9494958021876354`*^9}, {
   3.9494962100430183`*^9, 3.949496216068165*^9}, {3.949496841217924*^9, 
   3.949496926132447*^9}, {3.949497282244684*^9, 3.949497413470173*^9}, {
   3.950619264585785*^9, 3.950619317226984*^9}, {3.950619348596954*^9, 
   3.950619384023824*^9}, {3.9506202151361065`*^9, 3.950620222552138*^9}, {
   3.950620422360071*^9, 3.950620429571878*^9}, {3.950620461525793*^9, 
   3.9506204927053413`*^9}, {3.9506206934327564`*^9, 
   3.9506206966842537`*^9}, {3.9506207965247493`*^9, 3.950620813709139*^9}, {
   3.9506217134515495`*^9, 3.950621717031437*^9}, {3.9506219199383163`*^9, 
   3.950621935303375*^9}, 3.950701053519188*^9, 3.9507012116281986`*^9, {
   3.9518215702906685`*^9, 3.9518216956389027`*^9}, {3.951821828432638*^9, 
   3.951821862563135*^9}, {3.9518219596118107`*^9, 3.951821982468288*^9}, {
   3.951822031963928*^9, 3.9518220823141117`*^9}, {3.951822138775261*^9, 
   3.951822139199404*^9}, {3.95182217760894*^9, 3.9518222086152687`*^9}, {
   3.951822245796606*^9, 3.951822281620867*^9}, {3.951822538873798*^9, 
   3.9518225647502728`*^9}, {3.951822720160803*^9, 3.951822731987255*^9}, {
   3.952427171907315*^9, 3.952427210567934*^9}, {3.952427273761116*^9, 
   3.9524273410035343`*^9}, {3.952432246209797*^9, 3.952432247705385*^9}, {
   3.952432280235351*^9, 3.952432280769523*^9}, 3.952435226169767*^9, {
   3.952435257883753*^9, 3.952435258056772*^9}, {3.952441928200699*^9, 
   3.952441941473486*^9}, {3.952442070171158*^9, 3.952442070610508*^9}, 
   3.952442260701143*^9, 3.952515390832519*^9, {3.953221330893188*^9, 
   3.9532213362807007`*^9}, {3.953221630598137*^9, 3.953221648075596*^9}, {
   3.953222257812659*^9, 3.953222268569655*^9}, {3.9532223056138263`*^9, 
   3.953222353289722*^9}, {3.9532224968363285`*^9, 3.9532224972759304`*^9}, {
   3.9578655698853283`*^9, 3.957865639278374*^9}, {3.95786568902671*^9, 
   3.957865711520672*^9}, {3.957879732225046*^9, 3.957879759455591*^9}, {
   3.95787980436413*^9, 3.95787981589114*^9}, {3.9579651403035526`*^9, 
   3.9579651407276745`*^9}, 3.9579651957710037`*^9, {3.9581310230188713`*^9, 
   3.958131091940567*^9}, {3.958131123989002*^9, 3.958131183696177*^9}, 
   3.9581312165642204`*^9, {3.9581319070732594`*^9, 3.958131910904188*^9}, {
   3.958137909878298*^9, 3.958137914544071*^9}, {3.958137962262089*^9, 
   3.958137967210008*^9}, {3.95813803928183*^9, 3.958138063603088*^9}, {
   3.958138338517456*^9, 3.9581383451235485`*^9}, {3.958139054230915*^9, 
   3.958139058580927*^9}, {3.958647257812563*^9, 3.958647285728048*^9}, {
   3.958647326141182*^9, 3.9586473467544613`*^9}, {3.958647472829672*^9, 
   3.958647486716337*^9}, {3.958647557502369*^9, 3.958647574172146*^9}, {
   3.958649605790191*^9, 3.958649614475399*^9}, {3.958654524408594*^9, 
   3.9586545662567997`*^9}, {3.95865460927865*^9, 3.958654655727043*^9}, {
   3.9586548590925465`*^9, 3.958654865124449*^9}, {3.958654961996563*^9, 
   3.958654963975925*^9}, {3.958654999244407*^9, 3.958655007617834*^9}, {
   3.958655049896745*^9, 3.9586551130688*^9}, {3.958655156582508*^9, 
   3.958655163896867*^9}, {3.9586553521920376`*^9, 3.95865537969923*^9}, {
   3.958655490887603*^9, 3.958655491201294*^9}, {3.9586555478139553`*^9, 
   3.958655587871853*^9}, {3.9586557543039265`*^9, 3.958655795914589*^9}, 
   3.958655879511505*^9, {3.958655917496548*^9, 3.958655966933348*^9}, {
   3.958656077755405*^9, 3.958656082431963*^9}, 3.9586561598009987`*^9, {
   3.958735964058159*^9, 3.9587359952283783`*^9}, {3.958736422635721*^9, 
   3.958736489039244*^9}, {3.958736576501028*^9, 3.958736611748677*^9}, 
   3.958736651606873*^9, {3.958739761048708*^9, 3.958739761127407*^9}, {
   3.9590738297129593`*^9, 3.959073847510474*^9}, {3.959074633115286*^9, 
   3.959074650413908*^9}, {3.959074695760351*^9, 3.959074719326576*^9}, {
   3.9590748389800873`*^9, 3.959074839498621*^9}, 3.95907488417452*^9, {
   3.9590909793305187`*^9, 3.959091019117308*^9}, {3.9594386044676533`*^9, 
   3.95943862747994*^9}, {3.959438815189823*^9, 3.959438825401794*^9}, {
   3.959439109398622*^9, 3.959439144201277*^9}, {3.959766944011997*^9, 
   3.959766948631907*^9}, {3.9597669814027863`*^9, 3.959767018107291*^9}, {
   3.959767325619137*^9, 3.959767326118988*^9}, {3.959767772361012*^9, 
   3.959767806373525*^9}, {3.95977002368728*^9, 3.959770088223334*^9}, {
   3.959772187050729*^9, 3.959772204217865*^9}, {3.959772304570881*^9, 
   3.9597723577612743`*^9}, {3.959772492288872*^9, 3.959772494741426*^9}, {
   3.959778971195604*^9, 3.95977902858786*^9}, {3.9597791631273575`*^9, 
   3.9597791778285007`*^9}, {3.959779347653374*^9, 3.959779356979261*^9}, {
   3.959779453774878*^9, 3.9597794574615192`*^9}, {3.959779777170412*^9, 
   3.959779799040245*^9}, {3.959779847124995*^9, 3.959779878515253*^9}, {
   3.959780014526924*^9, 3.959780017869894*^9}, 3.95978033497414*^9, {
   3.959780376278085*^9, 3.9597804032809143`*^9}, {3.959782840490969*^9, 
   3.95978284504261*^9}, {3.959858689673834*^9, 3.959858738026455*^9}, {
   3.959858770282488*^9, 3.959858781012762*^9}, {3.959858822552843*^9, 
   3.9598588674522343`*^9}, {3.959858984922819*^9, 3.9598590038128386`*^9}, {
   3.959859146427532*^9, 3.959859148092703*^9}, {3.959863813695474*^9, 
   3.959863813983232*^9}, {3.9598648560634937`*^9, 3.959864871595707*^9}, {
   3.959874507539627*^9, 3.959874537306581*^9}, {3.959874683806667*^9, 
   3.959874687988497*^9}, {3.959874775693178*^9, 3.959874777766567*^9}, {
   3.9599448001859684`*^9, 3.9599448156831627`*^9}, {3.959944860105994*^9, 
   3.9599448602158585`*^9}, {3.959944890257475*^9, 3.959944894073559*^9}, {
   3.959944929094194*^9, 3.959944942490848*^9}, {3.959945030212713*^9, 
   3.959945069480604*^9}, {3.95994510765212*^9, 3.959945117000168*^9}, {
   3.959945321880218*^9, 3.959945325219879*^9}, {3.96185927401787*^9, 
   3.961859304884695*^9}, {3.961859344733511*^9, 3.961859352717388*^9}, {
   3.961859681029932*^9, 3.961859706020641*^9}, {3.961859841248844*^9, 
   3.961859845664276*^9}, {3.961859920845295*^9, 3.961859922320902*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"ef5dcc93-ac74-2740-8fd9-88f4e9f1ff97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noorientationcor", "=", "newfiltwidthdata"}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.952427490543936*^9, 3.952427520353349*^9}, {
  3.959767151164774*^9, 3.9597671542663097`*^9}, {3.959767314637347*^9, 
  3.959767315012047*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"f45508de-f7b3-214c-bf85-8382c7cbc3eb"],

Cell[BoxData[
 RowBox[{"hist2", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{"noorientationcor", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "270", ",", "10"}], "}"}], ",", "\"\<Probability\>\"", 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "270"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.3"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ChartLegends", "\[Rule]", "None"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Width (pix)\>\"", ",", "24", ",", "Black", ",", "Bold"}],
         "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Probability\>\"", ",", "24", ",", "Black", ",", "Bold"}],
         "]"}]}], "}"}]}], ",", 
    RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ",", 
    RowBox[{"ChartStyle", "->", 
     RowBox[{"RGBColor", "[", 
      RowBox[{
       RowBox[{"255", "/", "255"}], ",", 
       RowBox[{"194", "/", "255"}], ",", 
       RowBox[{"10", "/", "255"}]}], "]"}]}], ",", 
    RowBox[{"LabelingFunction", "\[Rule]", "None"}], ",", 
    RowBox[{"FrameStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"20", ",", "Black"}], "]"}]}], ",", 
    RowBox[{"Background", "->", "White"}], ",", 
    RowBox[{"FrameTicks", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"GridLines", "->", "None"}], ",", 
    RowBox[{"GridLinesStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}]}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.948558588664205*^9, 3.948558592167168*^9}, 
   3.9485586320854607`*^9, {3.9485587270060635`*^9, 3.948558779186985*^9}, {
   3.948559469213268*^9, 3.948559481554434*^9}, {3.9485597082483406`*^9, 
   3.9485597363218536`*^9}, {3.9485597708292694`*^9, 3.948559781661698*^9}, {
   3.948559825525017*^9, 3.948559831838337*^9}, {3.94888351547896*^9, 
   3.9488835336074657`*^9}, {3.948883586560354*^9, 3.948883588060173*^9}, {
   3.948883620949253*^9, 3.948883660133842*^9}, {3.9488839231968327`*^9, 
   3.948883928206488*^9}, {3.9488841435218925`*^9, 3.948884177080974*^9}, {
   3.948884222746555*^9, 3.948884259871306*^9}, 3.948884300522257*^9, 
   3.94888436513715*^9, 3.948884547785136*^9, {3.948884640326792*^9, 
   3.948884644629404*^9}, {3.9488848209847775`*^9, 3.948884851187441*^9}, {
   3.9488868658591785`*^9, 3.948886877439398*^9}, {3.948886974276901*^9, 
   3.948887004935948*^9}, {3.948887075359972*^9, 3.9488871021268425`*^9}, {
   3.948887134533575*^9, 3.948887138606617*^9}, {3.948888100995189*^9, 
   3.9488881059726467`*^9}, {3.948888145612475*^9, 3.948888157677857*^9}, {
   3.948888295038164*^9, 3.948888324438747*^9}, {3.948889121614549*^9, 
   3.948889129501369*^9}, {3.948891838005213*^9, 3.948891842152876*^9}, {
   3.9488949995229683`*^9, 3.948895004346363*^9}, {3.948973527371058*^9, 
   3.948973536374399*^9}, {3.9494954029140244`*^9, 3.949495461030863*^9}, {
   3.949495621038588*^9, 3.949495626772852*^9}, {3.94949569066414*^9, 
   3.9494957270180664`*^9}, {3.949495798480839*^9, 3.9494958021876354`*^9}, {
   3.9494962100430183`*^9, 3.949496216068165*^9}, {3.949496841217924*^9, 
   3.949496926132447*^9}, {3.949497282244684*^9, 3.949497413470173*^9}, {
   3.950619264585785*^9, 3.950619317226984*^9}, {3.950619348596954*^9, 
   3.950619384023824*^9}, {3.9506202151361065`*^9, 3.950620222552138*^9}, {
   3.950620422360071*^9, 3.950620429571878*^9}, {3.950620461525793*^9, 
   3.9506204927053413`*^9}, {3.9506206934327564`*^9, 
   3.9506206966842537`*^9}, {3.9506207965247493`*^9, 3.950620813709139*^9}, {
   3.9506217134515495`*^9, 3.950621717031437*^9}, {3.9506219199383163`*^9, 
   3.950621935303375*^9}, 3.950701053519188*^9, 3.9507012116281986`*^9, {
   3.9518215702906685`*^9, 3.9518216956389027`*^9}, {3.951821828432638*^9, 
   3.951821862563135*^9}, {3.9518219596118107`*^9, 3.951821982468288*^9}, {
   3.951822031963928*^9, 3.9518220823141117`*^9}, {3.951822138775261*^9, 
   3.951822139199404*^9}, {3.95182217760894*^9, 3.9518222086152687`*^9}, {
   3.951822245796606*^9, 3.951822281620867*^9}, {3.951822538873798*^9, 
   3.9518225647502728`*^9}, {3.951822720160803*^9, 3.951822731987255*^9}, {
   3.952427171907315*^9, 3.952427210567934*^9}, {3.952427273761116*^9, 
   3.9524273410035343`*^9}, {3.952427441381218*^9, 3.952427465453066*^9}, {
   3.952427508644338*^9, 3.9524275320572033`*^9}, {3.952427660693428*^9, 
   3.952427664020782*^9}, {3.952427712197239*^9, 3.952427740184618*^9}, {
   3.952428137172066*^9, 3.9524281554176903`*^9}, {3.952428366313444*^9, 
   3.952428380871162*^9}, {3.952429005267988*^9, 3.9524290053929863`*^9}, {
   3.952429124526611*^9, 3.952429167273186*^9}, {3.952429222872877*^9, 
   3.952429223653949*^9}, {3.952429263361212*^9, 3.952429285418774*^9}, 
   3.9524321172629147`*^9, {3.952432196754553*^9, 3.9524322532239323`*^9}, {
   3.952432345717348*^9, 3.952432355773252*^9}, {3.952441816600916*^9, 
   3.952441910151396*^9}, {3.952442228543703*^9, 3.9524422513529663`*^9}, {
   3.957865666918508*^9, 3.957865667059101*^9}, {3.95786601715488*^9, 
   3.957866017732885*^9}, {3.959767072125084*^9, 3.959767079904711*^9}, {
   3.959767824135002*^9, 3.959767824837939*^9}, {3.9597710679742603`*^9, 
   3.9597710861376457`*^9}, {3.95977242445853*^9, 3.9597724427512913`*^9}, {
   3.959772487743074*^9, 3.959772487836664*^9}, {3.959875205825222*^9, 
   3.959875226549448*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"ddd451ed-b8ae-9045-bdf9-19530247c30d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"hist1", 
   RowBox[{"(*", 
    RowBox[{",", "hist2"}], "*)"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "270"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.3"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"GridLines", "->", 
    RowBox[{"(*", "Automatic", "*)"}], 
    RowBox[{"(*", "None", "*)"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "White"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150", ",", "White"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{".1", ",", "White"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Dashed", ",", "Black", ",", "Thick"}], "]"}]}], "}"}]}], 
       "}"}]}], "}"}]}]}], "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.952432238983103*^9, 3.952432263032343*^9}, {
   3.9524335943319473`*^9, 3.9524335946304398`*^9}, {3.952433690450884*^9, 
   3.952433702963503*^9}, {3.952442050487711*^9, 3.952442051666353*^9}, 
   3.952442425776016*^9, {3.9578660784081097`*^9, 3.957866087327893*^9}, {
   3.957866122840561*^9, 3.957866138417082*^9}, {3.959767130789787*^9, 
   3.9597671420104694`*^9}, 3.959767842302332*^9, 3.959767915965158*^9, {
   3.959772449142185*^9, 3.959772472932352*^9}, {3.959772557662274*^9, 
   3.9597725843518467`*^9}, {3.959874589510937*^9, 3.959874653449789*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"f164f153-d781-8840-adab-ca618cdfc49a"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"newfiltwidthdata", ",", "noorientationcor"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "270", ",", "2"}], "}"}], ",", "\"\<Probability\>\"", 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "270"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.35"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"ChartLegends", "\[Rule]", "None"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Width (pix)\>\"", ",", "24", ",", "Black", ",", "Bold"}], 
       "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Probability\>\"", ",", "24", ",", "Black", ",", "Bold"}], 
       "]"}]}], "}"}]}], ",", 
   RowBox[{"ChartLayout", "\[Rule]", "\"\<Overlapped\>\""}], ",", 
   RowBox[{"FrameStyle", "->", 
    RowBox[{"Directive", "[", 
     RowBox[{"18", ",", "Black"}], "]"}]}], ",", 
   RowBox[{"Background", "->", "White"}], ",", 
   RowBox[{"FrameTicks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"GridLines", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "White"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150", ",", "White"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{".1", ",", "White"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Dashed", ",", "Black", ",", "Thick"}], "]"}]}], "}"}]}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"GridLinesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
   RowBox[{"ChartStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RGBColor", "[", 
       RowBox[{
        RowBox[{"12", "/", "255"}], ",", 
        RowBox[{"123", "/", "255"}], ",", 
        RowBox[{"220", "/", "255"}]}], "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{
        RowBox[{"255", "/", "255"}], ",", 
        RowBox[{"194", "/", "255"}], ",", 
        RowBox[{"10", "/", "255"}]}], "]"}]}], "}"}]}]}], "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.9578661573657303`*^9, 3.957866220967654*^9}, {
  3.9578662702935677`*^9, 3.957866273121029*^9}, {3.957866382938944*^9, 
  3.957866404715*^9}, {3.9578673449301987`*^9, 3.957867345148685*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"d09fd390-a74c-ef47-9b6f-6e003f1fb6dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["KMeans width data clustering", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.940693767445145*^9, 3.940693792326351*^9}, {
  3.947934184447043*^9, 3.947934184998556*^9}, {3.947935238982332*^9, 
  3.947935241618422*^9}, {3.956665449597788*^9, 3.956665450430904*^9}, {
  3.957952621061947*^9, 
  3.9579526914379425`*^9}},ExpressionUUID->"4f604324-6237-4146-9749-\
39f96203aa9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"somec", "=", 
   RowBox[{"ClusterClassify", "[", 
    RowBox[{"newfiltwidthdata", ",", "5", ",", 
     RowBox[{"Method", "->", "\"\<KMeans\>\""}]}], "]"}]}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.957951840275673*^9, 3.957951847659258*^9}, {
  3.957951907974451*^9, 3.9579519084674406`*^9}, {3.957952466960169*^9, 
  3.957952481004837*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"c02929c8-ccc2-3a42-9413-33fa9da46d34"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Values", "[", 
    RowBox[{"somec", "[", 
     RowBox[{"x", ",", " ", "\"\<Probabilities\>\""}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "70"}], "}"}]}], "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.957952020339782*^9, 3.957952031233076*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"f0f56ee0-9d8b-a149-89d9-25f215d875b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cluster", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Pick", "[", 
      RowBox[{"newfiltwidthdata", ",", 
       RowBox[{"somec", "[", "newfiltwidthdata", "]"}], ",", "#"}], "]"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", "5", "]"}]}]}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.957952156039215*^9, 3.957952162503738*^9}, {
   3.957952198675339*^9, 3.9579522077298317`*^9}, 3.957952520570467*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"79ec3629-abcf-ec48-a086-e37eb149e17f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"statdat", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], ",", 
          RowBox[{"StandardDeviation", "[", "#", "]"}]}], "}"}], "&"}], ",", 
       "cluster"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ">", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.957952240201372*^9, 3.957952294032593*^9}, {
  3.957952829958391*^9, 3.957952838065157*^9}, {3.957952889771286*^9, 
  3.957952890446813*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"c9b3e1c7-b19e-814a-b35c-e33dee42f0a9"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NumberForm", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "&"}], ",", "statdat", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], ",", 
   RowBox[{"TableHeadings", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Level 1\>\"", ",", "\"\<Level 2\>\"", ",", "\"\<Level 3\>\"", 
        ",", "\"\<Level 4\>\"", ",", "\"\<Level 5\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Mean\>\"", ",", "\"\<Std Dev\>\""}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 Editable->"False",
 Deletable->"False",
 Evaluatable->True,
 CellChangeTimes->{{3.957952840593771*^9, 3.957953015820072*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"e686e985-204f-c643-ae78-7cb57625f63d"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{779.1428571428571, 724.2857142857142},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->{},
SpellingDictionaries->{"CorrectWords"->{"editpf", "deletepf", "deletefe"}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"df928bd8-564a-4119-bd73-e1a47434698c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 573, 11, 51, "Chapter",ExpressionUUID->"dc0cb5e0-0561-47a1-a65e-0ec0dbe5438d",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1178, 37, 330, 7, 41, "Subsection",ExpressionUUID->"979fe95e-392b-401a-ad63-6182fc073d55",
 Evaluatable->False],
Cell[1511, 46, 1041, 20, 46, "CodeText",ExpressionUUID->"096a17d2-fc45-4c7a-a58e-143ced7dba57",
 Evaluatable->False],
Cell[2555, 68, 1056, 22, 36, "Input",ExpressionUUID->"1e07b56f-f136-47c4-9553-e87e17a30aad",
 Evaluatable->True],
Cell[3614, 92, 567, 12, 21, "Input",ExpressionUUID->"a7d911b3-eee9-4b2a-b2b8-948bba775620",
 Evaluatable->True],
Cell[4184, 106, 1025, 23, 36, "Input",ExpressionUUID->"77355e1c-4177-4fb8-8edb-dbe45e11f706",
 Evaluatable->True],
Cell[5212, 131, 930, 21, 36, "Input",ExpressionUUID->"d3bf5f95-66b2-4f95-906b-ce0e209a9d3a",
 Evaluatable->True],
Cell[6145, 154, 2391, 39, 36, "Input",ExpressionUUID->"bbfa2081-a5a0-4abc-87e8-a9da942e85a4",
 Evaluatable->True],
Cell[8539, 195, 1079, 23, 36, "Input",ExpressionUUID->"c4abfedf-58bb-4f4e-90fe-540e1c96c9c4",
 Evaluatable->True],
Cell[9621, 220, 1180, 24, 36, "Input",ExpressionUUID->"d7a60119-7683-4776-bfe0-95edf7cb4710",
 Evaluatable->True],
Cell[10804, 246, 1239, 25, 36, "Input",ExpressionUUID->"00768015-e5be-4e18-b199-f43fb337c557",
 Evaluatable->True],
Cell[12046, 273, 934, 21, 36, "Input",ExpressionUUID->"10968b4b-72c4-45bb-a3b2-7b27f1200796",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[13017, 299, 273, 7, 30, "Subsection",ExpressionUUID->"2d366563-be9f-4a76-937b-02af69147d55",
 Evaluatable->False],
Cell[13293, 308, 891, 20, 36, "Input",ExpressionUUID->"099947f2-56a2-4b8f-a86c-70298459f5a3",
 Evaluatable->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[14233, 334, 417, 9, 44, "Chapter",ExpressionUUID->"349a0422-87d8-4669-af67-e3b5c113851c",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[14675, 347, 535, 10, 50, "Section",ExpressionUUID->"118a075b-95b5-4ff4-9f02-43831627d5fc",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[15235, 361, 264, 7, 41, "Subsection",ExpressionUUID->"68a08422-1e9e-41a5-b721-64c36119badd",
 Evaluatable->False],
Cell[15502, 370, 1605, 32, 50, "Input",ExpressionUUID->"a5217fc8-82b6-5d49-a6e3-3ec899188c26",
 Evaluatable->True],
Cell[17110, 404, 1233, 28, 50, "Input",ExpressionUUID->"aa100876-cc6c-9f46-a113-df5ac0915af7",
 Evaluatable->True],
Cell[18346, 434, 839, 20, 50, "Input",ExpressionUUID->"17cb3541-091d-40f3-8c8f-233cbc26bf68",
 Evaluatable->True],
Cell[19188, 456, 1318, 31, 50, "Input",ExpressionUUID->"1c77c5c6-3007-4c23-8e55-07aee67ae891",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20543, 492, 316, 7, 41, "Subsection",ExpressionUUID->"554d41db-d24a-4968-8010-6368a8616514",
 Evaluatable->False],
Cell[20862, 501, 1880, 36, 79, "Input",ExpressionUUID->"a387ef5a-0ecc-40a1-853a-f3abeb07c77e",
 Evaluatable->True],
Cell[22745, 539, 1477, 33, 50, "Input",ExpressionUUID->"717e3397-69dc-41f5-abb9-c62a96b2c69f",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24259, 577, 380, 8, 41, "Subsection",ExpressionUUID->"68758e8d-4aa2-f144-9dd1-6dd50bf3f890",
 Evaluatable->False],
Cell[24642, 587, 971, 21, 50, "Input",ExpressionUUID->"09baabc2-67d3-4942-8291-8e918260a647",
 Evaluatable->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25662, 614, 572, 11, 50, "Section",ExpressionUUID->"4c86325e-eac6-4adb-a380-7d109927b96a",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[26259, 629, 230, 6, 41, "Subsection",ExpressionUUID->"9957855b-ccb6-d642-b8df-8c287dbab9bf",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[26514, 639, 464, 9, 34, "Subsubsection",ExpressionUUID->"8ae4084f-5e0f-4284-a312-e7e025f2100a",
 Evaluatable->False],
Cell[26981, 650, 1483, 30, 64, "Input",ExpressionUUID->"cb77a62b-281d-454a-a22d-cb71a91dc0e6",
 Evaluatable->True],
Cell[28467, 682, 2049, 48, 107, "Input",ExpressionUUID->"92f77707-bb1f-4716-91d6-8b1c574783f7",
 Evaluatable->True],
Cell[30519, 732, 2770, 60, 150, "Input",ExpressionUUID->"b52d958a-1a69-4f8b-bef3-20db2d9767ad",
 Evaluatable->True],
Cell[33292, 794, 927, 23, 36, "Input",ExpressionUUID->"acf74bdf-4a0a-4ae0-a2b1-171b06633dd9",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34256, 822, 474, 9, 29, "Subsubsection",ExpressionUUID->"0b504989-225c-4ac6-befa-e1bc49f8f573",
 Evaluatable->False],
Cell[34733, 833, 855, 22, 50, "Input",ExpressionUUID->"99c7e7d0-0796-e44b-b33d-28c1b3324093",
 Evaluatable->True],
Cell[35591, 857, 968, 23, 50, "Input",ExpressionUUID->"89766158-a54c-4073-8a7f-ca59906382e0",
 Evaluatable->True],
Cell[36562, 882, 1621, 36, 64, "Input",ExpressionUUID->"4e7973b6-5d88-4433-a639-2944cb9f51e5",
 Evaluatable->True],
Cell[38186, 920, 628, 14, 36, "Input",ExpressionUUID->"08b54d73-968a-4379-bea2-8e8060ea7569",
 Evaluatable->True],
Cell[38817, 936, 1101, 30, 64, "Input",ExpressionUUID->"1b70b825-26b4-4462-a66c-7d483976ad87",
 Evaluatable->True],
Cell[39921, 968, 720, 18, 50, "Input",ExpressionUUID->"ab3fa514-95d1-f94f-85c4-5b689233a5e0",
 Evaluatable->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[40690, 992, 476, 9, 30, "Subsection",ExpressionUUID->"0059ea0b-b1d6-42a3-b0b8-9e366a14585b",
 Evaluatable->False],
Cell[41169, 1003, 2083, 43, 50, "Input",ExpressionUUID->"04281dc9-8286-4a63-b432-9bfa4210b907",
 Evaluatable->True],
Cell[43255, 1048, 2150, 49, 122, "Input",ExpressionUUID->"33d2adf7-771d-4f38-b6e2-93ed445713fc",
 Evaluatable->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45454, 1103, 464, 9, 50, "Section",ExpressionUUID->"7efe87df-513a-42df-9352-e32c8b79665c",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[45943, 1116, 430, 9, 41, "Subsection",ExpressionUUID->"7e89aae6-78de-4e21-83e6-e5aadc4f654f",
 Evaluatable->False],
Cell[46376, 1127, 692, 16, 36, "Input",ExpressionUUID->"0e6d3cde-8944-4646-bd23-bc766b64aac0",
 Evaluatable->True],
Cell[47071, 1145, 3265, 52, 36, "Input",ExpressionUUID->"900318cf-4588-404e-a7d0-6496973e129b",
 Evaluatable->True],
Cell[50339, 1199, 917, 23, 36, "Input",ExpressionUUID->"7976bc06-c066-4aa5-8031-9c44b96e65cc",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51293, 1227, 602, 11, 30, "Subsection",ExpressionUUID->"730c8676-b1a6-48ce-9259-bb7bed4d0a66",
 Evaluatable->False],
Cell[51898, 1240, 1677, 36, 50, "Input",ExpressionUUID->"a2ae9755-0987-4b9d-92ed-f4eb2d974b68",
 Evaluatable->True],
Cell[53578, 1278, 1080, 23, 50, "Input",ExpressionUUID->"bd29f37f-9eec-4dfd-89a3-15570cd4129a",
 Evaluatable->True],
Cell[54661, 1303, 876, 24, 36, "Input",ExpressionUUID->"4ffd22e6-75e9-45da-912b-e8cad304a2db",
 Evaluatable->True],
Cell[55540, 1329, 1094, 25, 36, "Input",ExpressionUUID->"1a334ecd-4754-4c2d-8112-0ad397d24ba7",
 Evaluatable->True],
Cell[56637, 1356, 1330, 31, 50, "Input",ExpressionUUID->"c86ab03d-63f4-4c7d-b110-ebd50d9327c0",
 Evaluatable->True],
Cell[57970, 1389, 1125, 25, 64, "Input",ExpressionUUID->"48b76459-be0c-4bb2-8d38-012567371d9c",
 Evaluatable->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59144, 1420, 510, 10, 50, "Section",ExpressionUUID->"39a6f08f-b696-4801-9e78-5f806d82826c",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[59679, 1434, 623, 11, 41, "Subsection",ExpressionUUID->"4e293170-c74c-4437-b777-a969c3380949",
 Evaluatable->False],
Cell[60305, 1447, 2904, 70, 136, "Input",ExpressionUUID->"b44fcdae-3148-4e2a-bf64-1ffaee3913e5",
 Evaluatable->True],
Cell[63212, 1519, 1602, 33, 50, "Input",ExpressionUUID->"6d566ee8-3a28-48c7-9ca8-1d46df93e1ca",
 Evaluatable->True],
Cell[64817, 1554, 2261, 58, 107, "Input",ExpressionUUID->"a4c968f3-ea03-438e-a04b-4cf567fa8af7",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67115, 1617, 464, 9, 30, "Subsection",ExpressionUUID->"ce1f6c96-680e-433b-8ef7-880ee1c3d06e",
 Evaluatable->False],
Cell[67582, 1628, 4690, 77, 50, "Input",ExpressionUUID->"26ad9a66-e328-4a44-8136-526e8b9d6c86",
 Evaluatable->True],
Cell[72275, 1707, 1648, 34, 79, "Input",ExpressionUUID->"e005b87d-e5a4-4eef-adb9-a423a68d6afd",
 Evaluatable->True],
Cell[73926, 1743, 2116, 46, 64, "Input",ExpressionUUID->"80294806-d443-47d6-8e89-649902ca67a7",
 Evaluatable->True],
Cell[76045, 1791, 6042, 117, 164, "Input",ExpressionUUID->"c6002521-9c09-4ecc-b151-25eabb3fa472",
 Evaluatable->True],
Cell[82090, 1910, 1758, 41, 50, "Input",ExpressionUUID->"9c998887-2c9e-4ad6-a9b9-e0376a5b3994",
 Evaluatable->True],
Cell[83851, 1953, 5187, 78, 50, "Input",ExpressionUUID->"b8cae8ed-6a49-4387-964b-dcb1e43dc0a5",
 Evaluatable->True],
Cell[89041, 2033, 2187, 38, 36, "Input",ExpressionUUID->"418642e8-5f91-42aa-aa42-094d69a5981f",
 Evaluatable->True],
Cell[91231, 2073, 1919, 34, 50, "Input",ExpressionUUID->"9aba0a13-ae74-418e-8d53-d569a6236937",
 Evaluatable->True],
Cell[93153, 2109, 2848, 48, 36, "Input",ExpressionUUID->"75e7fbdf-ef73-4b73-864c-a6091a638ec8",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[96038, 2162, 473, 9, 30, "Subsection",ExpressionUUID->"55ea0c78-5dcb-4250-a2f2-2677b8a2de94",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[96536, 2175, 813, 14, 34, "Subsubsection",ExpressionUUID->"9bc21eef-1481-c84b-9291-15a8247b8b94",
 Evaluatable->False],
Cell[97352, 2191, 1129, 29, 64, "Input",ExpressionUUID->"2322925a-862f-3749-a26e-a1f35a4c0bd1",
 Evaluatable->True],
Cell[98484, 2222, 1370, 31, 50, "Input",ExpressionUUID->"fe029d51-e683-1e40-af27-961e355a68da",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99891, 2258, 764, 13, 34, "Subsubsection",ExpressionUUID->"1601adcf-6825-4289-b902-fdf7bd164aeb",
 Evaluatable->False],
Cell[100658, 2273, 1460, 31, 50, "Input",ExpressionUUID->"0b59c569-8bb9-4e4f-a95d-1afa308a81d7",
 Evaluatable->True],
Cell[102121, 2306, 1307, 31, 50, "Input",ExpressionUUID->"cd682787-b1cd-4f59-a46d-c1a172cb30de",
 Evaluatable->True],
Cell[103431, 2339, 1222, 25, 36, "Input",ExpressionUUID->"8e4d4b53-5e9f-4f57-9a7d-ce1127bf11ab",
 Evaluatable->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104714, 2371, 762, 13, 50, "Section",ExpressionUUID->"bbc88bf2-074c-428b-b140-427493c1b0e7",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[105501, 2388, 731, 13, 41, "Subsection",ExpressionUUID->"380987d7-4d32-4412-8c76-314e5b4731ab",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[106257, 2405, 913, 15, 34, "Subsubsection",ExpressionUUID->"c168dc35-4eae-4d54-9003-9429dcd6e640",
 Evaluatable->False],
Cell[107173, 2422, 1478, 32, 50, "Input",ExpressionUUID->"f9bf53a6-adb3-461f-9dfc-d3ddce267cdd",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[108688, 2459, 974, 16, 34, "Subsubsection",ExpressionUUID->"a07ff4c9-6918-4242-845a-773d4d195f07",
 Evaluatable->False],
Cell[109665, 2477, 1178, 26, 36, "Input",ExpressionUUID->"913bda63-b7f9-45e4-81c7-98fac0fa7748",
 Evaluatable->True],
Cell[110846, 2505, 824, 17, 36, "Input",ExpressionUUID->"a563eb09-2074-452b-afdd-7c4f0e4f03fa",
 Evaluatable->True],
Cell[111673, 2524, 876, 17, 36, "Input",ExpressionUUID->"f21d1510-a026-0f48-8c82-3d2b030043b7",
 Evaluatable->True],
Cell[112552, 2543, 1621, 31, 36, "Input",ExpressionUUID->"ba8b33cd-c22a-4ae0-8804-466b341094d9",
 Evaluatable->True],
Cell[114176, 2576, 1053, 25, 36, "Input",ExpressionUUID->"2c69bbff-106e-4f9a-8b5d-cf33898a6f7f",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[115266, 2606, 1064, 17, 34, "Subsubsection",ExpressionUUID->"7eda79ae-b59d-5346-901d-a36559608c70",
 Evaluatable->False],
Cell[116333, 2625, 1669, 47, 64, "Input",ExpressionUUID->"1d814d86-49ed-4548-a631-911b9cba141d",
 Evaluatable->True],
Cell[118005, 2674, 816, 23, 36, "Input",ExpressionUUID->"8dd6a3f5-0184-5c49-8620-01c2bcc15216",
 Evaluatable->True],
Cell[118824, 2699, 1872, 46, 64, "Input",ExpressionUUID->"8eb6b5bc-8aaa-4242-a4b8-2195d4bf4707",
 Evaluatable->True],
Cell[120699, 2747, 851, 24, 36, "Input",ExpressionUUID->"7d65dd1a-9453-d54a-8735-7afbe14d60fb",
 Evaluatable->True],
Cell[121553, 2773, 1264, 27, 36, "Input",ExpressionUUID->"398141b9-aec7-4247-80c6-66bcd6af0811",
 Evaluatable->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122866, 2806, 636, 11, 41, "Subsection",ExpressionUUID->"a2dd3c62-c5cc-42cc-a891-f04e783c80cb",
 Evaluatable->False],
Cell[123505, 2819, 1039, 26, 36, "Input",ExpressionUUID->"94ded1e6-93fb-6d46-9b54-fd18a349ffbd",
 Evaluatable->True],
Cell[124547, 2847, 1002, 25, 50, "Input",ExpressionUUID->"b6d2c2f8-55de-3644-bd64-5eea6d3864dc",
 Evaluatable->True],
Cell[125552, 2874, 1821, 36, 79, "Input",ExpressionUUID->"88cebe56-8dae-419d-b4cb-969edc3fd2f0",
 Evaluatable->True],
Cell[127376, 2912, 1112, 24, 36, "Input",ExpressionUUID->"fd457f27-ec31-4a43-9792-be7e9ce76475",
 Evaluatable->True],
Cell[128491, 2938, 1503, 32, 50, "Input",ExpressionUUID->"e78803fc-f5ce-4b75-9acd-240d8108c870",
 Evaluatable->True],
Cell[129997, 2972, 1681, 39, 64, "Input",ExpressionUUID->"1934b44c-954e-6d47-82e5-804a7f697b9e",
 Evaluatable->True],
Cell[131681, 3013, 1724, 42, 50, "Input",ExpressionUUID->"59aff3e9-ff3d-4b6e-8e8d-90a04f9747ff",
 Evaluatable->True],
Cell[133408, 3057, 1399, 37, 50, "Input",ExpressionUUID->"74c9906d-995a-5548-acd1-cc81a2cdc9e3",
 Evaluatable->True],
Cell[134810, 3096, 2202, 52, 64, "Input",ExpressionUUID->"46026dd1-8032-40f4-ac6d-4b64d3836220",
 Evaluatable->True],
Cell[137015, 3150, 1601, 36, 64, "Input",ExpressionUUID->"6ac8cd99-ff7b-4646-b509-72aebbdec136",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[138653, 3191, 465, 9, 41, "Subsection",ExpressionUUID->"c820d95f-23d3-4783-b193-3f7109cd6c8c",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[139143, 3204, 914, 15, 34, "Subsubsection",ExpressionUUID->"98dc5a80-ca25-5249-9361-de0af84d70b0",
 Evaluatable->False],
Cell[140060, 3221, 4609, 90, 150, "Input",ExpressionUUID->"6819d197-4e36-4982-bd04-41a7afc5253a",
 Evaluatable->True],
Cell[144672, 3313, 2331, 53, 122, "Input",ExpressionUUID->"0bee3e48-7de6-48cb-9d1a-31eb7c7aafb0",
 Evaluatable->True],
Cell[147006, 3368, 2177, 50, 93, "Input",ExpressionUUID->"42029cc9-e7bd-4fa7-ae49-4e6d010759fc",
 Evaluatable->True],
Cell[149186, 3420, 1682, 40, 79, "Input",ExpressionUUID->"16826b98-1ddd-4440-9b1e-fe7450ee171c",
 Evaluatable->True],
Cell[150871, 3462, 1007, 24, 50, "Input",ExpressionUUID->"f803a1cb-42e7-4fab-ba81-52a278de5d37",
 Evaluatable->True],
Cell[151881, 3488, 986, 24, 50, "Input",ExpressionUUID->"ee1d4192-17f9-4d13-9807-4cc05fe4c06f",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[152904, 3517, 918, 15, 29, "Subsubsection",ExpressionUUID->"e06c0289-2fd8-f645-a95a-4c6520470662",
 Evaluatable->False],
Cell[153825, 3534, 2721, 66, 79, "Input",ExpressionUUID->"e65ab87a-840e-48eb-8525-0984d956ee53",
 Evaluatable->True],
Cell[156549, 3602, 1975, 47, 64, "Input",ExpressionUUID->"369010e1-534e-4224-ad79-f41857fa032d",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158561, 3654, 972, 16, 29, "Subsubsection",ExpressionUUID->"91c5f731-18da-804d-9ae8-2bb0c34f9743",
 Evaluatable->False],
Cell[159536, 3672, 2536, 54, 122, "Input",ExpressionUUID->"c6704fc9-a50c-44dd-bc43-cabaea87b90f",
 Evaluatable->True],
Cell[162075, 3728, 1683, 42, 93, "Input",ExpressionUUID->"98513967-e61f-413f-8af2-d0bd9533bddf",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163795, 3775, 961, 16, 29, "Subsubsection",ExpressionUUID->"8540be5a-bc87-0e45-92cf-993644db6ee9",
 Evaluatable->False],
Cell[164759, 3793, 2911, 59, 93, "Input",ExpressionUUID->"2584a57f-f3b6-f842-8b19-c14c4bb79962",
 Evaluatable->True],
Cell[167673, 3854, 949, 24, 50, "Input",ExpressionUUID->"5356e8a8-9823-9c4c-a81e-20512a6ee00f",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[168659, 3883, 957, 16, 34, "Subsubsection",ExpressionUUID->"ba2027d8-858b-6545-8417-8520ddf9acb9",
 Evaluatable->False],
Cell[169619, 3901, 3183, 63, 79, "Input",ExpressionUUID->"80740dab-1a64-cb41-b2d3-0cf97ef1a046",
 Evaluatable->True],
Cell[172805, 3966, 963, 25, 50, "Input",ExpressionUUID->"74b6794d-763a-644b-9835-74aef9212be1",
 Evaluatable->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173829, 3998, 662, 12, 50, "Section",ExpressionUUID->"b5d98911-e68c-48d4-9af5-9638d53a9315",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[174516, 4014, 826, 14, 41, "Subsection",ExpressionUUID->"e0546cdd-577e-48f8-9a42-27c1755e588a",
 Evaluatable->False],
Cell[175345, 4030, 1462, 38, 50, "Input",ExpressionUUID->"b922374a-f1b3-40d7-a277-bf4ebbdc5c74",
 Evaluatable->True],
Cell[176810, 4070, 1436, 37, 50, "Input",ExpressionUUID->"c9ece1f2-178e-de40-8d41-fb2954b766f6",
 Evaluatable->True],
Cell[178249, 4109, 1680, 41, 36, "Input",ExpressionUUID->"07af755a-2fd1-4b14-8524-f1570b9dda48",
 Evaluatable->True],
Cell[179932, 4152, 1912, 44, 50, "Input",ExpressionUUID->"5ac906fe-c6fa-4217-a15d-90dda18d43e9",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[181881, 4201, 952, 16, 41, "Subsection",ExpressionUUID->"8236c1eb-4cb2-5c44-8c0f-7e5a96d7152e",
 Evaluatable->False],
Cell[182836, 4219, 2256, 52, 164, "Input",ExpressionUUID->"1514a7c9-9f23-8944-8356-375beb0fb60e",
 Evaluatable->True],
Cell[185095, 4273, 1031, 27, 36, "Input",ExpressionUUID->"3cffc58a-a72c-d444-90ca-2056ee6a9e9a",
 Evaluatable->True],
Cell[186129, 4302, 1227, 27, 36, "Input",ExpressionUUID->"c889680c-178d-044c-ac9a-cfdab5a492ce",
 Evaluatable->True],
Cell[187359, 4331, 1246, 25, 36, "Input",ExpressionUUID->"a6e4d162-7c04-8f42-912e-8506a6c726d4",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[188642, 4361, 450, 9, 41, "Subsection",ExpressionUUID->"818beb9f-16ef-474f-8d44-7b1bb6975638",
 Evaluatable->False],
Cell[189095, 4372, 313, 8, 21, "Input",ExpressionUUID->"862f9379-496d-7143-9ac2-104148467da7",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[189445, 4385, 947, 16, 41, "Subsection",ExpressionUUID->"d339936c-f613-464e-8f5c-b2892f938410",
 Evaluatable->False],
Cell[190395, 4403, 2269, 45, 79, "Input",ExpressionUUID->"e3846004-aef9-1d49-b46c-56b0d0445e19",
 Evaluatable->True],
Cell[192667, 4450, 1976, 42, 64, "Input",ExpressionUUID->"69071d2a-aaae-494b-952d-8720820b13dc",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194680, 4497, 374, 8, 30, "Subsection",ExpressionUUID->"884c686c-6f58-3740-b5c1-e66e3d983763",
 Evaluatable->False],
Cell[195057, 4507, 1218, 28, 79, "Input",ExpressionUUID->"d96e3b86-ba95-0247-9828-de20dff3ead1",
 Evaluatable->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196324, 4541, 368, 8, 50, "Section",ExpressionUUID->"4a024a96-ce67-c94e-a7e9-6d432a15219d",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[196717, 4553, 415, 9, 41, "Subsection",ExpressionUUID->"220e62f1-83d2-7344-a08a-17a9ca702152",
 Evaluatable->False],
Cell[197135, 4564, 805, 20, 21, "Input",ExpressionUUID->"711484cb-6ccb-6e4a-a43d-f819d6e7f258",
 Evaluatable->True],
Cell[197943, 4586, 3220, 49, 21, "Input",ExpressionUUID->"a4d038fd-06d6-2349-8d68-8750581ca34d",
 Evaluatable->True],
Cell[201166, 4637, 352, 11, 21, "Input",ExpressionUUID->"1950fbdb-c797-594f-9d9e-20c20f29ba5b",
 Evaluatable->True],
Cell[201521, 4650, 776, 18, 21, "Input",ExpressionUUID->"19255f0d-5e0b-aa42-b9b7-8c9bd5dba013",
 Evaluatable->True],
Cell[202300, 4670, 1179, 30, 50, "Input",ExpressionUUID->"821efc72-4618-0940-b1d7-f252532ef8e7",
 Evaluatable->True],
Cell[203482, 4702, 10589, 185, 122, "Input",ExpressionUUID->"ef5dcc93-ac74-2740-8fd9-88f4e9f1ff97",
 Evaluatable->True],
Cell[214074, 4889, 407, 10, 21, "Input",ExpressionUUID->"f45508de-f7b3-214c-bf85-8382c7cbc3eb",
 Evaluatable->True],
Cell[214484, 4901, 5832, 105, 79, "Input",ExpressionUUID->"ddd451ed-b8ae-9045-bdf9-19530247c30d",
 Evaluatable->True],
Cell[220319, 5008, 1711, 44, 36, "Input",ExpressionUUID->"f164f153-d781-8840-adab-ca618cdfc49a",
 Evaluatable->True],
Cell[222033, 5054, 2876, 79, 93, "Input",ExpressionUUID->"d09fd390-a74c-ef47-9b6f-6e003f1fb6dd",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[224946, 5138, 433, 9, 41, "Subsection",ExpressionUUID->"4f604324-6237-4146-9749-39f96203aa9f",
 Evaluatable->False],
Cell[225382, 5149, 519, 13, 21, "Input",ExpressionUUID->"c02929c8-ccc2-3a42-9413-33fa9da46d34",
 Evaluatable->True],
Cell[225904, 5164, 469, 13, 21, "Input",ExpressionUUID->"f0f56ee0-9d8b-a149-89d9-25f215d875b3",
 Evaluatable->True],
Cell[226376, 5179, 580, 16, 21, "Input",ExpressionUUID->"79ec3629-abcf-ec48-a086-e37eb149e17f",
 Evaluatable->True],
Cell[226959, 5197, 859, 26, 21, "Input",ExpressionUUID->"c9b3e1c7-b19e-814a-b35c-e33dee42f0a9",
 Evaluatable->True],
Cell[227821, 5225, 885, 26, 50, "Input",ExpressionUUID->"e686e985-204f-c643-ae78-7cb57625f63d",
 Evaluatable->True]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

