(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     95381,       1894]
NotebookOptionsPosition[     89564,       1765]
NotebookOutlinePosition[     90194,       1785]
CellTagsIndexPosition[     90151,       1782]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization cells", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
  3.772537870066352*^9, 3.772537870831804*^9}, {3.772540454800994*^9, 
  3.772540458456403*^9}},ExpressionUUID->"d0951302-093e-4165-9590-\
bc2f54da5802"],

Cell["\<\
To open or close all sub tabs at the same time first use Ctrl+A to select all \
cells then use Ctrl+Shift+] to close all or Ctrl+Shift+[ to open all cells. \
Alternatively double clicking on the rightmost corner of a section opens or \
closes it.\
\>", "CodeText",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.829136678792416*^9, 
  3.829136724345496*^9}},ExpressionUUID->"548b9db2-9bb2-4f94-9241-\
4f7d452760db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"First", "@", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<Package files\>\"", ",", 
       RowBox[{"ParentDirectory", "@", 
        RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "multiClassTraining`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "segmentingImages`"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 InitializationCell->True,
 CellChangeTimes->{{3.770724474459798*^9, 3.770724529902997*^9}, {
   3.770987797277863*^9, 3.7709878058837214`*^9}, {3.770987864367957*^9, 
   3.770987864916751*^9}, {3.7709927905767884`*^9, 3.770992797476592*^9}, {
   3.770992896073373*^9, 3.770992899869353*^9}, {3.771001268585929*^9, 
   3.7710012950236197`*^9}, {3.771092755760683*^9, 3.771092762964431*^9}, {
   3.7710927983398843`*^9, 3.7710928016161146`*^9}, {3.771096009594474*^9, 
   3.7710960100945654`*^9}, {3.772215834126259*^9, 3.772215843868675*^9}, {
   3.772414477794369*^9, 3.772414481213222*^9}, {3.7725384296568727`*^9, 
   3.772538447954479*^9}, 3.7725404270262566`*^9, {3.772889140574798*^9, 
   3.772889151542438*^9}, {3.773145873273926*^9, 3.7731458931305733`*^9}, 
   3.773418505234575*^9, 3.785603196147904*^9, 3.830011773791357*^9, 
   3.8329278124564075`*^9, {3.933072284317564*^9, 3.933072285283235*^9}, 
   3.964708200768961*^9, {3.9647082530497513`*^9, 3.9647082917150345`*^9}, 
   3.9647086997483273`*^9, {3.96470893355076*^9, 3.964708934493252*^9}, {
   3.967730321653499*^9, 3.967730324280489*^9}, {3.968327233133435*^9, 
   3.9683272365894*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c024023b-5cc4-4534-9dbf-cbd39ae5abf6"],

Cell[CellGroupData[{

Cell["Editing cell properties", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.772886678242123*^9, 3.772886691536046*^9}, {
   3.7728868395831523`*^9, 3.772886839692607*^9}, 
   3.948372647498104*^9},ExpressionUUID->"a156d7b7-7110-1f4a-9572-\
069455356c86"],

Cell["\<\
Write \[OpenCurlyDoubleQuote]True\[CloseCurlyDoubleQuote] in editpf and \
evaluate the cells in this subsection to enable cell editing in this notebook \
otherwise write \[OpenCurlyDoubleQuote]False\[CloseCurlyDoubleQuote]. Write \
\[OpenCurlyDoubleQuote]True\[CloseCurlyDoubleQuote] in deletepf and evaluate \
the cells of this subsection to enable cell deleting in this notebook \
otherwise write \[OpenCurlyDoubleQuote]False\[CloseCurlyDoubleQuote].\
\>", "CodeText",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.829136678792416*^9, 3.829136724345496*^9}, {
  3.891089625686507*^9, 3.8910896553727903`*^9}, {3.891091737168961*^9, 
  3.8910918918753457`*^9}, {3.891091984171587*^9, 3.891092013702079*^9}, {
  3.891092044462976*^9, 3.891092075086072*^9}, {3.891092128292735*^9, 
  3.8910921635774*^9}, {3.948372536939909*^9, 
  3.948372569356695*^9}},ExpressionUUID->"b4e5ccbe-36cb-e94b-921b-\
73db2a51e902"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"editpf", "=", "\"\<False\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deletepf", "=", "\"\<False\>\""}], ";"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.891090164989647*^9, 3.891090182269524*^9}, {
  3.8910903944776545`*^9, 3.891090395421489*^9}, {3.891090904303694*^9, 
  3.8910909072233562`*^9}, {3.8913565070319824`*^9, 3.891356507531885*^9}, {
  3.894033298595342*^9, 3.894033303073445*^9}, {3.896539267632372*^9, 
  3.89653926887862*^9}, {3.896539298930292*^9, 3.8965393001205263`*^9}, {
  3.917966400628339*^9, 3.9179664068269825`*^9}, {3.917966459083278*^9, 
  3.917966463859298*^9}, {3.947860900143186*^9, 3.9478609035709953`*^9}, {
  3.94837250877404*^9, 3.9483725144122562`*^9}, {3.966607316324283*^9, 
  3.9666073217943974`*^9}, {3.9726520307279*^9, 3.972652036442682*^9}, {
  3.974812940843422*^9, 3.974812945620264*^9}, {3.9748131224874787`*^9, 
  3.97481312736586*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"57dbccc5-8ba9-1946-b72a-d1d9a528b82b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"multnb", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.772538577538379*^9, 3.7725386199839873`*^9}, {
  3.772561259726162*^9, 3.772561268849103*^9}, {3.772561320736054*^9, 
  3.772561325953581*^9}, {3.830432408422649*^9, 3.830432416905243*^9}, {
  3.8910901180530777`*^9, 3.891090122529446*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"af3d31a0-3be6-dc44-9481-013a7758aaa3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"titlecells", "=", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{
      "multnb", ",", "\"\<Title\>\"", ",", "All", ",", "CellStyle", ",", 
       RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"titlecells", ",", 
      RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
      RowBox[{"Editable", "\[Rule]", "True"}], ",", 
      RowBox[{"Deletable", "\[Rule]", "deletepf"}]}], "]"}], ";"}]}], 
  "*)"}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.8910902656293154`*^9, 3.891090266622034*^9}, {
  3.891090384094948*^9, 3.891090407429324*^9}, {3.891090914562275*^9, 
  3.891090936993514*^9}, {3.896539271353605*^9, 3.89653927284147*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"5e126ec5-022b-9d43-ad78-9ef6fe10f4d6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"chaptercells", "=", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "multnb", ",", "\"\<Chapter\>\"", ",", "All", ",", "CellStyle", ",", 
      RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SetOptions", "[", 
    RowBox[{"chaptercells", ",", 
     RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
     RowBox[{"Editable", "\[Rule]", "editpf"}], ",", 
     RowBox[{"Deletable", "\[Rule]", "deletepf"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.89109042462824*^9, 3.8910904405047717`*^9}, {
   3.891090916757201*^9, 3.8910909396525908`*^9}, 3.97265205076186*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"f0370b97-8db0-e644-8e53-5adb85b1696f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inputcells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{"multnb", ",", "\"\<Input\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"inputcells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "True"}], ",", 
    RowBox[{"Editable", "\[Rule]", "True"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "False"}]}], "]"}], ";"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.771338808327732*^9, 3.771338838774293*^9}, {
   3.771338872744232*^9, 3.771338901557121*^9}, {3.771339034391318*^9, 
   3.771339063783631*^9}, {3.771339096151359*^9, 3.77133911357322*^9}, {
   3.7713391442197604`*^9, 3.771339195676179*^9}, 3.771339390495008*^9, {
   3.771339575119819*^9, 3.77133960170828*^9}, {3.771339739830652*^9, 
   3.771339753379721*^9}, {3.771339783839568*^9, 3.771339793445896*^9}, {
   3.771339833663968*^9, 3.771339946755887*^9}, {3.771340040454396*^9, 
   3.7713400465261693`*^9}, {3.771340259874557*^9, 3.771340271029802*^9}, {
   3.7713410257249985`*^9, 3.771341027165447*^9}, {3.771606733315581*^9, 
   3.771606787720738*^9}, {3.771606856897359*^9, 3.771606858779351*^9}, {
   3.7716072150920186`*^9, 3.771607308401827*^9}, {3.771947641014653*^9, 
   3.771947658952503*^9}, {3.771947728649555*^9, 3.771947738700951*^9}, {
   3.771954299562523*^9, 3.77195430125387*^9}, {3.771954364975469*^9, 
   3.771954381379567*^9}, {3.771954527937702*^9, 3.771954530200677*^9}, {
   3.77195470540431*^9, 3.7719547066070895`*^9}, {3.77195489796051*^9, 
   3.771954915845731*^9}, {3.771955207646293*^9, 3.771955213175476*^9}, {
   3.7719553031320677`*^9, 3.77195541435301*^9}, {3.771955485493906*^9, 
   3.771955507270805*^9}, {3.771955615850394*^9, 3.771955652370714*^9}, {
   3.77195568965801*^9, 3.7719556917224617`*^9}, {3.772538628388029*^9, 
   3.77253862871608*^9}, {3.7725387108370686`*^9, 3.772538722818409*^9}, 
   3.772540335851931*^9, {3.891090205311295*^9, 3.8910902285047684`*^9}, {
   3.894033277753723*^9, 3.894033282614657*^9}, {3.9478621483392277`*^9, 
   3.9478621504093475`*^9}, {3.948372585296067*^9, 3.948372591475584*^9}, {
   3.9748166699423733`*^9, 3.9748166704264946`*^9}, {3.9748167010717354`*^9, 
   3.974816703258463*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"dd34c5be-624c-5944-9236-f923d018f31c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sectioncells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "multnb", ",", "\"\<Section\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"sectioncells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editpf"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletepf"}]}], "]"}], ";"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.77195551243602*^9, 3.771955518776033*^9}, 
   3.771955628221305*^9, 3.7719556973643703`*^9, {3.772538632356098*^9, 
   3.772538632684143*^9}, {3.772538725708537*^9, 3.772538731660059*^9}, {
   3.8910909216294627`*^9, 3.8910909427142878`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"09966caf-ff8b-8041-9cdc-170c1a678623"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subsectioncells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "multnb", ",", "\"\<Subsection\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"subsectioncells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editpf"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletepf"}]}], "]"}], ";"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.771955395965189*^9, 3.771955399206523*^9}, {
   3.771955522226803*^9, 3.771955528625688*^9}, 3.771955632052058*^9, 
   3.771955700198789*^9, {3.772538634372338*^9, 3.772538634641591*^9}, {
   3.7725387345536785`*^9, 3.77253873822447*^9}, {3.772538795105706*^9, 
   3.772538801026188*^9}, {3.891090925484731*^9, 3.891090944909641*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"460333aa-7b19-964c-8b25-6af73e0f052f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"codetextcells", "=", 
   RowBox[{"NotebookFind", "[", 
    RowBox[{
    "multnb", ",", "\"\<CodeText\>\"", ",", "All", ",", "CellStyle", ",", 
     RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"codetextcells", ",", 
    RowBox[{"Evaluatable", "\[Rule]", "False"}], ",", 
    RowBox[{"Editable", "\[Rule]", "editpf"}], ",", 
    RowBox[{"Deletable", "\[Rule]", "deletepf"}]}], "]"}], ";"}]}], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.8910904962749925`*^9, 3.891090510417102*^9}, {
  3.891090928681288*^9, 3.891090947940693*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"3983d1ae-1493-154e-8f25-4e9b16f4685c"]
}, Closed]],

Cell[CellGroupData[{

Cell["History length", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.772886678242123*^9, 3.772886704067807*^9}, 
   3.948372650702435*^9},ExpressionUUID->"1198eff4-a789-a849-bf8b-\
910659197489"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.771339235100431*^9, 3.771339241380398*^9}, 
   3.77133960432326*^9, 3.771947740365743*^9, {3.83034862192086*^9, 
   3.830348622018442*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"80c1bf42-41b2-6f46-a006-83d501f6d05c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Training CNN", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77238491914182*^9, 3.772384938969769*^9}, {
   3.772537870066352*^9, 3.772537870831804*^9}, {3.9646980186521854`*^9, 
   3.964698020130026*^9}, 3.9748157385019875`*^9, {3.974815946353201*^9, 
   3.974815950131628*^9}},ExpressionUUID->"95870ea0-90c7-41e7-b6ee-\
0d52ff1de355"],

Cell[CellGroupData[{

Cell["import paths", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77255766730344*^9, 3.772557668740573*^9}, {
   3.772886753119007*^9, 3.7728867532127304`*^9}, 3.774181383245991*^9, {
   3.775565311634209*^9, 3.775565329442292*^9}, {3.964698089935604*^9, 
   3.9646980907217274`*^9}},ExpressionUUID->"72a62f9c-e1f4-4deb-9a9e-\
067244a56d01"],

Cell["\<\
To add a training data set (list of import directory paths), within a list \
heading {}, first write a new number (starting with 1) followed by an arrow \
(->) (each individual data set is separated by a comma). Example of the \
format to use: {1->  datasetDirectory1, 2->datasetDirectory2 ...}. Go into \
the training sets folder, click the desired dataset and Ctrl+C , then after \
the arrow use Ctrl+V. Mathematica will automatically populate the full file \
directory. Make sure that corresponding images in the target and ground truth \
directories have the same file name. \
\>", "CodeText",
 Editable->False,
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.809942855579148*^9, 3.809942916265359*^9}, 
   3.828622319963457*^9, 3.82871800388466*^9, {3.828718102464576*^9, 
   3.828718107096133*^9}, {3.8287181387364235`*^9, 3.828718175637494*^9}, {
   3.828718217824522*^9, 3.828718284765725*^9}, {3.828803185312713*^9, 
   3.828803400960794*^9}, {3.894020819868078*^9, 3.894020900136644*^9}, {
   3.9647069796583347`*^9, 3.964707039164629*^9}, {3.96470709906987*^9, 
   3.964707178413653*^9}, {3.964707209733334*^9, 3.964707303973654*^9}, {
   3.9647079153868237`*^9, 3.9647079649422016`*^9}, {3.967814984176634*^9, 
   3.967814988199057*^9}, {3.9678179719796906`*^9, 3.967818007755745*^9}, {
   3.967818732554903*^9, 3.9678187753027782`*^9}, {3.968162446594456*^9, 
   3.968162447537499*^9}, {3.968327134452935*^9, 3.968327138904587*^9}, {
   3.9767099723806725`*^9, 3.976709977801506*^9}, 3.976710082833414*^9, {
   3.976710118733116*^9, 3.976710151978897*^9}, {3.976710315552395*^9, 
   3.976710317542717*^9}, {3.976710347692887*^9, 
   3.9767103719785385`*^9}},ExpressionUUID->"4421a024-705a-4b6e-8684-\
60dea2ce5c0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingdatasets", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "1", "->", 
      "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Training sets\\\\CNF NegC SEM (Beaumont)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "2", "->", 
      "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Training sets\\\\CNF NegC SEM (Peter)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "3", "->", 
      "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Training sets\\\\CNF NegC SEM (Udita)\>\""}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.7755635953372617`*^9, 3.7755637194777346`*^9}, {
   3.775563769596447*^9, 3.7755638301068926`*^9}, {3.775563955371151*^9, 
   3.77556400641668*^9}, 3.775564084386574*^9, {3.775564228055045*^9, 
   3.775564284833465*^9}, 3.775564386383106*^9, {3.7755645855508595`*^9, 
   3.775564606467845*^9}, {3.775564953410551*^9, 3.775564962678949*^9}, {
   3.775565300090021*^9, 3.7755653011991487`*^9}, 3.775572737832237*^9, {
   3.775572776385248*^9, 3.775572780550514*^9}, {3.775822587306931*^9, 
   3.77582267668708*^9}, {3.775822707183216*^9, 3.775822956180895*^9}, {
   3.775823051789439*^9, 3.7758230867846355`*^9}, {3.7758233389439545`*^9, 
   3.775823351797414*^9}, {3.775823430419722*^9, 3.775823442081728*^9}, {
   3.7758235394611797`*^9, 3.775823645275834*^9}, {3.775823681958399*^9, 
   3.77582368240195*^9}, {3.775823782337876*^9, 3.775823836277017*^9}, 
   3.775824788545537*^9, {3.775825220435503*^9, 3.775825220565281*^9}, {
   3.775825456260106*^9, 3.775825456789687*^9}, {3.775825585468096*^9, 
   3.775825587567848*^9}, {3.787417485583152*^9, 3.787417486785969*^9}, {
   3.809942164133966*^9, 3.809942197814765*^9}, {3.809942263203045*^9, 
   3.809942270586314*^9}, {3.809942848437511*^9, 3.809942850077265*^9}, {
   3.809943104482419*^9, 3.809943111549638*^9}, {3.809947432544636*^9, 
   3.809947439424927*^9}, {3.8099475970096397`*^9, 3.8099475974007626`*^9}, {
   3.828707803784192*^9, 3.828707807726475*^9}, {3.828707916310345*^9, 
   3.828707926971627*^9}, {3.828713083949373*^9, 3.8287130851262717`*^9}, 
   3.828713120891533*^9, {3.828800678785568*^9, 3.828800695224659*^9}, {
   3.828803127059128*^9, 3.828803189104057*^9}, 3.82921906470514*^9, 
   3.829219149631936*^9, {3.8292193071276674`*^9, 3.829219340029196*^9}, 
   3.8296653595523653`*^9, {3.829665396388726*^9, 3.829665434027511*^9}, {
   3.830430863787653*^9, 3.830430890833148*^9}, {3.863705088118752*^9, 
   3.863705115803604*^9}, {3.863706245863969*^9, 3.86370628650545*^9}, 
   3.863706530949047*^9, {3.889266013164953*^9, 3.88926602789568*^9}, {
   3.889266317888935*^9, 3.889266318793116*^9}, {3.933075673527277*^9, 
   3.933075696006063*^9}, {3.964704869856442*^9, 3.964704910152176*^9}, {
   3.964704991818964*^9, 3.9647050242364407`*^9}, {3.9647050887057266`*^9, 
   3.964705116826233*^9}, {3.964705895122711*^9, 3.9647058996220036`*^9}, {
   3.964705964692856*^9, 3.9647059775890236`*^9}, {3.964706013517597*^9, 
   3.964706064310745*^9}, 3.964706311250494*^9, {3.964709496849718*^9, 
   3.964709515426758*^9}, {3.964797121850605*^9, 3.964797152373394*^9}, 
   3.967814906594338*^9, {3.967815928038088*^9, 3.967815931968847*^9}, {
   3.9678159874761105`*^9, 3.967816023653629*^9}, {3.96816241819046*^9, 
   3.96816243631121*^9}, {3.976641011479957*^9, 3.976641016510063*^9}, {
   3.976709924470737*^9, 3.9767099404200935`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"f58dbd00-519e-45c4-b0f0-b49fe02629c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "If", " ", "the", " ", "ground", " ", "truths", " ", "use", " ", "the", 
    " ", "value", " ", "0", " ", "to", " ", "identify", " ", "a", " ", 
    "class", " ", "it", " ", "needs", " ", "to", " ", "be", " ", "changed", 
    " ", "to", " ", "a", " ", "different", " ", "positive", " ", 
    RowBox[{"integer", ".", " ", "Select"}], " ", "whether", " ", "to", " ", 
    "use", " ", "a", " ", "class", " ", "index", " ", "change", " ", 
    RowBox[{"(", 
     RowBox[{"input", " ", "\"\<yes\>\"", " ", "or", " ", "\"\<no\>\""}], 
     ")"}], " ", "and", " ", "how", " ", "to", " ", "change", " ", 
    RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"classindexchange", "=", "\"\<yes\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newclassindex", "=", 
     RowBox[{"List", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[Rule]", "1"}], ",", 
        RowBox[{"1", "\[Rule]", "2"}]}], "}"}], "]"}]}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.775566045462616*^9, 3.775566059583478*^9}, {
   3.7755663213378057`*^9, 3.7755663645697536`*^9}, 3.775567242746247*^9, {
   3.775567281798199*^9, 3.775567288702572*^9}, {3.775567390742008*^9, 
   3.775567390804705*^9}, 3.775572752762102*^9, {3.775823386308*^9, 
   3.775823390232537*^9}, 3.775823713792017*^9, 3.8098817858631554`*^9, {
   3.809947463739296*^9, 3.809947471197809*^9}, {3.8286229979449267`*^9, 
   3.828622999100904*^9}, {3.828713131638276*^9, 3.828713148228637*^9}, {
   3.863706301049991*^9, 3.8637063197917643`*^9}, {3.964710548314282*^9, 
   3.964710556696638*^9}, {3.964710588558068*^9, 3.964710593998604*^9}, {
   3.968162290511732*^9, 3.968162341675532*^9}, {3.968331539924841*^9, 
   3.968331543022358*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f8af0a3c-4d6e-411d-9459-7fae9b7f443e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Input", " ", "the", " ", "number", " ", "of", " ", "classes", " ", "in", 
    " ", "the", " ", "ground", " ", "truth", " ", 
    RowBox[{"images", ".", " ", "For"}], " ", "binary", " ", "classification",
     " ", "this", " ", "number", " ", "is", " ", "2."}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"numofclasses", "=", "2"}], ";"}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.8303471766056385`*^9, 3.830347177260841*^9}, {
  3.8637063230337067`*^9, 3.863706323078121*^9}, {3.968162350912709*^9, 
  3.9681623599026604`*^9}, {3.9767177067356186`*^9, 
  3.9767177207504272`*^9}},ExpressionUUID->"1783e390-7ac4-4da7-93de-\
6825e5b4ab2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Enter", " ", "color", " ", "rules", " ", "used", " ", "for", " ", 
    "displaying", " ", "ground", " ", "truth", " ", "images", " ", "in", " ", 
    "the", " ", 
    RowBox[{"FrontEnd", ".", " ", "The"}], " ", "colrules", " ", "list", " ", 
    "needs", " ", "to", " ", "be", " ", "as", " ", "long", " ", "as", " ", 
    RowBox[{"numofclasses", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"colrules", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "\[Rule]", "Black"}], ",", 
      RowBox[{"2", "\[Rule]", "Red"}], ",", 
      RowBox[{"3", "\[Rule]", "White"}], ",", 
      RowBox[{"4", "->", "Green"}], ",", 
      RowBox[{"5", "\[Rule]", "Yellow"}]}], "}"}]}], ";"}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 InitializationCell->True,
 CellChangeTimes->{{3.830347092387092*^9, 3.830347092616845*^9}, {
  3.863706503778269*^9, 3.863706512871551*^9}, {3.863707494706035*^9, 
  3.863707495348298*^9}, {3.968162373984104*^9, 3.968162409468849*^9}, {
  3.9767176422268105`*^9, 
  3.976717693113394*^9}},ExpressionUUID->"d8e0c07f-6a89-4f77-bd96-\
5ea9a2eea163"]
}, Open  ]],

Cell[CellGroupData[{

Cell["formatting ground truth images", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.77255766730344*^9, 
  3.772557694546843*^9}},ExpressionUUID->"df0c7e82-ac5b-4dc8-bae0-\
70e2b3799305"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Enter", " ", "the", " ", "number", " ", "of", " ", "image", " ", 
     RowBox[{"partitions", ".", " ", "For"}], " ", "example", " ", 
     "selecting", " ", "n", " ", "equal", " ", "to", " ", "6", " ", "will", 
     " ", "partition", " ", "each", " ", "image", " ", "from", " ", "the", 
     " ", "imported", " ", "dataset", " ", "into", " ", "6", " ", "x", " ", 
     "6", " ", "sub"}], "-", 
    RowBox[{
    "images", " ", "having", " ", "dimensions", " ", "equal", " ", "to", " ", 
     RowBox[{"netinputdim", ".", " ", "The"}], " ", "number", " ", "of", " ", 
     "images", " ", "created", " ", "will", " ", "be", " ", "equal", " ", 
     "to", " ", 
     RowBox[{"Length", "[", "imptdatamod", "]"}], "*", 
     RowBox[{"numofpartition", "^", "2."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"n", "=", "6"}], ";"}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.772541718842366*^9, 3.772541830132207*^9}, {
   3.772541875496538*^9, 3.772541877480254*^9}, {3.7725420399404964`*^9, 
   3.7725420400342183`*^9}, {3.7725420863276253`*^9, 
   3.7725420983344755`*^9}, {3.772544667905479*^9, 3.772544749683923*^9}, {
   3.7728160739193068`*^9, 3.772816078310152*^9}, {3.772819446270815*^9, 
   3.7728194471125016`*^9}, {3.7729823620267644`*^9, 
   3.7729823622810836`*^9}, {3.772984033768828*^9, 3.772984039789727*^9}, {
   3.772984148566006*^9, 3.772984149558354*^9}, {3.772996012064415*^9, 
   3.772996013157193*^9}, {3.772997827959983*^9, 3.772997828927887*^9}, {
   3.773163916685994*^9, 3.773163948416875*^9}, {3.773418588780255*^9, 
   3.77341862505927*^9}, {3.773504158579039*^9, 3.7735041836167192`*^9}, {
   3.774183617137314*^9, 3.774183617389637*^9}, {3.77418374556345*^9, 
   3.774183793887402*^9}, {3.775826026590213*^9, 3.7758260292957363`*^9}, {
   3.775826081889624*^9, 3.775826081962913*^9}, {3.775826417727577*^9, 
   3.775826417914478*^9}, {3.8099475072408543`*^9, 3.8099475127607307`*^9}, {
   3.8099476895149307`*^9, 3.809947706027071*^9}, {3.828623041403471*^9, 
   3.828623041778383*^9}, {3.828623072958563*^9, 3.8286230973903246`*^9}, {
   3.8286231438637867`*^9, 3.828623160969143*^9}, {3.828713273460574*^9, 
   3.828713345124289*^9}, {3.8288015433665085`*^9, 3.82880154346089*^9}, {
   3.8288017297648935`*^9, 3.828801730707821*^9}, {3.829219296664869*^9, 
   3.8292192973521824`*^9}, {3.829665556658098*^9, 3.829665571338222*^9}, {
   3.8296663047662*^9, 3.8296663048427224`*^9}, 3.830430908067447*^9, {
   3.863709330860398*^9, 3.863709350253494*^9}, {3.863876623823309*^9, 
   3.8638766298589573`*^9}, {3.863876855924558*^9, 3.863876855972443*^9}, {
   3.890149101173011*^9, 3.89014910160276*^9}, {3.890149187795432*^9, 
   3.8901491884779215`*^9}, {3.890209498528387*^9, 3.8902095180724*^9}, {
   3.890213422847001*^9, 3.890213424507424*^9}, {3.890213581644956*^9, 
   3.890213582146146*^9}, {3.890217967197368*^9, 3.890217969346987*^9}, {
   3.89021898607118*^9, 3.890218989213793*^9}, {3.8902206081708484`*^9, 
   3.890220609856398*^9}, 3.9330757519288883`*^9, {3.967741328820095*^9, 
   3.9677413435688877`*^9}, 3.9678131293726025`*^9, {3.967818967685534*^9, 
   3.9678189775522213`*^9}, {3.967821303424404*^9, 3.967821340648512*^9}, {
   3.9678214190836983`*^9, 3.967821420468267*^9}, {3.967821734352924*^9, 
   3.967821743064871*^9}, {3.96782199333786*^9, 3.967822000502533*^9}, {
   3.96782208166354*^9, 3.9678220972831383`*^9}, {3.967822740570019*^9, 
   3.967822765851055*^9}, {3.967822881674404*^9, 3.9678228952146263`*^9}, {
   3.967823068155709*^9, 3.967823104066923*^9}, {3.96782320852047*^9, 
   3.967823217857588*^9}, {3.967823295656714*^9, 3.9678233341415405`*^9}, {
   3.96782345064205*^9, 3.96782345784371*^9}, {3.967892872033638*^9, 
   3.967892888020558*^9}, {3.967894551077782*^9, 3.96789455230321*^9}, {
   3.967894588440165*^9, 3.9678946145713806`*^9}, {3.976718174294281*^9, 
   3.9767181745301666`*^9}, 3.9767183861738853`*^9, {3.97671843555768*^9, 
   3.9767184357775745`*^9}, {3.976721860961506*^9, 
   3.9767218721161957`*^9}},ExpressionUUID->"bc9403fb-cb3d-4cf4-b8ed-\
83695299d6e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Input", " ", "a", " ", "number", " ", "selected", " ", "from", " ", "the",
     " ", "allowable", " ", "values", " ", "computed", " ", "in", " ", 
    RowBox[{"inputdims", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"netinputdim", "=", "576"}], ";"}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.967894556251974*^9, 3.96789455788726*^9}, {
  3.967894628932274*^9, 3.9678946880280876`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"d5bbf827-ffbf-3846-b625-bf5d73f5663b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Choose", " ", "whether", " ", "data", " ", "should", " ", "be", " ", 
     "augmented", " ", "by", " ", "using", " ", "image", " ", "reflection"}], 
    ",", 
    RowBox[{
    "this", " ", "multiplies", " ", "the", " ", "number", " ", "of", " ", 
     "training", " ", "images", " ", "by", " ", 
     RowBox[{"five", ".", " ", "Write"}], " ", "either", " ", "\"\<yes\>\"", 
     " ", "or", " ", "\"\<no\>\"", " ", "with", " ", "quotes"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"augmentation", "=", "\"\<yes\>\""}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Select", " ", "whether", " ", "to", " ", "filter", " ", "out", " ", 
     "training", " ", "data", " ", "that", " ", "only", " ", "contains", " ", 
     "1", " ", 
     RowBox[{"class", ".", " ", "Write"}], " ", "either", " ", "\"\<yes\>\"", 
     " ", "or", " ", "\"\<no\>\"", " ", "with", " ", "quotes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"filtering", "=", "\"\<no\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "fraction", " ", "of", " ", "the", " ", "generated", " ", 
      "data", " ", 
      RowBox[{"(", "subimages", ")"}], " ", "to", " ", 
      RowBox[{"use", ".", " ", "For"}], " ", "example", " ", "entering", " ", 
      "1.0", " ", "would", " ", "use", " ", "all", " ", "data", " ", "saved", 
      " ", "in", " ", "subimages"}], ",", 
     RowBox[{
     "while", " ", "0.5", " ", "would", " ", "be", " ", "half", " ", "the", 
      " ", 
      RowBox[{"set", ".", " ", "Permissible"}], " ", "values", " ", "would", 
      " ", "be", " ", "from", " ", "0.01", " ", "to", " ", "1.0"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fraction1", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Portion", " ", "of", " ", "the", " ", "data", " ", 
     RowBox[{"(", 
      RowBox[{"fraction1", "*", "fraction2"}], ")"}], " ", "for", " ", 
     "training", " ", "and", " ", "validating", " ", "the", " ", 
     RowBox[{"network", ".", " ", "The"}], " ", "rest", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"fraction1", "*", "fraction2"}]}], ")"}], " ", "would", " ", 
     "be", " ", "used", " ", "for", " ", "testing", " ", 
     RowBox[{"(", 
      RowBox[{"for", " ", "export", " ", "to", " ", "calculate", " ", "IoU"}],
       ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fraction2", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Splitting", " ", "the", " ", "available", " ", "data", " ", "into", " ",
       "a", " ", "training", " ", "set", " ", "and", " ", "validation", " ", 
      RowBox[{"set", ".", " ", "The"}], " ", "fraction", " ", "of", " ", 
      "data", " ", "to", " ", "use", " ", "for", " ", "training", " ", "is", 
      " ", "calculated", " ", "as", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"fraction1", "*", "fraction2", "*", "fraction3"}], ")"}], ".",
        " ", "In"}], " ", "general", " ", "you", " ", "want", " ", "to", " ", 
      "have", " ", "more", " ", "data", " ", "for", " ", "training", " ", 
      "than", " ", "for", " ", "validating", " ", "so", " ", "fraction3", " ",
       "should", " ", "be", " ", "between", " ", "0.6", " ", "and", " ", 
      "0.95"}], ")"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fraction3", "=", "0.70"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Sets", " ", "pseudorandom", " ", "generator", " ", 
     RowBox[{"seed", ".", " ", "Use"}], " ", "to", " ", "get", " ", "the", 
     " ", "same", " ", "sequence", " ", "of", " ", "random", " ", "numbers"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seednumber", "=", "9999"}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.772542293905898*^9, 3.772542294530763*^9}, {
   3.77257284815531*^9, 3.772572848987838*^9}, {3.7725731324378915`*^9, 
   3.772573132963143*^9}, {3.7725766134871025`*^9, 3.772576614685423*^9}, {
   3.772577695891155*^9, 3.772577696005805*^9}, {3.7725779315617385`*^9, 
   3.772577932877163*^9}, {3.772801123024197*^9, 3.77280112505496*^9}, {
   3.7728012360539494`*^9, 3.772801346164306*^9}, {3.772815475216846*^9, 
   3.7728155153675585`*^9}, {3.772815931168188*^9, 3.772815986318744*^9}, {
   3.7728160673933372`*^9, 3.772816068265364*^9}, {3.772816135908342*^9, 
   3.7728161588582373`*^9}, {3.7728164757518387`*^9, 3.772816493013926*^9}, {
   3.772816529019289*^9, 3.772816530031449*^9}, {3.772984109908335*^9, 
   3.772984135701391*^9}, {3.7729978237248387`*^9, 3.772997824538574*^9}, {
   3.7730596844824095`*^9, 3.773059688130657*^9}, {3.7731460095610046`*^9, 
   3.773146023349125*^9}, {3.773164064867304*^9, 3.773164067120017*^9}, {
   3.773418637911879*^9, 3.773418644811436*^9}, {3.7734188460434666`*^9, 
   3.7734188830515623`*^9}, {3.773419135550516*^9, 3.773419210111181*^9}, {
   3.773419253637816*^9, 3.7734192546630754`*^9}, {3.773420901586537*^9, 
   3.773420969134983*^9}, 3.7734213375799656`*^9, {3.773421420188125*^9, 
   3.773421491553338*^9}, {3.774183802553465*^9, 3.774183802621314*^9}, {
   3.7753094508691235`*^9, 3.775309452210962*^9}, {3.775310505394803*^9, 
   3.7753105112032776`*^9}, {3.775310831965147*^9, 3.775310832088916*^9}, {
   3.775323007797423*^9, 3.775323009109625*^9}, {3.775566020983744*^9, 
   3.775566027029233*^9}, {3.7755670337539883`*^9, 3.775567034628973*^9}, {
   3.77557318024459*^9, 3.7755731876501837`*^9}, {3.775826096964594*^9, 
   3.7758261123426895`*^9}, {3.775826439325939*^9, 3.775826439425883*^9}, 
   3.809881835116657*^9, {3.8098828444317513`*^9, 3.8098828812025957`*^9}, {
   3.8287133574836607`*^9, 3.828713358401882*^9}, {3.828713426913946*^9, 
   3.828713481052697*^9}, {3.828714421392554*^9, 3.828714421706514*^9}, {
   3.82871447545832*^9, 3.828714476137121*^9}, {3.828714867721966*^9, 
   3.82871487162544*^9}, {3.8287178794935055`*^9, 3.828717895026438*^9}, {
   3.8287183428351493`*^9, 3.82871834611524*^9}, {3.8288015521188993`*^9, 
   3.8288015521892395`*^9}, {3.828801640582464*^9, 3.828801641300963*^9}, {
   3.828801720470995*^9, 3.828801720692834*^9}, {3.828810932032174*^9, 
   3.828810932796624*^9}, {3.829153704776543*^9, 3.829153705661637*^9}, {
   3.829219419670339*^9, 3.829219420873178*^9}, {3.829666080564182*^9, 
   3.829666103374996*^9}, {3.829674219046869*^9, 3.829674220187224*^9}, {
   3.830347058559707*^9, 3.830347059777593*^9}, {3.830347121148593*^9, 
   3.830347122008762*^9}, {3.863876803209095*^9, 3.863876841022046*^9}, {
   3.863876901782296*^9, 3.8638769547890973`*^9}, {3.87200029363076*^9, 
   3.872000293995575*^9}, {3.872000330395082*^9, 3.872000382530922*^9}, 
   3.872000415332864*^9, {3.8720004469825907`*^9, 3.872000515784829*^9}, {
   3.872000779359172*^9, 3.87200078040733*^9}, {3.8720008487122097`*^9, 
   3.872000872588874*^9}, {3.872000954525883*^9, 3.872000980373339*^9}, {
   3.872002671108377*^9, 3.872002675003959*^9}, {3.8720032514906435`*^9, 
   3.872003253764902*^9}, {3.8720037256070566`*^9, 3.872003726997387*^9}, {
   3.890214050127041*^9, 3.890214050212676*^9}, {3.8902179781803536`*^9, 
   3.890217980646534*^9}, {3.890220613171678*^9, 3.890220626257081*^9}, {
   3.933075799688801*^9, 3.9330758266653976`*^9}, {3.933075928305813*^9, 
   3.9330759660917797`*^9}, {3.933079287524212*^9, 3.933079290607012*^9}, {
   3.933079904927904*^9, 3.933079909327001*^9}, {3.964797434594049*^9, 
   3.9647974399728622`*^9}, {3.967823419646986*^9, 3.9678234234222126`*^9}, {
   3.967824212743309*^9, 3.967824229290713*^9}, {3.967892936606953*^9, 
   3.967892937691304*^9}, {3.967894081459343*^9, 3.967894087770838*^9}, {
   3.967897249765173*^9, 3.967897252390641*^9}, 3.96790796428537*^9, {
   3.976718102247759*^9, 3.976718103255396*^9}, {3.9767181352362633`*^9, 
   3.9767181408077126`*^9}, {3.9767219107666836`*^9, 3.9767219112227*^9}, {
   3.9767242172139473`*^9, 3.9767242206940346`*^9}, {3.976724293091854*^9, 
   3.976724294161188*^9}, 3.976724326998066*^9, {3.9767244020883064`*^9, 
   3.9767244508048897`*^9}},ExpressionUUID->"7da413f4-cb42-4b43-acfa-\
ef230c5eca65"]
}, Open  ]],

Cell[CellGroupData[{

Cell["network training parameters", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
  3.771006843024737*^9, 3.771006852866175*^9}, {3.7710069277437363`*^9, 
  3.771006935851205*^9}, {3.772886756008751*^9, 
  3.772886756102674*^9}},ExpressionUUID->"813af486-0624-4887-aaab-\
bc68c0008362"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Choose", " ", "to", " ", "train", " ", "a", " ", "new", " ", "network", 
    " ", "or", " ", "to", " ", "import", " ", "and", " ", "continue", " ", 
    "training", " ", "a", " ", "previously", " ", "trained", " ", 
    RowBox[{"network", ".", " ", "Write"}], " ", "\"\<yes\>\"", " ", "if", 
    " ", "you", " ", "want", " ", "to", " ", "import", " ", "a", " ", 
    "previously", " ", "trained", " ", "network", " ", "and", " ", "continue",
     " ", "training", " ", 
    RowBox[{"it", ".", " ", "Write"}], " ", "\"\<no\>\"", " ", "to", " ", 
    "ignore", " ", "this", " ", "and", " ", "train", " ", "a", " ", 
    "completely", " ", "new", " ", "network"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"useprevtrainednet", "=", "\"\<no\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "useprevtrainednet"}], "\[Equal]", 
     RowBox[{
     "\"\<yes\>\"", " ", "copy", " ", "and", " ", "paste", " ", "the", " ", 
      "complete", " ", "path", " ", "to", " ", "the", " ", "trained", " ", 
      "network", " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prevtrainednet", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Maximum", " ", "number", " ", "of", " ", "training", " ", 
     RowBox[{"rounds", ".", " ", "Suggested"}], " ", "values", " ", "are", 
     " ", "between", " ", "5", " ", "and", " ", "200.", " ", "Training", " ", 
     "time", " ", "scales", " ", "with", " ", "the", " ", "amount", " ", "of",
      " ", "training", " ", "data", " ", "and", " ", "number", " ", "of", " ",
      "training", " ", 
     RowBox[{"rounds", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxtrainingrounds", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Training", " ", "batch", " ", "size"}], ",", " ", 
     RowBox[{
     "adjust", " ", "based", " ", "on", " ", "GPU", " ", "available", " ", 
      RowBox[{"memory", ".", " ", "Suggested"}], " ", "values", " ", "are", 
      " ", "between", " ", "1", " ", "and", " ", "10.", " ", "VRAM", " ", 
      "usage", " ", "scales", " ", "with", " ", "the", " ", "training", " ", 
      RowBox[{"batchsize", ".", " ", "If"}], " ", "VRAM", " ", "use", " ", 
      "is", " ", "maxed", " ", "out", " ", "either", " ", "select", " ", "a", 
      " ", "lower", " ", "batchsize", " ", "or", " ", "decrease", " ", "the", 
      " ", "number", " ", "used", " ", "in", " ", 
      RowBox[{"netinputdim", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"batchsize", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Chose", " ", "the", " ", "type", " ", "of", " ", "training", " ", 
      "progress", " ", 
      RowBox[{"report", ".", " ", "Posible"}], " ", "inputs", " ", "are", 
      " ", "\"\<Panel\>\""}], ",", " ", "\"\<Print\>\"", ",", " ", 
     "\"\<ProgressIndicator\>\"", ",", " ", 
     RowBox[{"Function", "[", "]"}], ",", " ", 
     RowBox[{"File", "[", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"None", ".", " ", "Read"}], " ", "the", " ", "documentation", 
      " ", "for", " ", "TrainingProgressReporting", " ", "in", " ", "the", 
      " ", "documentation", " ", "center", " ", "for", " ", "further", " ", 
      RowBox[{"details", ".", " ", "I"}], " ", "was", " ", "having", " ", 
      "issues", " ", "with", " ", "the", " ", "training", " ", "reporting", 
      " ", "so", " ", "I", " ", "set", " ", "it", " ", "to", " ", 
      RowBox[{"None", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"report", "=", "None"}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.77100525783324*^9, 3.771005314752245*^9}, {
   3.771005783473795*^9, 3.771005795533544*^9}, {3.77100611188926*^9, 
   3.7710061120767145`*^9}, {3.77107876484441*^9, 3.771078769074999*^9}, {
   3.771078820534668*^9, 3.7710788924644103`*^9}, {3.771079633804627*^9, 
   3.771079766256952*^9}, {3.771079835230059*^9, 3.771079838400731*^9}, {
   3.771080218792843*^9, 3.771080218858676*^9}, {3.771090228074526*^9, 
   3.771090228333003*^9}, {3.771677213817011*^9, 3.771677214535839*^9}, {
   3.771677549370894*^9, 3.771677550792639*^9}, {3.771679640317485*^9, 
   3.771679640442456*^9}, {3.7718432329125586`*^9, 3.771843249281349*^9}, {
   3.771843331625824*^9, 3.7718434055253677`*^9}, {3.7718522685028553`*^9, 
   3.77185226861199*^9}, {3.771950610783697*^9, 3.771950837097388*^9}, {
   3.771951362411488*^9, 3.771951364091964*^9}, {3.771951444224666*^9, 
   3.7719514466711235`*^9}, {3.771952767555998*^9, 3.7719527701310844`*^9}, {
   3.7719529339609227`*^9, 3.771952937460562*^9}, {3.771952992662919*^9, 
   3.771952996260267*^9}, {3.771953271671646*^9, 3.77195327445619*^9}, {
   3.771953342874194*^9, 3.77195340781553*^9}, {3.772223706135699*^9, 
   3.772223706796325*^9}, {3.772271729173041*^9, 3.772271732427174*^9}, {
   3.772271816638029*^9, 3.7722719552527585`*^9}, {3.772271987067567*^9, 
   3.772272059253287*^9}, {3.772272112549814*^9, 3.7722722658681393`*^9}, {
   3.77227273029737*^9, 3.7722728711738167`*^9}, {3.772272901480479*^9, 
   3.7722729079967313`*^9}, {3.772560038533396*^9, 3.77256003926778*^9}, {
   3.772560145512418*^9, 3.772560154197857*^9}, {3.772561529378642*^9, 
   3.772561531175344*^9}, {3.772573110560793*^9, 3.7725731118717117`*^9}, {
   3.772574363774892*^9, 3.7725743717887397`*^9}, {3.7725768172933235`*^9, 
   3.7725768399659348`*^9}, {3.7728034222652164`*^9, 3.77280351826664*^9}, 
   3.7728199682752934`*^9, {3.772820003427804*^9, 3.772820004636709*^9}, {
   3.772973668627945*^9, 3.7729736722448025`*^9}, {3.772984169670594*^9, 
   3.772984169997718*^9}, {3.772986159519347*^9, 3.772986159628048*^9}, {
   3.7729868775939856`*^9, 3.772986877721641*^9}, {3.7729922237331743`*^9, 
   3.7729922424282036`*^9}, {3.772996119457435*^9, 3.772996129340496*^9}, {
   3.772996396413145*^9, 3.7729964413942213`*^9}, {3.772997844663745*^9, 
   3.772997912562309*^9}, {3.772997943035308*^9, 3.772997960830675*^9}, {
   3.772998651119884*^9, 3.772998657227885*^9}, {3.773002745515422*^9, 
   3.773002758627477*^9}, {3.7730558188040032`*^9, 3.773055818882396*^9}, {
   3.773056903184799*^9, 3.7730569075989985`*^9}, {3.773059647697749*^9, 
   3.7730596610111575`*^9}, {3.77305970479112*^9, 3.773059714787399*^9}, {
   3.773164059868138*^9, 3.773164062890434*^9}, {3.77316445083301*^9, 
   3.773164451011904*^9}, {3.7731681482632847`*^9, 3.773168148366224*^9}, {
   3.773197890855131*^9, 3.773197892410231*^9}, {3.773418940755267*^9, 
   3.7734189554938965`*^9}, {3.773419584876265*^9, 3.773419585002928*^9}, {
   3.77341989339038*^9, 3.773419895407986*^9}, {3.773421625455258*^9, 
   3.7734216280204*^9}, {3.774183918369629*^9, 3.774183935827722*^9}, {
   3.774197620843083*^9, 3.774197629851082*^9}, {3.774197880307083*^9, 
   3.774197880798964*^9}, {3.775310696422325*^9, 3.775310705284668*^9}, {
   3.775572213247652*^9, 3.775572216302*^9}, {3.775574628172763*^9, 
   3.775574630211416*^9}, {3.775826765996185*^9, 3.775826766729319*^9}, {
   3.775827346087975*^9, 3.775827346149009*^9}, {3.7758277397761345`*^9, 
   3.775827739858627*^9}, {3.809881886218901*^9, 3.809881903157626*^9}, {
   3.809883302197158*^9, 3.809883302302329*^9}, {3.809947879047457*^9, 
   3.809947879703533*^9}, {3.809949474539439*^9, 3.809949504905689*^9}, {
   3.828714859737355*^9, 3.828714861289837*^9}, {3.828718352087762*^9, 
   3.828718355329294*^9}, 3.828800870839051*^9, 3.8288009159118767`*^9, {
   3.8291529379165726`*^9, 3.829153062961087*^9}, {3.829153252989507*^9, 
   3.829153253540209*^9}, {3.829153647554379*^9, 3.829153649031892*^9}, {
   3.8292194585125346`*^9, 3.829219459340464*^9}, {3.8292195287494116`*^9, 
   3.8292195413089542`*^9}, {3.8296742003111753`*^9, 3.829674200451783*^9}, {
   3.830351199843297*^9, 3.8303512007267017`*^9}, {3.83035123968974*^9, 
   3.830351244599493*^9}, {3.8637094555277576`*^9, 3.8637094824362154`*^9}, {
   3.863790150872712*^9, 3.863790168417812*^9}, {3.863876993583469*^9, 
   3.863877014078974*^9}, {3.863880506535835*^9, 3.8638805066295614`*^9}, {
   3.864314488631273*^9, 3.864314488709411*^9}, 3.864375603484977*^9, {
   3.872001080749052*^9, 3.872001116125004*^9}, {3.872001899531225*^9, 
   3.8720019003340764`*^9}, {3.889266752375517*^9, 3.889266758935436*^9}, {
   3.889267068397075*^9, 3.889267068844849*^9}, {3.8895253102253494`*^9, 
   3.8895254774988947`*^9}, {3.889525671625616*^9, 3.8895256754927897`*^9}, {
   3.889525851387149*^9, 3.889525852121354*^9}, {3.889718223754559*^9, 
   3.889718227816103*^9}, {3.933075986702494*^9, 3.933076011518863*^9}, {
   3.933079584281868*^9, 3.933079584567339*^9}, 3.933079637507145*^9, 
   3.933079848764757*^9, {3.933083820937731*^9, 3.9330838345123215`*^9}, {
   3.9332658170629444`*^9, 3.933265818113687*^9}, {3.93326614985973*^9, 
   3.933266153108999*^9}, {3.933266834004522*^9, 3.93326683702956*^9}, 
   3.964797507126181*^9, 3.9652123245125103`*^9, 3.965228199567228*^9, {
   3.965306779715325*^9, 3.965306779825341*^9}, 3.965825951304962*^9, {
   3.967824280131787*^9, 3.967824308849613*^9}, {3.967893665454985*^9, 
   3.9678936662260685`*^9}, {3.967894126248436*^9, 3.967894127396908*^9}, {
   3.967907990858848*^9, 3.967907991110239*^9}, 3.9767263393659782`*^9, {
   3.9767263863964405`*^9, 3.97672647309729*^9}, {3.9767265131640644`*^9, 
   3.9767266154036884`*^9}, {3.976726698399151*^9, 
   3.9767267461894875`*^9}},ExpressionUUID->"438d6b16-61c2-4826-a058-\
ce9b852b268e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["export paths", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
  3.771006843024737*^9, 3.771006852866175*^9}, {3.771006944964633*^9, 
  3.7710069503742633`*^9}, {3.772886757992879*^9, 
  3.772886758102214*^9}},ExpressionUUID->"6328df8b-15be-4858-94d4-\
1a97611e7c5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"File", " ", "name", " ", "for", " ", "trained", " ", "network"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exportfilename", "=", "\"\<CNFNegcSEM_U2Net_100R_V1\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Export", " ", "path", " ", "for", " ", "the", " ", "trained", " ", 
     "network"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "netexportpath", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Trained U2Net\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Export", " ", "path", " ", "for", " ", "the", " ", "trained", " ", 
     "network", " ", "metadata"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "metadataexportpath", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Trained U2Net\\\\Network metadata\>\""}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "path", " ", "for", " ", "test", " ", "data", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"target", " ", "images"}], ")"}], ".", " ", "Use"}], " ", 
     "when", " ", "working", " ", "with", " ", "2", " ", 
     RowBox[{"classes", ".", " ", "Exports"}], " ", "in", " ", "tiff", " ", 
     RowBox[{"format", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "testdataexporttarget", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Test sets for IoU\\\\CNF NegC SEM images\\\\target imgs\>\""}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "path", " ", "for", " ", "test", " ", "data", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ground", " ", "truth"}], ")"}], ".", " ", "Use"}], " ", 
     "when", " ", "working", " ", "with", " ", "2", " ", 
     RowBox[{"classes", ".", " ", "Exports"}], " ", "in", " ", "tiff", " ", 
     RowBox[{"format", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "testdataexportgt", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Test sets for IoU\\\\CNF NegC SEM images\\\\ground truth imgs\>\""}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Export", " ", "path", " ", "for", " ", "test", " ", "data", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "target", " ", "images", " ", "and", " ", "ground", " ", "truth", " ", 
        "arrays"}], ")"}], ".", " ", "Use"}], " ", "when", " ", "working", 
     " ", "with", " ", "more", " ", "than", " ", "2", " ", 
     RowBox[{"classes", ".", " ", "Exports"}], " ", "in", " ", "mx", " ", 
     RowBox[{"format", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testdataexportmulticlass", "=", "\"\<\>\""}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.771006681502175*^9, 3.771006697201604*^9}, 
   3.7710069885235868`*^9, {3.771007021287481*^9, 3.7710070871852245`*^9}, {
   3.77100718903572*^9, 3.771007232470378*^9}, 3.771008441581071*^9, {
   3.771677229329255*^9, 3.771677241076505*^9}, {3.77168324072293*^9, 
   3.7716832637020226`*^9}, {3.7718441676793556`*^9, 3.771844209903008*^9}, {
   3.771859665204225*^9, 3.771859712446619*^9}, {3.7722228365857325`*^9, 
   3.7722228740752983`*^9}, {3.77227230022149*^9, 3.77227230037341*^9}, {
   3.7729919250016694`*^9, 3.772991969265351*^9}, {3.7731461317891293`*^9, 
   3.7731461702341237`*^9}, {3.773164153930389*^9, 3.773164154004345*^9}, {
   3.773198043976589*^9, 3.7731980453198204`*^9}, {3.774199758820718*^9, 
   3.774199763116581*^9}, {3.774199894311879*^9, 3.774199903559713*^9}, {
   3.775313568696669*^9, 3.775313580881315*^9}, {3.775313629385603*^9, 
   3.775313638836513*^9}, {3.809949954098645*^9, 3.809949955631604*^9}, {
   3.809949987135148*^9, 3.809950054052314*^9}, 3.8099501266554585`*^9, {
   3.828716727818918*^9, 3.828716737252073*^9}, 3.828716801212564*^9, {
   3.828716866297856*^9, 3.828716885083794*^9}, {3.8287183815542507`*^9, 
   3.8287183845945387`*^9}, {3.828801056967516*^9, 3.828801060842361*^9}, {
   3.829137053887972*^9, 3.829137075029117*^9}, {3.829222061799871*^9, 
   3.829222064298777*^9}, {3.829222113284086*^9, 3.829222114924654*^9}, 
   3.829225201301298*^9, {3.829665599559635*^9, 3.829665600874523*^9}, 
   3.829665688340158*^9, {3.830351257908263*^9, 3.8303512602433314`*^9}, 
   3.830360877658741*^9, 3.830430821051015*^9, {3.863709561339955*^9, 
   3.863709579372409*^9}, {3.863709705118418*^9, 3.863709721393895*^9}, {
   3.863773724905104*^9, 3.863773733078851*^9}, {3.863790176844135*^9, 
   3.86379017688818*^9}, {3.863877058781495*^9, 3.863877058839743*^9}, {
   3.864314377813479*^9, 3.864314377860379*^9}, {3.864314442954676*^9, 
   3.864314459645564*^9}, {3.864375677307252*^9, 3.864375688413764*^9}, {
   3.871057024625085*^9, 3.871057024675473*^9}, {3.872001123267606*^9, 
   3.872001123298763*^9}, {3.889266775749611*^9, 3.889266775799996*^9}, {
   3.889718255777127*^9, 3.889718255886475*^9}, {3.933076046750618*^9, 
   3.933076089023321*^9}, 3.933154690652367*^9, {3.933154741685692*^9, 
   3.93315478350888*^9}, {3.933155123153204*^9, 3.933155129962375*^9}, {
   3.9332658283283997`*^9, 3.933265828845974*^9}, {3.933266057849016*^9, 
   3.933266064360935*^9}, {3.964797531370617*^9, 3.964797552626352*^9}, 
   3.964797592911204*^9, 3.964797626944559*^9, {3.9647978354531345`*^9, 
   3.96479784100343*^9}, 3.965212344063484*^9, 3.965228191595196*^9, {
   3.965306772855259*^9, 3.965306772933434*^9}, 3.965825960209688*^9, {
   3.9678936756128864`*^9, 3.9678937560219817`*^9}, {3.967908044934263*^9, 
   3.967908049240795*^9}, 3.976726768567152*^9, {3.9767270262509384`*^9, 
   3.976727212941942*^9}},ExpressionUUID->"2931bc5e-6acc-4334-acd6-\
4a7f8718a4d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segmenting images using trained CNN", "Section",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771091367329028*^9, 3.771091376051399*^9}, {
  3.771091414565285*^9, 3.771091444641539*^9}, {3.7729807554339094`*^9, 
  3.772980756061225*^9}, {3.964698027128095*^9, 
  3.96469802849391*^9}},ExpressionUUID->"40ed4705-be84-495a-b79e-\
de080a80e030"],

Cell[CellGroupData[{

Cell["import a trained network", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
  3.7710069593680377`*^9, 3.7710069600866213`*^9}, {3.771250713466589*^9, 
  3.771250719464949*^9}, {3.7728867626792803`*^9, 
  3.772886762757366*^9}},ExpressionUUID->"3c7293a7-182a-4855-b17b-\
a8baeefecad6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", "Add"}], " ", "input", " ", "path", " ", "to", " ", "look", 
    " ", "for", " ", "previously", " ", "trained", " ", 
    RowBox[{"network", "--"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "trainednetpath", "=", 
    "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Trained U2Net\\\\CNFNegcSEM_U2Net_100R_V1.wmlf\>\""}], 
   ";"}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.771092721438406*^9, 3.771092748288638*^9}, {
   3.771092835593294*^9, 3.771092864950841*^9}, 3.771762463071703*^9, {
   3.7717808137081366`*^9, 3.7717808168477445`*^9}, 3.7718656711604033`*^9, 
   3.772295472497637*^9, 3.7722955380743074`*^9, 3.772889197653127*^9, {
   3.77298217433944*^9, 3.772982174695492*^9}, 3.773162619744483*^9, 
   3.77339829042124*^9, 3.7741999251894646`*^9, 3.775313690523999*^9, 
   3.7759180152794027`*^9, 3.77592256279661*^9, 3.775922680340996*^9, 
   3.779190540135816*^9, 3.8098846138407383`*^9, {3.809884707522727*^9, 
   3.809884728509285*^9}, 3.809952390612017*^9, {3.82872364422207*^9, 
   3.8287236555442157`*^9}, 3.8288163834271507`*^9, 3.829225530971325*^9, 
   3.8296863393449373`*^9, 3.830363431545083*^9, {3.8637129436234975`*^9, 
   3.863712954065551*^9}, {3.863791980577958*^9, 3.8637919806330657`*^9}, {
   3.863886149601955*^9, 3.8638861496800613`*^9}, {3.864375899785805*^9, 
   3.864375899829655*^9}, {3.87112021356314*^9, 3.87112021362709*^9}, 
   3.872023005151218*^9, 3.889602667540985*^9, {3.889778975849229*^9, 
   3.8897789765677853`*^9}, 3.93307231931376*^9, 3.933072360361555*^9, 
   3.93315551956913*^9, 3.933155575273716*^9, {3.933321140630556*^9, 
   3.933321141063315*^9}, 3.964863475136162*^9, 3.9652123838279076`*^9, 
   3.965228207881956*^9, {3.965306766202322*^9, 3.965306766296648*^9}, {
   3.965825969436035*^9, 3.965825969514166*^9}, 3.9678973063998756`*^9, 
   3.967908073449184*^9, 3.968151493050556*^9, 3.9726502014962273`*^9, 
   3.972650251647961*^9, {3.972651614609514*^9, 
   3.972651619264677*^9}},ExpressionUUID->"495c3329-f051-415e-a588-\
d683ad764f9c"]
}, Closed]],

Cell[CellGroupData[{

Cell["importing image files", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
   3.7710069593680377`*^9, 3.7710069600866213`*^9}, {3.771250713466589*^9, 
   3.771250719464949*^9}, {3.771250780544627*^9, 3.7712508371238327`*^9}, {
   3.7728867645850735`*^9, 3.772886764694425*^9}, {3.967899289810515*^9, 
   3.967899347004181*^9}, 
   3.9678994234426403`*^9},ExpressionUUID->"b449995e-fe0b-419b-b582-\
90618006ff86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", "Add"}], " ", "path", " ", "to", " ", "look", " ", "for", 
     " ", "images", " ", "to", " ", "segment"}], ",", " ", 
    RowBox[{
    "if", " ", "an", " ", "image", " ", "has", " ", "an", " ", "area", " ", 
     "of", " ", "interest", " ", "smaller", " ", "than", " ", "its", " ", 
     "size"}], ",", " ", 
    RowBox[{
    "crop", " ", "that", " ", "image", " ", "to", " ", "save", " ", 
     "segmentation", " ", 
     RowBox[{"time", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imagepaths", "=", 
     RowBox[{"List", "[", 
      RowBox[{
      "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\FACT\\\\Data files\\\\563-Mica-U200DD \
(7-22-25 NegSem)\\\\Result file\\\\Trimmed images\>\"", ",", 
       "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\FACT\\\\Data \
files\\\\Udita(SEMimgs_V10)_GKS2\\\\Result file\\\\Trimmed images\>\"", ",", 
       "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\FACT\\\\Data \
files\\\\SimpleCNF_GKS2\\\\Result file\\\\Trimmed images\>\"", ",", 
       "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\FACT\\\\Data \
files\\\\580-581-UMaine90\\\\Result file\\\\Trimmed images\>\""}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Write", " ", "whether", " ", "the", " ", "imported", " ", "segmentation",
      " ", "images", " ", "are", " ", "Grayscale", " ", "or", " ", 
     RowBox[{"RGB", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"imagetype1", "=", "\"\<Grayscale\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Select", " ", "what", " ", "mode", " ", "to", " ", "use", " ", "for", 
      " ", "import", " ", "between", " ", "\"\<all\>\""}], ",", " ", 
     "\"\<random\>\"", ",", " ", "\"\<ordered\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"\"\<all\>\"", ":", " ", 
      RowBox[{
      "imports", " ", "all", " ", "images", " ", "in", " ", "the", " ", 
       "loaded", " ", "file", " ", 
       RowBox[{"names", ".", "\[IndentingNewLine]", "\"\<random\>\""}]}], ":",
       " ", 
      RowBox[{
      "imports", " ", "images", " ", "at", " ", "random", " ", "from", " ", 
       "the", " ", "loaded", " ", "file", " ", "names"}]}], ",", "   ", 
     RowBox[{
      RowBox[{
      "the", " ", "number", " ", "of", " ", "images", " ", "selected", " ", 
       "is", " ", "changed", " ", "in", " ", "numofrandom", " ", 
       RowBox[{"variable", ".", "\[IndentingNewLine]", "\"\<ordered\>\""}]}], 
      ":", " ", 
      RowBox[{
      "imports", " ", "images", " ", "at", " ", "selected", " ", "positions", 
       " ", "in", " ", "the", " ", "loaded", " ", "file", " ", "names"}]}], 
     ",", " ", 
     RowBox[{"indicated", " ", "by", " ", "the", " ", "listofpositions", " ", 
      RowBox[{"variable", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mode", "=", "\"\<all\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "If", " ", "random", " ", "was", " ", "selected", " ", "write", " ", 
     "the", " ", "number", " ", "of", " ", "random", " ", "images", " ", "to",
      " ", "import", " ", "per", " ", 
     RowBox[{"file", ".", " ", "Even"}], " ", "if", " ", "not", " ", "being", 
     " ", "used", " ", "write", " ", "an", " ", "integer"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numrandom", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "If", " ", "ordered", " ", "was", " ", "selected", " ", "write", " ", 
     "the", " ", "position", " ", "of", " ", "the", " ", "images", " ", "in", 
     " ", "the", " ", "list", " ", "to", " ", 
     RowBox[{"import", ".", " ", "Even"}], " ", "if", " ", "not", " ", 
     "being", " ", "used", " ", "write", " ", "a", " ", "list", " ", "of", 
     " ", 
     RowBox[{"integers", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listofpositions", "=", 
     RowBox[{"List", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Input", " ", "display", " ", "size", " ", "to", " ", "use"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"displaysize", "=", "600"}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.7710935271807413`*^9, 3.771093588307312*^9}, {
   3.771095201394415*^9, 3.771095204612631*^9}, 3.771095333548967*^9, {
   3.771096167887563*^9, 3.771096173993604*^9}, {3.771096234670684*^9, 
   3.7710962434030013`*^9}, {3.771096362584326*^9, 3.7710963693557444`*^9}, {
   3.771159633290581*^9, 3.771159651030635*^9}, 3.771160034479703*^9, {
   3.771162299665077*^9, 3.771162409391642*^9}, {3.771162510625338*^9, 
   3.77116263238389*^9}, {3.771162856123845*^9, 3.771162858433606*^9}, {
   3.771162899960966*^9, 3.7711630506803646`*^9}, {3.771163396374388*^9, 
   3.771163397985675*^9}, {3.771163474191318*^9, 3.771163475786918*^9}, {
   3.771166461799852*^9, 3.771166461896702*^9}, {3.771177443642757*^9, 
   3.7711774452580247`*^9}, 3.7712460321085787`*^9, {3.7712489368371263`*^9, 
   3.771248999707177*^9}, {3.771250890845371*^9, 3.771250905301546*^9}, {
   3.77125095155634*^9, 3.771251190233822*^9}, 3.7712607545260444`*^9, 
   3.771589844447666*^9, 3.771590791561166*^9, 3.7715908344166975`*^9, 
   3.771590865206274*^9, 3.771599821118741*^9, {3.771600304681362*^9, 
   3.771600323630003*^9}, 3.7716007846411057`*^9, {3.771600827843012*^9, 
   3.771600846905495*^9}, {3.771605190155024*^9, 3.7716051902619114`*^9}, {
   3.771605331880174*^9, 3.7716053386590757`*^9}, {3.771608088974469*^9, 
   3.771608168400685*^9}, {3.771608284762566*^9, 3.771608307821616*^9}, 
   3.771762509301791*^9, {3.771764975198701*^9, 3.771764976263344*^9}, {
   3.771765019808781*^9, 3.7717650201525345`*^9}, {3.771780822152562*^9, 
   3.771780826172813*^9}, 3.771791368355276*^9, 3.772295550653119*^9, {
   3.772296140728793*^9, 3.7722961513847017`*^9}, 3.772889285544117*^9, {
   3.772898180965289*^9, 3.772898214165554*^9}, {3.772902390547729*^9, 
   3.772902411324718*^9}, {3.772902453899305*^9, 3.772902570135639*^9}, {
   3.7729040900580993`*^9, 3.77290415818556*^9}, {3.77290425079017*^9, 
   3.772904278830452*^9}, {3.7729048947203217`*^9, 3.772904894954848*^9}, {
   3.77296737328356*^9, 3.772967373391159*^9}, {3.7729733853633633`*^9, 
   3.772973388074869*^9}, {3.772973439660742*^9, 3.7729734435429883`*^9}, 
   3.772973474669315*^9, {3.772973676035593*^9, 3.772973682984762*^9}, {
   3.7729759472296104`*^9, 3.7729759600714607`*^9}, {3.772981180137282*^9, 
   3.772981180993995*^9}, {3.772982119669541*^9, 3.772982172077486*^9}, {
   3.772982266992785*^9, 3.772982326568539*^9}, {3.773163221580412*^9, 
   3.773163249991161*^9}, {3.773398327106267*^9, 3.773398348449065*^9}, {
   3.773398980259532*^9, 3.7733989803644714`*^9}, {3.7734000368846407`*^9, 
   3.773400038233867*^9}, 3.774200164388612*^9, 3.77420061120603*^9, {
   3.774200849427663*^9, 3.774200850333678*^9}, {3.77420093608228*^9, 
   3.7742009363319645`*^9}, {3.774201246535073*^9, 3.7742012620047855`*^9}, 
   3.775313793963265*^9, {3.775313829049014*^9, 3.775313829158365*^9}, {
   3.775315852894956*^9, 3.775315854035313*^9}, {3.775918069206514*^9, 
   3.775918101441177*^9}, {3.7759183110557585`*^9, 3.775918312054949*^9}, {
   3.7759187129751205`*^9, 3.7759187140289793`*^9}, {3.7759195045358477`*^9, 
   3.775919505676851*^9}, {3.775919716656795*^9, 3.775919717624277*^9}, {
   3.775920381124525*^9, 3.775920382075898*^9}, 3.775922059350427*^9, 
   3.775922192985529*^9, {3.775922660957217*^9, 3.775922665670388*^9}, 
   3.776084877980193*^9, {3.776085297014639*^9, 3.776085298355976*^9}, {
   3.776085611986367*^9, 3.776085722886811*^9}, {3.77608603245545*^9, 
   3.776086033351673*^9}, {3.776086181869547*^9, 3.776086182808677*^9}, {
   3.776086823966082*^9, 3.776086912759828*^9}, {3.776087576134102*^9, 
   3.77608757621796*^9}, 3.776098223154998*^9, {3.7760982971664686`*^9, 
   3.7760982972757893`*^9}, {3.7760986188733006`*^9, 3.776098618982631*^9}, {
   3.779190989900932*^9, 3.779191016884942*^9}, 3.779191256871877*^9, {
   3.77919130433728*^9, 3.779191304533757*^9}, {3.779191924969986*^9, 
   3.7791919250324802`*^9}, {3.779192088885353*^9, 3.7791921058784275`*^9}, 
   3.779212132368199*^9, 3.785609287984435*^9, 3.7856093293809786`*^9, 
   3.7856730280401425`*^9, 3.809882022336896*^9, {3.8098820614294634`*^9, 
   3.809882093727057*^9}, 3.809884761408042*^9, {3.8099528815515003`*^9, 
   3.809952882144576*^9}, 3.809952946852579*^9, {3.809953114780517*^9, 
   3.80995318933762*^9}, 3.828723700175022*^9, {3.828723738774849*^9, 
   3.828723780474861*^9}, {3.828723823097492*^9, 3.828723837006467*^9}, {
   3.828724063466179*^9, 3.828724064758566*^9}, {3.828724173800322*^9, 
   3.828724174169715*^9}, {3.828725328136288*^9, 3.828725329635934*^9}, {
   3.828725447027897*^9, 3.8287254482151155`*^9}, {3.828725824899938*^9, 
   3.828725850384168*^9}, {3.828816480270881*^9, 3.828816486519405*^9}, 
   3.8288165299601173`*^9, {3.8288166882985573`*^9, 3.828816690954179*^9}, {
   3.829045421428184*^9, 3.829045422575*^9}, {3.829045789560925*^9, 
   3.829045789974852*^9}, {3.829056801386055*^9, 3.829056802218593*^9}, {
   3.829057267179824*^9, 3.829057268128149*^9}, {3.8290575243605523`*^9, 
   3.8290575252333603`*^9}, {3.829059873708769*^9, 3.8290598739662*^9}, {
   3.8290600435939083`*^9, 3.8290600993654137`*^9}, {3.8290601732554317`*^9, 
   3.829060174255857*^9}, {3.8291322091545057`*^9, 3.829132216827489*^9}, {
   3.829137234635077*^9, 3.829137236576854*^9}, {3.8291425463079*^9, 
   3.829142554222474*^9}, {3.829225543944066*^9, 3.829225566626191*^9}, {
   3.8292257212121677`*^9, 3.829225741278618*^9}, {3.8292275184852457`*^9, 
   3.829227519918661*^9}, {3.829228089563322*^9, 3.829228093997079*^9}, {
   3.829686356961008*^9, 3.829686371959241*^9}, 3.8296866081511135`*^9, 
   3.829686664179279*^9, {3.829686713046271*^9, 3.829686748390698*^9}, {
   3.829734481013807*^9, 3.829734502218995*^9}, {3.8297413432149105`*^9, 
   3.8297413566228857`*^9}, {3.829741871695939*^9, 3.82974198502255*^9}, 
   3.829742105022167*^9, {3.829742146686781*^9, 3.8297421694560537`*^9}, {
   3.829742485983252*^9, 3.8297425517763844`*^9}, 3.829743673791393*^9, {
   3.8297445802249403`*^9, 3.829744581311726*^9}, {3.8297446233919077`*^9, 
   3.829744682256857*^9}, {3.829746278513244*^9, 3.829746284063615*^9}, {
   3.829831387469909*^9, 3.8298313998864594`*^9}, {3.829831852578198*^9, 
   3.82983185271788*^9}, {3.829834722034988*^9, 3.829834723152878*^9}, {
   3.8298347803637447`*^9, 3.8298347814406614`*^9}, {3.8303634471609435`*^9, 
   3.830363453892365*^9}, {3.830363593126322*^9, 3.830363593186334*^9}, {
   3.830363624475122*^9, 3.830363626157398*^9}, 3.830363679348361*^9, {
   3.8303645781031904`*^9, 3.830364597925498*^9}, {3.8303646668338923`*^9, 
   3.830364668817744*^9}, {3.830426896224701*^9, 3.8304269464251785`*^9}, {
   3.830430259991483*^9, 3.830430290641324*^9}, {3.830430780755573*^9, 
   3.8304307810597734`*^9}, {3.830437551148002*^9, 3.830437551319548*^9}, 
   3.8637738391721697`*^9, {3.863773877200385*^9, 3.863773879012446*^9}, {
   3.863773916676555*^9, 3.86377395903212*^9}, 3.863774243789933*^9, 
   3.863774275240177*^9, {3.863774511067882*^9, 3.8637745233008995`*^9}, {
   3.8637888252016077`*^9, 3.863788827208995*^9}, {3.863792499985889*^9, 
   3.863792599039046*^9}, {3.8637926735648947`*^9, 3.863792673830303*^9}, {
   3.8637949690895653`*^9, 3.863794970171166*^9}, {3.8643773334015536`*^9, 
   3.8643773535591793`*^9}, {3.870185618368763*^9, 3.8701856224210863`*^9}, {
   3.871121524052583*^9, 3.871121543848547*^9}, {3.889603650262295*^9, 
   3.8896036503093204`*^9}, {3.889603733621041*^9, 3.8896037345424433`*^9}, {
   3.889603880205039*^9, 3.889603881235827*^9}, {3.889708653788803*^9, 
   3.8897086571098766`*^9}, {3.889709637134471*^9, 3.889709637329975*^9}, {
   3.8897789863564386`*^9, 3.88977899124761*^9}, {3.889781871793999*^9, 
   3.889781872121928*^9}, {3.889790288233323*^9, 3.889790291732502*^9}, {
   3.889790345976177*^9, 3.889790346148222*^9}, {3.890147691850811*^9, 
   3.890147695298118*^9}, {3.890148246206643*^9, 3.890148249453577*^9}, {
   3.890148473897646*^9, 3.890148479286582*^9}, {3.890219527218188*^9, 
   3.8902195440268373`*^9}, {3.890222601946219*^9, 3.8902226022168503`*^9}, 
   3.933072309995138*^9, {3.93307237393795*^9, 3.933072410575329*^9}, 
   3.933072830300808*^9, {3.933074069488735*^9, 3.9330740960364056`*^9}, {
   3.9330743281609306`*^9, 3.933074329343218*^9}, 3.933155533254364*^9, 
   3.933155563266098*^9, 3.933155601852766*^9, {3.9331557255857544`*^9, 
   3.933155736745165*^9}, 3.9331565898801804`*^9, {3.933156623025461*^9, 
   3.9331566445204086`*^9}, {3.933156679311025*^9, 3.933156692509436*^9}, 
   3.933156839407896*^9, {3.933157736306235*^9, 3.933157740183922*^9}, {
   3.933159414322681*^9, 3.9331594296926537`*^9}, {3.933321153904899*^9, 
   3.933321154252981*^9}, 3.9333224070307865`*^9, {3.939986067199604*^9, 
   3.939986068434805*^9}, {3.9399877061762676`*^9, 3.939987746944334*^9}, {
   3.939987878586947*^9, 3.9399878899673615`*^9}, 3.939997713264869*^9, {
   3.964863516424225*^9, 3.964863542150961*^9}, {3.965225449329879*^9, 
   3.965225453113594*^9}, 3.965303048189226*^9, 3.96530310712326*^9, {
   3.965303317040043*^9, 3.965303317149864*^9}, {3.965304022227045*^9, 
   3.965304056670779*^9}, {3.965304134417959*^9, 3.9653041351417313`*^9}, {
   3.965405735202104*^9, 3.965405750024464*^9}, {3.965920518318962*^9, 
   3.965920526999548*^9}, {3.965920570340613*^9, 3.9659206343671207`*^9}, {
   3.9659209842754803`*^9, 3.965921010109728*^9}, {3.965922721858621*^9, 
   3.96592274222505*^9}, {3.9676461593126354`*^9, 3.9676461863947773`*^9}, {
   3.967899484825777*^9, 3.967899489638851*^9}, {3.967901750138172*^9, 
   3.967901774361483*^9}, {3.9679021789941635`*^9, 3.967902193952553*^9}, 
   3.967908080402478*^9, {3.972650147601488*^9, 3.972650176941705*^9}, {
   3.97265176469162*^9, 3.97265177806328*^9}, {3.9748166923862934`*^9, 
   3.9748166929954967`*^9}},ExpressionUUID->"4598aed3-11e4-4d7e-a6dc-\
3aa304612c89"]
}, Closed]],

Cell[CellGroupData[{

Cell["segmenting a test image with imported network", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
  3.7710069593680377`*^9, 3.7710069600866213`*^9}, {3.771250713466589*^9, 
  3.771250719464949*^9}, {3.771250780544627*^9, 3.7712508371238327`*^9}, {
  3.7728867645850735`*^9, 3.772886764694425*^9}, {3.967899289810515*^9, 
  3.967899347004181*^9}},ExpressionUUID->"0ca3971a-851d-0b41-a96e-\
3c54ff2fbaaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Select", " ", "the", " ", "position", " ", "of", " ", "an", " ", "input",
      " ", "image", " ", "to", " ", "view", " ", "a", " ", "preview", " ", 
     "of", " ", "result"}], ",", " ", 
    RowBox[{
    "this", " ", "number", " ", "has", " ", "to", " ", "be", " ", "less", " ",
      "than", " ", "the", " ", "number", " ", "of", " ", "images", " ", 
     "imported", " ", "for", " ", 
     RowBox[{"segmentation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pos", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Input", " ", "either", " ", "\"\<CPU\>\"", " ", "or", " ", 
     RowBox[{"\"\<GPU\>\"", ".", " ", "Computing"}], " ", "the", " ", "image",
      " ", "segmentation", " ", "using", " ", "the", " ", "CPU", " ", "is", 
     " ", "slower", " ", "but", " ", "typically", " ", "wont", " ", "give", 
     " ", "any", " ", "memory", " ", 
     RowBox[{"issues", ".", " ", "Using"}], " ", "the", " ", "GPU", " ", "is",
      " ", "much", " ", "faster", " ", "when", " ", "your", " ", "computer", 
     " ", "has", " ", "enough", " ", "VRAM", " ", "to", " ", "perform", " ", 
     "segmentation", " ", "uisng", " ", "a", " ", "CNN", " ", "with", " ", 
     "input", " ", "size", " ", 
     RowBox[{"netdiminput", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"targetdevice", "=", "\"\<CPU\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Change", " ", "contrast"}], ",", " ", 
     RowBox[{
     "brightness", " ", "and", " ", "gamma", "  ", "settings", " ", "for", 
      " ", "the", " ", "highlight", " ", "image", " ", "display"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"contrast", ",", "brightness", ",", "gamma"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Input", " ", "a", " ", "partition", " ", "pixel", " ", "overlap", " ", 
     RowBox[{"amount", ".", "  ", "This"}], " ", "number", " ", "needs", " ", 
     "to", " ", "be", " ", "an", " ", "even", " ", "integer", " ", "greater", 
     " ", "than", " ", 
     RowBox[{"zero", ".", " ", "Reasonable"}], " ", "values", " ", "are", " ",
      "between", " ", "2", " ", "and", " ", "200."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partitionoverlap", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Select", " ", "whether", " ", "to", " ", "outoput", " ", "a", " ", 
      "single", " ", "channel", " ", "image", " ", "that", " ", "represents", 
      " ", "the", " ", "greatest", " ", "class", " ", "probability", " ", 
      "or", " ", "a", " ", "multi"}], "-", 
     RowBox[{
     "channel", " ", "image", " ", "where", " ", "each", " ", "channel", " ", 
      "is", " ", "the", " ", "probability", " ", "of", " ", "one", " ", "of", 
      " ", "the", " ", 
      RowBox[{"classes", ".", " ", "Write"}], " ", "either", " ", 
      "\"\<yes\>\"", " ", "or", " ", "\"\<no\>\"", " ", "with", " ", 
      RowBox[{"quotes", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pixelpredict", "=", "\"\<no\>\""}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Thresholding", " ", "level", " ", "to", " ", "select", " ", "when", " ", 
     "viewing", " ", "binary", " ", "segmentation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"threshold", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Write", " ", "number", " ", "of", " ", "classes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numberofclasses", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Color", " ", "to", " ", "identify", " ", "classes", " ", 
     RowBox[{"with", ".", " ", "Add"}], " ", "the", " ", "same", " ", 
     "number", " ", "of", " ", "colors", " ", "as", " ", "classes", " ", "to",
      " ", "be", " ", "identified"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"classcolor", "=", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Red"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Enter", " ", "the", " ", "position", " ", "of", " ", "the", " ", "class",
      " ", "to", " ", "show", " ", "in", " ", "the", " ", "dynamic", " ", 
     "image", " ", 
     RowBox[{"fuction", ".", " ", "This"}], " ", "function", " ", "displays", 
     " ", "a", " ", "probability", " ", "map", " ", "where", " ", "white", 
     " ", "is", " ", "high", " ", "probability", " ", "and", " ", "black", 
     " ", "is", " ", 
     RowBox[{"low", ".", " ", "The"}], " ", "number", " ", "entered", " ", 
     "in", " ", "classposition", " ", "needs", " ", "to", " ", "be", " ", 
     "equal", " ", "or", " ", "lower", " ", "than", " ", "the", " ", "max", 
     " ", "number", " ", "of", " ", 
     RowBox[{"classes", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"classposition", "=", "2"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Enter", " ", "the", " ", "level", " ", "of", " ", "opacity", " ", "to", 
     " ", "use", " ", "in", " ", "the", " ", "highlight", " ", "image", " ", 
     "funcion"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"opacity", "=", "0.2"}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.9678995010063577`*^9, 3.9678996443707542`*^9}, 
   3.9679008633121796`*^9, 3.967900960898657*^9, 3.967901843466954*^9, 
   3.968158434715914*^9, {3.972650457498594*^9, 3.972650459060957*^9}, {
   3.9748191574009*^9, 
   3.974819158400669*^9}},ExpressionUUID->"d2b1edac-8942-3a49-8fef-\
25411599180f"]
}, Closed]],

Cell[CellGroupData[{

Cell["segmenting and exporting results", "Subsection",
 Editable->"False",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
  3.7710069593680377`*^9, 3.7710069600866213`*^9}, {3.771250713466589*^9, 
  3.771250719464949*^9}, {3.771250780544627*^9, 3.7712508371238327`*^9}, {
  3.7712512798242598`*^9, 3.771251317346944*^9}, {3.772886766772047*^9, 
  3.772886766834335*^9}, {3.772973462857376*^9, 
  3.7729734721359234`*^9}},ExpressionUUID->"6c3471a2-a8d5-4b22-baa1-\
9d0afce51e48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Write", " ", "image", " ", "output", " ", "directory"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "outputdirectory", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\FACT\\\\Data \
files\\\\580-581-UMaine90\\\\Segmented images\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Select", " ", "the", " ", "file", " ", "extension", " ", "to", " ", 
      "use", " ", "when", " ", 
      RowBox[{"exporting", ".", " ", "If"}], " ", "exporting", " ", "an", " ",
       "image", " ", "use", " ", "\"\<.tiff\>\"", " ", "if", " ", "exporting",
       " ", "a", " ", "multi"}], "-", 
     RowBox[{
     "channel", " ", "array", " ", "use", " ", "\"\<.mx\>\"", " ", "or", " ", 
      "\"\<.json\>\""}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fileextension", "=", "\"\<.mx\>\""}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.764339811576136*^9, 3.764339882001498*^9}, {
   3.764339913893791*^9, 3.764339938347649*^9}, {3.7643399808687654`*^9, 
   3.764339988139391*^9}, 3.76443865210208*^9, {3.7645020154619646`*^9, 
   3.764502016537524*^9}, 3.76745570472096*^9, 3.767455750397681*^9, {
   3.767529616639771*^9, 3.76752966911757*^9}, {3.767530269907937*^9, 
   3.767530284313404*^9}, 3.769430165572326*^9, {3.771251916096619*^9, 
   3.7712519675845118`*^9}, {3.7712520005999565`*^9, 3.771252007512427*^9}, {
   3.771252396366754*^9, 3.7712523968993464`*^9}, {3.771252477176005*^9, 
   3.7712525286940536`*^9}, {3.771254002915427*^9, 3.771254005477564*^9}, {
   3.7712588931624165`*^9, 3.771258897874423*^9}, {3.7712590253233624`*^9, 
   3.7712590804153037`*^9}, 3.7712592692710643`*^9, {3.771260646338376*^9, 
   3.771260647308324*^9}, {3.771589865791339*^9, 3.771589878869191*^9}, {
   3.7716058867003226`*^9, 3.771605890421141*^9}, {3.771762967479215*^9, 
   3.771762967570198*^9}, {3.771764273625372*^9, 3.771764279242058*^9}, {
   3.771764504557077*^9, 3.771764509217147*^9}, {3.77176516931825*^9, 
   3.771765169500581*^9}, {3.771765259947572*^9, 3.771765270290933*^9}, {
   3.771765325066107*^9, 3.771765326771053*^9}, {3.772295783517569*^9, 
   3.7722958123091373`*^9}, {3.772296445035108*^9, 3.772296458055658*^9}, {
   3.772974784460267*^9, 3.772974879086747*^9}, 3.772974924937617*^9, {
   3.7729749690452833`*^9, 3.772975025679904*^9}, 3.772975135172525*^9, {
   3.772975212213343*^9, 3.7729752171471887`*^9}, {3.77297526469353*^9, 
   3.772975292546616*^9}, {3.772981215556636*^9, 3.772981215613484*^9}, {
   3.7729821808610077`*^9, 3.772982247795071*^9}, {3.7733951438896885`*^9, 
   3.773395165382401*^9}, {3.773395247319587*^9, 3.773395251720062*^9}, {
   3.77339530833268*^9, 3.773395309470027*^9}, {3.773397440242288*^9, 
   3.773397553911302*^9}, {3.773399638649671*^9, 3.773399640359672*^9}, 
   3.7733996844784822`*^9, {3.773399718377116*^9, 3.773399732538042*^9}, {
   3.773399837635136*^9, 3.773399868389552*^9}, {3.773399900029465*^9, 
   3.77339990181944*^9}, {3.809882974210763*^9, 3.809882974838997*^9}, {
   3.8287253158610277`*^9, 3.828725316126591*^9}, 3.829045795718952*^9, 
   3.829134787977721*^9, {3.829134837782565*^9, 3.8291348564657006`*^9}, {
   3.82913559031765*^9, 3.829135594849887*^9}, {3.829136106667037*^9, 
   3.8291361076637506`*^9}, 3.829136157025777*^9, {3.829136451087819*^9, 
   3.829136458490715*^9}, {3.829227479163172*^9, 3.829227481914497*^9}, {
   3.829227512004961*^9, 3.8292275130926914`*^9}, 3.829227946899416*^9, 
   3.830431815339425*^9, {3.830431860598838*^9, 3.830431869633041*^9}, {
   3.8304337603243256`*^9, 3.830433760906776*^9}, {3.863795997226902*^9, 
   3.86379601452171*^9}, {3.863796087558831*^9, 3.863796090378479*^9}, 
   3.863886366903318*^9, 3.86437726836366*^9, 3.871121917394995*^9, 
   3.872023645283584*^9, {3.889789707884496*^9, 3.889789707931336*^9}, 
   3.93315568188417*^9, 3.933157537380326*^9, {3.933322110609379*^9, 
   3.933322110926161*^9}, 3.965302914421741*^9, {3.965920678282755*^9, 
   3.96592067870732*^9}, {3.965920714303097*^9, 3.965920768504158*^9}, 
   3.967902352653403*^9, {3.974813077661249*^9, 
   3.974813079713257*^9}},ExpressionUUID->"a0ce854e-c3fc-46c1-8525-\
727bed1017bf"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating intersection over union (IoU)", "Section",
 Deletable->"False",
 Evaluatable->False,
 CellChangeTimes->{{3.771006780822073*^9, 3.771006807572807*^9}, {
   3.7710069593680377`*^9, 3.7710069600866213`*^9}, {3.771250713466589*^9, 
   3.771250719464949*^9}, {3.771250780544627*^9, 3.7712508371238327`*^9}, {
   3.7712512798242598`*^9, 3.771251317346944*^9}, {3.772886766772047*^9, 
   3.772886766834335*^9}, {3.772973462857376*^9, 3.7729734721359234`*^9}, {
   3.779195314462424*^9, 3.7791953184206657`*^9}, 
   3.9748228146316376`*^9},ExpressionUUID->"6abea06c-055e-4af6-9a13-\
893b08c4765b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Add", " ", "path", " ", "for", " ", "the", " ", "ground", " ", "truth", 
    " ", "images"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imptgtdir", "=", 
     RowBox[{
     "List", "[", "\[IndentingNewLine]", 
      "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Test sets for IoU\\\\CNF NegC SEM images\\\\ground truth imgs\>\"", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IoU", " ", "rule", " ", 
     RowBox[{"change", ".", " ", "If"}], " ", "the", " ", "imported", " ", 
     "gt", " ", "data", " ", "has", " ", "the", " ", "value", " ", "0", " ", 
     "as", " ", "a", " ", "class", " ", "it", " ", "needs", " ", "to", " ", 
     "be", " ", 
     RowBox[{"changed", ".", " ", "Write"}], " ", "\"\<yes\>\"", " ", "to", 
     " ", "change", " ", "the", " ", "data", " ", "using", " ", "the", " ", 
     "rules", " ", "in", " ", 
     RowBox[{"rulechange", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"userulechangeIoU", "=", "\"\<yes\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Same", " ", "mode", " ", "definitions", " ", "as", " ", "in", " ", "the",
      " ", "\"\<testing segmentation with loaded network\>\"", " ", 
     RowBox[{"section", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modeiou", "=", "\"\<all\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numrandomiou", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listofpositionsiou", "=", 
     RowBox[{"List", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "If", " ", "ground", " ", "truth", " ", "images", " ", "are", " ", 
     "smaller", " ", "than", " ", "the", " ", "Network", " ", "segmented", 
     " ", "gray", " ", "images", " ", "write", " ", "\"\<yes\>\"", " ", "to", 
     " ", "crop", " ", "them", " ", "to", " ", "size"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cropsegmultimgs", "=", "\"\<yes\>\""}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Add", " ", "path", " ", "for", " ", "exporting", " ", "IoU", " ", 
     "results"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "iouexppath", "=", 
     "\"\<C:\\\\Users\\\\cbaez\\\\Box\\\\01. carlos.l.baez \
Workspace\\\\Mathematica Notebooks\\\\Semantic Image Segmentation\\\\U2-Net \
CNN\\\\Test sets for IoU\\\\CNF NegC SEM images\>\""}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Write", " ", "a", " ", "file", " ", "name", " ", "for", " ", "the", " ", 
     "IoU", " ", "export", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ioufilename", "=", "\"\<someName.csv\>\""}], ";"}]}]}]], "Input",
 Editable->True,
 Deletable->False,
 Evaluatable->True,
 CellChangeTimes->{{3.779195326315937*^9, 3.779195408262469*^9}, {
   3.779195788895336*^9, 3.779195792294128*^9}, {3.779212116003971*^9, 
   3.77921216477352*^9}, 3.779212365464029*^9, 3.7792125042847047`*^9, 
   3.779212820611577*^9, 3.785609372124534*^9, 3.785614863395111*^9, 
   3.785673048853674*^9, {3.82904580514525*^9, 3.829045805343596*^9}, 
   3.829060328473423*^9, {3.829060678025731*^9, 3.8290606877407465`*^9}, {
   3.829732860703515*^9, 3.8297328820670986`*^9}, {3.829733090618969*^9, 
   3.829733105034209*^9}, {3.829733152367043*^9, 3.829733156295631*^9}, {
   3.829735649411428*^9, 3.829735793347194*^9}, {3.829736052190421*^9, 
   3.82973605497066*^9}, 3.829827569635327*^9, {3.8298276086609435`*^9, 
   3.829827619552792*^9}, 3.830363983897208*^9, 3.830364027461572*^9, 
   3.830364746554137*^9, {3.830366059459629*^9, 3.83036608513266*^9}, {
   3.830426965570824*^9, 3.830426994430759*^9}, {3.8304307608211813`*^9, 
   3.830430771410368*^9}, {3.863776303762925*^9, 3.863776339395852*^9}, {
   3.863776482848549*^9, 3.863776505390997*^9}, {3.86377661731688*^9, 
   3.863776618207271*^9}, {3.863779436594811*^9, 3.863779483250888*^9}, {
   3.86378019364806*^9, 3.863780255555906*^9}, {3.863780342025245*^9, 
   3.863780368159489*^9}, {3.863792244859932*^9, 3.863792244956377*^9}, {
   3.863792747739176*^9, 3.863792760608412*^9}, {3.864377443282374*^9, 
   3.86437745151462*^9}, {3.864378131555277*^9, 3.864378131618848*^9}, {
   3.889790368642949*^9, 3.88979036872104*^9}, {3.933155656279146*^9, 
   3.933155670948967*^9}, {3.9331576674442863`*^9, 3.933157677961754*^9}, 
   3.933322383491899*^9, 3.9659227832649918`*^9, {3.965922822578167*^9, 
   3.96592291344854*^9}, 3.967901546161848*^9, {3.967902374191323*^9, 
   3.967902377920353*^9}, 3.967902441871409*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"603b4cc0-1f87-4dcc-a203-e3a5650bef3b"]
}, Closed]]
},
WindowSize->{821.1428571428571, 852},
WindowMargins->{{Automatic, -4.285714285714448}, {Automatic, 0}},
SpellingDictionaries->{"CorrectWords"->{
 "diffractio", "pltrange", "ycoord", "txt", "maximgsize", "imptdata", 
  "numofpartition", "filenamegather", "stringlength", "colrules", 
  "numofclasses"}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"22c53e93-ce31-4493-b53a-d1bb1f94b6e8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 321, 7, 50, "Section",ExpressionUUID->"d0951302-093e-4165-9590-bc2f54da5802",
 Evaluatable->False],
Cell[904, 31, 462, 11, 46, "CodeText",ExpressionUUID->"548b9db2-9bb2-4f94-9241-4f7d452760db",
 Evaluatable->False],
Cell[1369, 44, 1732, 32, 62, "Input",ExpressionUUID->"c024023b-5cc4-4534-9dbf-cbd39ae5abf6",
 Evaluatable->True,
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3126, 80, 308, 7, 41, "Subsection",ExpressionUUID->"a156d7b7-7110-1f4a-9572-069455356c86",
 Evaluatable->False],
Cell[3437, 89, 958, 17, 46, "CodeText",ExpressionUUID->"b4e5ccbe-36cb-e94b-921b-73db2a51e902",
 Evaluatable->False],
Cell[4398, 108, 1061, 19, 36, "Input",ExpressionUUID->"57dbccc5-8ba9-1946-b72a-d1d9a528b82b",
 Evaluatable->True],
Cell[5462, 129, 511, 11, 21, "Input",ExpressionUUID->"af3d31a0-3be6-dc44-9481-013a7758aaa3",
 Evaluatable->True],
Cell[5976, 142, 929, 23, 36, "Input",ExpressionUUID->"5e126ec5-022b-9d43-ad78-9ef6fe10f4d6",
 Evaluatable->True],
Cell[6908, 167, 828, 20, 36, "Input",ExpressionUUID->"f0370b97-8db0-e644-8e53-5adb85b1696f",
 Evaluatable->True],
Cell[7739, 189, 2416, 40, 36, "Input",ExpressionUUID->"dd34c5be-624c-5944-9236-f923d018f31c",
 Evaluatable->True],
Cell[10158, 231, 928, 21, 36, "Input",ExpressionUUID->"09966caf-ff8b-8041-9cdc-170c1a678623",
 Evaluatable->True],
Cell[11089, 254, 1029, 22, 36, "Input",ExpressionUUID->"460333aa-7b19-964c-8b25-6af73e0f052f",
 Evaluatable->True],
Cell[12121, 278, 783, 19, 36, "Input",ExpressionUUID->"3983d1ae-1493-154e-8f25-4e9b16f4685c",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[12941, 302, 247, 6, 30, "Subsection",ExpressionUUID->"1198eff4-a789-a849-bf8b-910659197489",
 Evaluatable->False],
Cell[13191, 310, 377, 9, 21, "Input",ExpressionUUID->"80c1bf42-41b2-6f46-a006-83d501f6d05c",
 Evaluatable->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[13617, 325, 391, 8, 40, "Section",ExpressionUUID->"95870ea0-90c7-41e7-b6ee-0d52ff1de355",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[14033, 337, 394, 8, 41, "Subsection",ExpressionUUID->"72a62f9c-e1f4-4deb-9a9e-067244a56d01",
 Evaluatable->False],
Cell[14430, 347, 1754, 28, 79, "CodeText",ExpressionUUID->"4421a024-705a-4b6e-8684-60dea2ce5c0b",
 Evaluatable->False],
Cell[16187, 377, 3883, 65, 164, "Input",ExpressionUUID->"f58dbd00-519e-45c4-b0f0-b49fe02629c4",
 Evaluatable->True],
Cell[20073, 444, 1943, 39, 64, "Input",ExpressionUUID->"f8af0a3c-4d6e-411d-9459-7fae9b7f443e",
 Evaluatable->True],
Cell[22019, 485, 757, 18, 36, "Input",ExpressionUUID->"1783e390-7ac4-4da7-93de-6825e5b4ab2f",
 Evaluatable->True],
Cell[22779, 505, 1172, 28, 62, "Input",ExpressionUUID->"d8e0c07f-6a89-4f77-bd96-5ea9a2eea163",
 Evaluatable->True,
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23988, 538, 239, 6, 41, "Subsection",ExpressionUUID->"df0c7e82-ac5b-4dc8-bae0-70e2b3799305",
 Evaluatable->False],
Cell[24230, 546, 4169, 66, 64, "Input",ExpressionUUID->"bc9403fb-cb3d-4cf4-b8ed-83695299d6e9",
 Evaluatable->True],
Cell[28402, 614, 590, 14, 36, "Input",ExpressionUUID->"d5bbf827-ffbf-3846-b625-bf5d73f5663b",
 Evaluatable->True],
Cell[28995, 630, 8407, 150, 321, "Input",ExpressionUUID->"7da413f4-cb42-4b43-acfa-ef230c5eca65",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[37439, 785, 383, 8, 41, "Subsection",ExpressionUUID->"813af486-0624-4887-aaab-bc68c0008362",
 Evaluatable->False],
Cell[37825, 795, 9712, 157, 307, "Input",ExpressionUUID->"438d6b16-61c2-4826-a058-ce9b852b268e",
 Evaluatable->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[47574, 957, 368, 8, 41, "Subsection",ExpressionUUID->"6328df8b-15be-4858-94d4-1a97611e7c5d",
 Evaluatable->False],
Cell[47945, 967, 6234, 116, 378, "Input",ExpressionUUID->"2931bc5e-6acc-4334-acd6-4a7f8718a4d6",
 Evaluatable->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54228, 1089, 387, 8, 50, "Section",ExpressionUUID->"40ed4705-be84-495a-b79e-de080a80e030",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[54640, 1101, 384, 8, 41, "Subsection",ExpressionUUID->"3c7293a7-182a-4855-b17b-a8baeefecad6",
 Evaluatable->False],
Cell[55027, 1111, 2235, 40, 79, "Input",ExpressionUUID->"495c3329-f051-415e-a588-d683ad764f9c",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57299, 1156, 510, 10, 30, "Subsection",ExpressionUUID->"b449995e-fe0b-419b-b582-90618006ff86",
 Evaluatable->False],
Cell[57812, 1168, 14571, 241, 550, "Input",ExpressionUUID->"4598aed3-11e4-4d7e-a6dc-3aa304612c89",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[72420, 1414, 502, 9, 30, "Subsection",ExpressionUUID->"0ca3971a-851d-0b41-a96e-3c54ff2fbaaf",
 Evaluatable->False],
Cell[72925, 1425, 6054, 130, 592, "Input",ExpressionUUID->"d2b1edac-8942-3a49-8fef-25411599180f",
 Evaluatable->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79016, 1560, 540, 10, 30, "Subsection",ExpressionUUID->"6c3471a2-a8d5-4b22-baa1-9d0afce51e48",
 Evaluatable->False],
Cell[79559, 1572, 4353, 74, 122, "Input",ExpressionUUID->"a0ce854e-c3fc-46c1-8525-727bed1017bf",
 Evaluatable->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83961, 1652, 607, 10, 50, "Section",ExpressionUUID->"6abea06c-055e-4af6-9a13-893b08c4765b",
 Evaluatable->False],
Cell[84571, 1664, 4977, 98, 407, "Input",ExpressionUUID->"603b4cc0-1f87-4dcc-a203-e3a5650bef3b",
 Evaluatable->True]
}, Closed]]
}
]
*)

